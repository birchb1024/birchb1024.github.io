<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta name="generator" content="http://www.nongnu.org/elyxer/"/>
<meta name="create-date" content="2018-03-24"/>
<link rel="stylesheet" href="http://elyxer.nongnu.org/lyx.css" type="text/css" media="all"/>
<title>Genyris User Manual</title>
</head>
<body>
<div id="globalWrapper">
<h1 class="title">
Genyris User Manual
</h1>
<div class="Unindented">
<div class="center">
Version 0.9.4
</div>

</div>
<div class="Indented">
<div class="center">
Build 0.9.4.1-0
</div>

</div>
<div class="Indented">
<div class="center">
Peter William Birch
</div>

</div>
<div class="Indented">
<div class="center">
birchb1024@gmail.com
</div>

</div>
<div class="abstract">
<p class="abstract-message">
Abstract
</p>
This document is the user manual for the Genyris scripting language, the language that provides multi-class objects and support for semantic programs.
</div>
<div class="Unindented">
<p><br/>
</p>

</div>
<div class="fulltoc">
<div class="tocheader">
Table of Contents
</div>
<div class="tocindent">
<div class="tocindent">
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection--1">Subsubsection: Conventions used in this document:</a>
</div>
</div>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Part-I">Part I: Quick Start</a>
</div>
<div class="tocindent">
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsection--1">Subsection: Getting Genyris</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection--2">Subsection: Installation</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection--3">Subsection: Executing Expressions</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection--4">Subsection: Verifying the Install</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection--5">Subsection: Running Examples</a>
</div>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Part-II">Part II: Language Manual</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Section-1">Section 1: Introduction</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsection-1.1">Subsection 1.1: Syntax</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-1.1.1">Subsubsection 1.1.1: Comments</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-1.1.2">Subsubsection 1.1.2: Numbers</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-1.1.3">Subsubsection 1.1.3: Strings</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-1.1.4">Subsubsection 1.1.4: Symbols</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-1.1.5">Subsubsection 1.1.5: Denoting dynamic variables with periods.</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-1.1.6">Subsubsection 1.1.6: Expressions and Sub-expressions</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-1.1.7">Subsubsection 1.1.7: Pairs</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-1.1.8">Subsubsection 1.1.8: Quoting and Special Parser Characters</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-1.1.9">Subsubsection 1.1.9: Lexer Macros</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-1.1.10">Subsubsection 1.1.10: Line Continuation</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-1.1.11">Subsubsection 1.1.11: More Quote Characters</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-1.1.12">Subsubsection 1.1.12: Square and Curly Brackets</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-1.2">Subsection 1.2: Non-Indented Syntax</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-1.3">Subsection 1.3: Variables</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-1.4">Subsection 1.4: Functions</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-1.4.1">Subsubsection 1.4.1: Eager Functions</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-1.4.2">Subsubsection 1.4.2: Lazy Functions</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-1.4.3">Subsubsection 1.4.3: Defining Your Own Functions</a>
</div>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-2">Section 2: Bindings and Variables</a>
</div>
<div class="tocindent">
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-2.4.1">Subsubsection 2.4.1: Definition of Variables</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-2.4.2">Subsubsection 2.4.2: Assignment</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-2.4.3">Subsubsection 2.4.3: Definition of Functions</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-2.4.4">Subsubsection 2.4.4: <i>symbol-value</i> &lt;symbol&gt;</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-2.4.5">Subsubsection 2.4.5: <i>dynamic-symbol-value</i> &lt;symbol&gt;</a>
</div>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-3">Section 3: Control Flow</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsection-3.1">Subsection 3.1: Predicates</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-3.1.1">Subsubsection 3.1.1: <i>nil</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-3.1.2">Subsubsection 3.1.2: true</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-3.1.3">Subsubsection 3.1.3: Comparisons</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-3.1.4">Subsubsection 3.1.4: Logical Functions</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-3.2">Subsection 3.2: Conditional Execution</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-3.2.1">Subsubsection 3.2.1: cond</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-3.2.2">Subsubsection 3.2.2: <i>if</i></a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-3.3">Subsection 3.3: Looping and Iterators</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-3.3.1">Subsubsection 3.3.1: Simple looping with<i> while</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-3.3.2">Subsubsection 3.3.2: Creating Iterators with .mkIterator</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-3.3.3">Subsubsection 3.3.3: Traversing with<i> for</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-3.3.4">Subsubsection 3.3.4: Ranges</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-3.4">Subsection 3.4: Exceptions</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-3.4.1">Subsubsection 3.4.1: Popping the execution stack with<i> raise</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-3.4.2">Subsubsection 3.4.2: Catching exceptions with<i> catch</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-3.4.3">Subsubsection 3.4.3: Inserting program checks with<i> assert</i></a>
</div>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-4">Section 4: Functions and Macros</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsection-4.1">Subsection 4.1: Anonymous Functions</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-4.2">Subsection 4.2: Closures</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.2.1">Subsubsection 4.2.1: <i>lambda</i> or<i> function</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.2.2">Subsubsection 4.2.2: Closures Capture Environments</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-4.3">Subsection 4.3: Explicit Evaluation</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.3.1">Subsubsection 4.3.1: eval &lt;expression&gt;</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.3.2">Subsubsection 4.3.2: apply</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.3.3">Subsubsection 4.3.3: tailcall &lt;closure&gt; &lt;Arguments...&gt;</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-4.4">Subsection 4.4: Anonymous Lazy Functions</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.4.1">Subsubsection 4.4.1: <i>lambadq</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.4.2">Subsubsection 4.4.2: <i>lambdam</i></a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-4.5">Subsection 4.5: Defining Macros</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.5.1">Subsubsection 4.5.1: An Example: Executable Comments</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-4.6">Subsection 4.6: <i>template</i> &lt;body&gt;</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-4.7">Subsection 4.7: Catching Missing Functions</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-5">Section 5: Everything is Callable</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsection-5.1">Subsection 5.1: Introduction</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-5.2">Subsection 5.2: Dynamic Variables</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-5.3">Subsection 5.3: Synactic Sugar - Using the exclamation mark</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-5.4">Subsection 5.4: use &lt;object-expression&gt; &lt;body-expression&gt;</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-6">Section 6: Data Structures</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsection-6.1">Subsection 6.1: Bignum</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-6.1.1">Subsubsection 6.1.1: Maths Functions</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-6.2">Subsection 6.2: Lists and Pairs</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-6.2.1">Subsubsection 6.2.1: Class Pair</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-6.2.2">Subsubsection 6.2.2: Class PairEqual</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-6.2.3">Subsubsection 6.2.3: Class PairSource</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-6.3">Subsection 6.3: String</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-6.3.1">Subsubsection 6.3.1: <i>.match</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-6.3.2">Subsubsection 6.3.2: <i>.regex</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-6.3.3">Subsubsection 6.3.3: <i>.length</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-6.3.4">Subsubsection 6.3.4: <i>.split &lt;delimiter string&gt;</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-6.3.5">Subsubsection 6.3.5: <i>.join &lt;list&gt;</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-6.3.6">Subsubsection 6.3.6: <i>.replace</i> &lt;searchstring&gt; &lt;replacement&gt;</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-6.3.7">Subsubsection 6.3.7: <i>.+ &lt;string&gt;...</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-6.3.8">Subsubsection 6.3.8: <i>.toBase64</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-6.3.9">Subsubsection 6.3.9: <i>.fromBase64</i></a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-6.4">Subsection 6.4: Dictionaries</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-6.4.1">Subsubsection 6.4.1: Adding Behaviour to Dictionaries</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-6.5">Subsection 6.5: Classes</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-6.5.1">Subsubsection 6.5.1: Defining Your Own Classes</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-6.5.2">Subsubsection 6.5.2: Type-Checked Function Arguments</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-6.5.3">Subsubsection 6.5.3: In-Line Type Checks</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-6.5.4">Subsubsection 6.5.4: Inheritance and Class Properties</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-6.5.5">Subsubsection 6.5.5: Class Validators</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-6.5.6">Subsubsection 6.5.6: Traditional Constructors and Factories</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-6.5.7">Subsubsection 6.5.7: Functions on classes</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-6.5.8">Subsubsection 6.5.8: Automating Classification</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-6.5.9">Subsubsection 6.5.9: Duck Typing</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-6.6">Subsection 6.6: Triples</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-6.6.1">Subsubsection 6.6.1: Introduction</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-6.6.2">Subsubsection 6.6.2: Creating triples with<i> triple</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-6.6.3">Subsubsection 6.6.3: Accessing parts of a triple with<i> .subject</i>,<i> .predicate</i> and<i> .object</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-6.6.4">Subsubsection 6.6.4: Triple Equality</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-6.7">Subsection 6.7: Graphs</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-6.7.1">Subsubsection 6.7.1: Creating Graphs with<i> graph</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-6.7.2">Subsubsection 6.7.2: Graph equality</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-6.7.3">Subsubsection 6.7.3: Adding Triples with<i> .add</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-6.7.4">Subsubsection 6.7.4: Removing Triples with<i> .remove</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-6.7.5">Subsubsection 6.7.5: Querying Triples with<i> .select</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-6.7.6">Subsubsection 6.7.6: Retrieving unique values with<i> .get subject predicate</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-6.7.7">Subsubsection 6.7.7: Retrieving multiple values with<i> .get-list subject predicate</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-6.7.8">Subsubsection 6.7.8: Updating with<i> .put subject predicate object</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-6.7.9">Subsubsection 6.7.9: Fetching all the triples with<i> .asTriples</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-6.7.10">Subsubsection 6.7.10: Triplification with<i> .asGraph</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-6.7.11">Subsubsection 6.7.11: Meta-Data for Triples</a>
</div>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-7">Section 7: Input and Output</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsection-7.1">Subsection 7.1: Output</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-7.1.1">Subsubsection 7.1.1: <i>u:format</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-7.1.2">Subsubsection 7.1.2: Class Writer</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-7.2">Subsection 7.2: Input</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-7.2.1">Subsubsection 7.2.1: <i>EOF</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-7.2.2">Subsubsection 7.2.2: <i>read</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-7.2.3">Subsubsection 7.2.3: <i>stdin</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-7.2.4">Subsubsection 7.2.4: Class Reader</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-7.2.5">Subsubsection 7.2.5: IndentedParser</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-7.2.6">Subsubsection 7.2.6: ParenParser</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-7.2.7">Subsubsection 7.2.7: <i>StringFormatStream</i></a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-7.3">Subsection 7.3: <i>File</i></a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-7.3.1">Subsubsection 7.3.1: <i>.new &lt;String filename&gt;</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-7.3.2">Subsubsection 7.3.2: <i>.open &lt;mode&gt;</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-7.3.3">Subsubsection 7.3.3: <i>.list</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-7.3.4">Subsubsection 7.3.4: <i>.abs-path</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-7.3.5">Subsubsection 7.3.5: <i>.exists &lt;String filename&gt;</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-7.3.6">Subsubsection 7.3.6: <i>.is-dir? &lt;String filename&gt;</i></a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-7.4">Subsection 7.4: Pipes</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-7.4.1">Subsubsection 7.4.1: .list - obtain a list of the current pipe names</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-7.4.2">Subsubsection 7.4.2: .open - Create or find a named pipe</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-7.4.3">Subsubsection 7.4.3: .output - Obtain a Writer stream for writing to a Pipe</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-7.4.4">Subsubsection 7.4.4: .input - Obtain a Reader for reading from a Pipe</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-7.4.5">Subsubsection 7.4.5: .delete - Remove a named pipe from the system</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-7.4.6">Subsubsection 7.4.6: Pipe Examples</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-7.5">Subsection 7.5: Interacting with Web Servers with HTTP<i></i></a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-7.5.1">Subsubsection 7.5.1: <i>web:get</i> &lt;url&gt; [&lt;request headers&gt; [&lt;protocol version&gt;]]</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-7.5.2">Subsubsection 7.5.2: <i>web:post</i> &lt;url&gt; [&lt;params assoc&gt;] [&lt;request headers&gt; [&lt;protocol version&gt;]]</a>
</div>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-8">Section 8: Programming in the Large</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsection-8.1">Subsection 8.1: Including Source Files</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-8.1.1">Subsubsection 8.1.1: load<i>&lt;java resource name&gt;</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-8.1.2">Subsubsection 8.1.2: include<i>&lt;path to filename&gt;</i></a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-8.2">Subsection 8.2: Namespaces</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-8.2.1">Subsubsection 8.2.1: Disambiguate Properties and Methods</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-8.2.2">Subsubsection 8.2.2: Genyris property values are first class objects.</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-8.2.3">Subsubsection 8.2.3: Semantic Markup</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-8.3">Subsection 8.3: Modules</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-8.3.1">Subsubsection 8.3.1: sys:import &lt;filename name&gt;</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-8.3.2">Subsubsection 8.3.2: import &lt;module name&gt;</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-8.3.3">Subsubsection 8.3.3: reload &lt;module name&gt;</a>
</div>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-9">Section 9: Genyris Classes</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsection-9.1">Subsection 9.1: Class Hierarchy</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-9.2">Subsection 9.2: <i>class StandardClass</i></a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-9.2.1">Subsubsection 9.2.1: <i>.classname</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-9.2.2">Subsubsection 9.2.2: <i>.subclasses</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-9.2.3">Subsubsection 9.2.3: <i>.superclasses</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-9.2.4">Subsubsection 9.2.4: <i>.vars</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-9.2.5">Subsubsection 9.2.5: <i>Builtin</i></a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-9.3">Subsection 9.3: <i>class Thing</i></a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-9.3.1">Subsubsection 9.3.1: <i>.vars</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-9.3.2">Subsubsection 9.3.2: <i>.self</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-9.3.3">Subsubsection 9.3.3: <i>.classes</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-9.3.4">Subsubsection 9.3.4: <i>.valid?</i><i> &lt;object&gt;</i></a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-9.4">Subsection 9.4: <i>class NilSymbol</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-9.5">Subsection 9.5: <i>class Closure</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-9.6">Subsection 9.6: <i>class LazyProcedure</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-9.7">Subsection 9.7: <i>class EagerProcedure</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-9.8">Subsection 9.8: class <i>Pair</i></a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-9.8.1">Subsubsection 9.8.1: <i>.left</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-9.8.2">Subsubsection 9.8.2: <i>.right</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-9.8.3">Subsubsection 9.8.3: <i>list &lt;obj&gt; ...</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-9.8.4">Subsubsection 9.8.4: <i>car &lt;Pair&gt;</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-9.8.5">Subsubsection 9.8.5: <i>cdr &lt;Pair&gt;</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-9.8.6">Subsubsection 9.8.6: <i>left &lt;Pair&gt;</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-9.8.7">Subsubsection 9.8.7: <i>right &lt;Pair&gt;</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-9.8.8">Subsubsection 9.8.8: <i>cons &lt;left&gt; &lt;right&gt;</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-9.8.9">Subsubsection 9.8.9: <i>rplaca &lt;Pair&gt; &lt;obj&gt;</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-9.8.10">Subsubsection 9.8.10: <i>rplacd</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-9.8.11">Subsubsection 9.8.11: <i>reverse &lt;list&gt;</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-9.8.12">Subsubsection 9.8.12: <i>length</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-9.8.13">Subsubsection 9.8.13: <i>map-left &lt;List&gt; &lt;function-closure&gt;</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-9.8.14">Subsubsection 9.8.14: <i>member? &lt;List&gt; &lt;obj&gt;</i></a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-9.9">Subsection 9.9: class PairSource</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-9.9.1">Subsubsection 9.9.1: .line-number</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-9.9.2">Subsubsection 9.9.2: .filename</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-9.10">Subsection 9.10: <i>class Alist</i></a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-9.10.1">Subsubsection 9.10.1: <i>.lookup</i>&lt;key&gt;</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-9.10.2">Subsubsection 9.10.2: .<i>getKeys</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-9.10.3">Subsubsection 9.10.3: <i>.hasKey</i>&lt;key&gt;</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-9.11">Subsection 9.11: <i>class Object </i></a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-9.11.1">Subsubsection 9.11.1: <i>.new</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-9.11.2">Subsubsection 9.11.2: <i>.init &lt;args&gt;...</i></a>
</div>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-10">Section 10: Launching the Interpreter </a>
</div>
<div class="tocindent">
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-10.11.1">Subsubsection 10.11.1: Simplified Launching via the Path</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-10.11.2">Subsubsection 10.11.2: Command line options</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-10.11.3">Subsubsection 10.11.3: Command-line editing</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-10.11.4">Subsubsection 10.11.4: Interpreter Boot sequence</a>
</div>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-11">Section 11: Tasks - Multiple Threads of Execution</a>
</div>
<div class="tocindent">
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-11.11.1">Subsubsection 11.11.1: Running Multiple Interpreters in the Same Process with <i>spawn</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-11.11.2">Subsubsection 11.11.2: Termination with <tt><i>kill</i></tt></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-11.11.3">Subsubsection 11.11.3: Thread Safety</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-11.11.4">Subsubsection 11.11.4: <i>task:synchronized</i> - Control access to shared resources</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-11.11.5">Subsubsection 11.11.5: <i>ps</i> - list current running threads</a>
</div>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-12">Section 12: Running Web Servers</a>
</div>
<div class="tocindent">
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-12.11.1">Subsubsection 12.11.1: Starting a web server</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-12.11.2">Subsubsection 12.11.2: Stopping a web server</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-12.11.3">Subsubsection 12.11.3: Processing Web Requests</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-12.11.4">Subsubsection 12.11.4: Starting a static web server</a>
</div>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-13">Section 13: Using Java Classes</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsection-13.1">Subsection 13.1: Importing a Java Class with<i> java:import</i></a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-13.1.1">Subsubsection 13.1.1: Adding to Java Classes</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-13.2">Subsection 13.2: Creating Instances of Java Objects</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-13.3">Subsection 13.3: Accessing Fields</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-13.4">Subsection 13.4: Calling Methods</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-13.5">Subsection 13.5: Conversions and Coersion</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-13.5.1">Subsubsection 13.5.1: Conversion To Java Objects</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-13.5.2">Subsubsection 13.5.2: Conversion from Java To Genyris Objects</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-13.6">Subsection 13.6: Using Java Reflection from Genyris</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-13.7">Subsection 13.7: Hooking Swing Events in Genyris</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-13.8">Subsection 13.8: Plotting 2D Figures on a Swing Canvas</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-13.9">Subsection 13.9: Limitations</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-14">Section 14: For Maintainers</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsection-14.1">Subsection 14.1: Versioning Numbering</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-14.1.1">Subsubsection 14.1.1: Source Versioning</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-14.1.2">Subsubsection 14.1.2: Release Versioning</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-14.1.3">Subsubsection 14.1.3: Source Branching</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-14.1.4">Subsubsection 14.1.4: Version Information in Executables</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-14.1.5">Subsubsection 14.1.5: Obtaining Version Information at Runtime</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-14.2">Subsection 14.2: Building From Source</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-14.2.1">Subsubsection 14.2.1: Obtaining source from the Mercurial Repository</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-14.2.2">Subsubsection 14.2.2: The Source</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-14.2.3">Subsubsection 14.2.3: The Build</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-14.3">Subsection 14.3: Reflection</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-14.3.1">Subsubsection 14.3.1: <i>symlist</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-14.3.2">Subsubsection 14.3.2: <i>sys:self-test</i></a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-14.4">Subsection 14.4: Extending and Modifying Genyris</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-14.4.1">Subsubsection 14.4.1: Adding Builtin Java Functions to Core Genyris Classes</a>
</div>
</div>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Part-III">Part III: Libraries</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Section-15">Section 15: ListOfLines</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-16">Section 16: System</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsection-16.1">Subsection 16.1: .HOME</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-16.2">Subsection 16.2: .LIBS</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-17">Section 17: <i>os</i></a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsection-17.1">Subsection 17.1: .getProperties</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection--2">Subsubsection: Example:</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-17.2">Subsection 17.2: <i>.exec &lt;arg&gt;...</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-17.3">Subsection 17.3: <i>.getenv [varname]</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-17.4">Subsection 17.4: .<i>spawn</i></a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-17.5">Subsection 17.5: .name</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-17.6">Subsection 17.6: .tempdir</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-17.7">Subsection 17.7: .exit</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection--3">Subsubsection: Syntax: </a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-17.8">Subsection 17.8: Class Process</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-18">Section 18: Time and Date</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsection-18.1">Subsection 18.1: <i>os!ticks</i> - Current system time in milliseconds since the epoch</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-18.2">Subsection 18.2: <i>now</i> - Current system time in milliseconds since the epoch</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-18.3">Subsection 18.3: <i>format-date</i> &lt;epoch milliseconds&gt; &lt;format String&gt; &lt;timezone&gt;</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-18.4">Subsection 18.4: <i>calendar</i> &lt;epoch milliseconds&gt; &lt;timezone&gt;</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-19">Section 19: Comma-Separated-Value Files</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsection-19.1">Subsection 19.1: .read &lt;InStream&gt; field-separator quote-char</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-20">Section 20: Sound</a>
</div>
<div class="tocindent">
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-20.1.1">Subsubsection 20.1.1: .play &lt;soundfile&gt;</a>
</div>
</div>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Part--I">Part: Index</a>
</div>
<div class="toc">
<a class="Link" href="#Index">Index</a>
</div>

</div>
<h3 class="Subsubsection-">
<a class="toc" name="toc-Subsubsection--1"></a>Conventions used in this document:
</h3>
<div class="Labeling">
<i>italicized</i>Snippets of Genyris programs
</div>
<div class="Labeling">
<tt>fixed-font</tt> Larger programs are in a fixed font. Interactive sessions are show with the<tt>&gt;</tt> prompt of the command-line interpreter and the results printed underneath.
</div>
<div class="Unindented">
<p><br/>
</p>

</div>
<h1 class="Part">
<a class="toc" name="toc-Part-I">Part I.</a> Quick Start
</h1>
<h2 class="Subsection-">
<a class="toc" name="toc-Subsection--1"></a>Getting Genyris
</h2>
<div class="Unindented">
The Genyris project is hosted on Google Code here:<i> http://code.google.com/p/genyris/. </i>In the <i>Downloads</i> tab, look for the latest binary file which has the form<i> genyris-binary-NNN-XXXXXXXXXXXX.BB.zip. </i>The release number is the <i>NNN</i>, choose the file with the largest release number. 
</div>
<h2 class="Subsection-">
<a class="toc" name="toc-Subsection--2"></a>Installation
</h2>
<div class="Unindented">
Genyris is available as a<i> ZIP</i> file. This file needs to be unpacked into an empty directory such as &ldquo;genyris&rdquo;. This becomes the home directory for Genyris.
</div>
<div class="Indented">
Genyris is developed in Java hence needs a Java runtime. You don’t need to understand Java to use Genyris. However you will need the Oracle Java 1.6 JRE<a class="IndexReference" name="entry-JRE-0" href="#index-JRE">↓</a> or later to run the Genyris interpreter. Java can be downloaded from Oracle. Check your JRE version with this command:
</div>
<pre class="LyX-Code">
$<b> java -version</b>
</pre>
<div class="Unindented">
First change directory to the genyris home, then you can start the Genyris command-line interpreter with this Unix command:
</div>
<pre class="LyX-Code">
$<b> java -jar dist/genyris-bin-*.jar </b>
</pre>
<div class="Unindented">
Or in Windows cmd.exe:
</div>
<pre class="LyX-Code">
C:\&gt;<b> java -jar dist\genyris-bin-*.jar </b>
</pre>
<div class="Unindented">
You will see a prompt indicating the interpreter is ready for your input:
</div>
<pre class="LyX-Code">
*** Welcome ... Genyris ... is listening...
&gt;
</pre>
<div class="Unindented">
Refer to section<a class="Reference" href="#sec:Running-Genyris">(10↓)</a> for details on how to simplify running Genyris using PATH settings.
</div>
<h2 class="Subsection-">
<a class="toc" name="toc-Subsection--3"></a>Executing Expressions
</h2>
<div class="Unindented">
Genyris commands can now be typed at the prompt, use two carriage returns (<span class="formula">↩</span>) to terminate a statement. For example to add two numbers type:
</div>
<pre class="LyX-Code">
&gt;<b>+ 42 37<span class="formula">↩</span></b>
<b><span class="formula">↩</span></b>
</pre>
<div class="Unindented">
Genyris responds with the answer and a comment about the result:
</div>
<pre class="LyX-Code">
~ 79 # Bignum
</pre>
<h2 class="Subsection-">
<a class="toc" name="toc-Subsection--4"></a>Verifying the Install
</h2>
<div class="Unindented">
To test the installation change to the genyris home directory and run the self test suite with the following command:
</div>
<pre class="LyX-Code">
&gt;<b>sys:self-test<a class="IndexReference" name="entry--0" href="#index-">↓</a><span class="formula">↩</span></b>
<b><span class="formula">↩</span></b>
</pre>
<div class="Unindented">
All being well, it will print the number of tests passed.
</div>
<h2 class="Subsection-">
<a class="toc" name="toc-Subsection--5"></a>Running Examples
</h2>
<div class="Unindented">
The release binary file includes some examples in the<i>examples</i><a class="IndexReference" name="entry-examples-0" href="#index-examples">↓</a>folder. The files can be edited with your favourite text editor and run with the<i>include</i><a class="IndexReference" name="entry-include-0" href="#index-include">↓</a> function. For example, to load an run the&ldquo;Eight Queens&rdquo; example do:
</div>
<pre class="LyX-Code">
&gt;<b>include ’examples/queens.g’<span class="formula">↩</span></b>

~ ’file:/home/birchb/workspace/Genyris/examples/queens.g’ # String
&gt;<b>run-queens 8<span class="formula">↩</span></b>
<b><span class="formula">↩</span></b>
</pre>
<h1 class="Part">
<a class="toc" name="toc-Part-II">Part II.</a> Language Manual
</h1>
<h1 class="Section">
<a class="toc" name="toc-Section-1">1</a> Introduction
</h1>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-1.1">1.1</a> <a class="Label" name="sub:Syntax"> </a>Syntax
</h2>
<div class="Unindented">
The syntax of Genyris uses indentation to convey program structure. This is in common with other languages such as Python. However Genyris preserves the&ldquo;prefix&rdquo; notation of Lisp and Scheme. Here is an example of some code defining a function:
</div>
<pre class="LyX-Code">
def threat (i j a b)
   or
      equal? i a
      equal? j b
      equal? (- i j) (- a b)
      equal? (+ i j) (+ a b)
</pre>
<div class="Unindented">
Instead of curly braces or<i> begin</i> and<i> end</i> tokens, the indentation defines the blocks of code. Genyris reads lines one-by-one until it reaches the end of an expression. An expression ends when there are no more indented lines. The interactive command-line ends an expression whenever two blank lines are read. Within a line, tokens are separated by white-space. Genyris recognizes the following syntactic elements:
</div>
<ul>
<li>
Comments
</li>
<li>
Numbers
</li>
<li>
Strings
</li>
<li>
Symbols
</li>
<li>
Sub-expressions
</li>
<li>
Lists
</li>
<li>
Parser macros and directives
</li>

</ul>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-1.1.1">1.1.1</a> Comments
</h3>
<div class="Unindented">
All characters following a hash<a class="IndexReference" name="entry-hash-0" href="#index-hash">↓</a> (pound) until the end of the line are ignored by the parser. For example:
</div>
<pre class="LyX-Code">
<b># This whole line is a comment</b>
- 4 3 <b># this comment goes to the end</b>

</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-1.1.2">1.1.2</a> Numbers
</h3>
<div class="Unindented">
Numbers can be either integers or floating point with any number of leading or trailing digits. Examples:
</div>
<pre class="LyX-Code">
-3 23.78 -100.0089  34.45e7
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-1.1.3">1.1.3</a> Strings
</h3>
<div class="Unindented">
Strings are delimited by either double quote characters " or single quotes ’. Within a string quotes and special characters are escaped with backslash \. For example<tt><i> "She said\"sea shells\"</i></tt> "yields the string:
</div>
<pre class="LyX-Code">
She said "sea shells"
</pre>
<div class="Unindented">
Other escape sequences are encoded as follows:
</div>
<div class="Indented">
<div class="center">
<table>
<tr>
<td align="left" valign="top">
<tt><b>\n</b></tt>
</td>
<td align="left" valign="bottom">
newline<a class="IndexReference" name="entry-New-Line-0" href="#index-New-Line">↓</a>
</td>

</tr>
<tr>
<td align="left" valign="top">
<tt><b>\r</b></tt>
</td>
<td align="left" valign="bottom">
carriage return
</td>

</tr>
<tr>
<td align="left" valign="top">
<tt><b>\f</b></tt>
</td>
<td align="left" valign="bottom">
form feed
</td>

</tr>
<tr>
<td align="left" valign="top">
<tt><b>\\</b></tt>
</td>
<td align="left" valign="bottom">
backslash
</td>

</tr>
<tr>
<td align="left" valign="top">
<tt><b>\t</b></tt>
</td>
<td align="left" valign="bottom">
tab
</td>

</tr>
<tr>
<td align="left" valign="top">
<tt><b>\&rdquo;</b></tt>
</td>
<td align="left" valign="bottom">
quote
</td>

</tr>
<tr>
<td align="left" valign="top">
<b>\a</b>
</td>
<td align="left" valign="bottom">
bell
</td>

</tr>
<tr>
<td align="left" valign="top">
\’
</td>
<td align="left" valign="bottom">
single quote
</td>

</tr>

</table>

</div>

</div>
<div class="Indented">
The two styles of string are internally identical, which allows you to avoid escaping. For example this string contains double quotes:
</div>
<pre class="LyX-Code">
’"After all," said the young man, "golf<a class="IndexReference" name="entry-golf-0" href="#index-golf">↓</a> is only a game."’
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-1.1.4">1.1.4</a> Symbols
</h3>
<div class="Unindented">
Symbols are a group of any printable characters with the following exceptions:
</div>
<div class="Indented">
<div class="center">
<table>
<tr>
<td align="center" valign="top">
$
</td>
<td align="center" valign="top">
dollar<a class="IndexReference" name="entry-dollar-0" href="#index-dollar">↓</a>
</td>

</tr>
<tr>
<td align="center" valign="top">
^
</td>
<td align="center" valign="top">
carat
</td>

</tr>
<tr>
<td align="center" valign="top">
.
</td>
<td align="center" valign="top">
period
</td>

</tr>
<tr>
<td align="center" valign="top">
<tt><b>’</b></tt>
</td>
<td align="center" valign="top">
single quote
</td>

</tr>
<tr>
<td align="center" valign="top">
<tt><b>"</b></tt>
</td>
<td align="center" valign="top">
double quote
</td>

</tr>
<tr>
<td align="center" valign="top">
<tt><b>‘</b></tt>
</td>
<td align="center" valign="top">
backquote
</td>

</tr>
<tr>
<td align="center" valign="top">
<tt><b>@</b></tt>
</td>
<td align="center" valign="top">
at sign
</td>

</tr>
<tr>
<td align="center" valign="top">
[
</td>
<td align="center" valign="top">
square
</td>

</tr>
<tr>
<td align="center" valign="top">
]
</td>
<td align="center" valign="top">
brackets
</td>

</tr>
<tr>
<td align="center" valign="top">
{
</td>
<td align="center" valign="top">
curly
</td>

</tr>
<tr>
<td align="center" valign="top">
}
</td>
<td align="center" valign="top">
brackets
</td>

</tr>
<tr>
<td align="center" valign="top">
=
</td>
<td align="center" valign="top">
equal sign
</td>

</tr>
<tr>
<td align="center" valign="top">
!
</td>
<td align="center" valign="top">
exclamation
</td>

</tr>

</table>

</div>

</div>
<div class="Indented">
The following are all examples of valid symbols:
</div>
<pre class="LyX-Code">
Wednesday-12
_age
*global*
+,
&lt;variable-name&gt;
</pre>
<div class="Unindented">
In Genyris symbols are &ldquo;interned&rdquo; by the parser so that there is only ever one instance of a particular symbol. Symbols are case sensitive so for example<i> Kookaburra</i> and<i> kookaburra<a class="IndexReference" name="entry-kookaburra-0" href="#index-kookaburra">↓</a></i> are different symbols.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-1.1.5">1.1.5</a> Denoting dynamic variables with periods.
</h3>
<div class="Unindented">
If a symbol is preceded by a period it tells the evaluator that the symbol is referring to a dynamic symbol binding. 
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-1.1.6">1.1.6</a> Expressions and Sub-expressions
</h3>
<div class="Unindented">
All Genyris expressions<a class="IndexReference" name="entry-expressions-0" href="#index-expressions">↓</a> are parsed and stored as linked-lists. A single line is converted into a single list. Sub-expressions are denoted in two ways, either within parentheses on a single line, or by an indented line. For example the following line contains two sub-expressions:
</div>
<pre class="LyX-Code">
Alpha (Beta Charlie) (Delta)
</pre>
<div class="Unindented">
Sub-expressions made using parentheses must remain within a single line, they are not permitted to wrap. Indented lines are deemed to be sub-expressions of the superior, less indented, lines above. The above expression can be written in indented form as follows:
</div>
<pre class="LyX-Code">
Alpha
   Beta Charlie
   Delta
</pre>
<div class="Unindented">
Indentations must line up with previous indentations<a class="IndexReference" name="entry-indentation-0" href="#index-indentation">↓</a> of the same level as follows (spaces indicated with periods):
</div>
<pre class="LyX-Code">
Alpha
...Beta Charlie
......Delta
..<b>.Echo</b>              # correct indentation
</pre>
<div class="Unindented">
The parser is unable to cope with random indentation levels since it does not know what depth is required. The following example will generate an error:
</div>
<pre class="LyX-Code">
Alpha
...Beta Charlie
......Delta
....<b>Echo</b>              # *** ERROR
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-1.1.7">1.1.7</a> Pairs<a class="IndexReference" name="entry-Pairs-0" href="#index-Pairs">↓</a>
</h3>
<div class="Unindented">
Within Genyris lists are composed of pairs of references to objects<span class="FootOuter"><span class="SupFootMarker"> [A] </span><span class="HoverFoot"><span class="SupFootMarker"> [A] </span>Lisp Cons<a class="IndexReference" name="entry-Cons-0" href="#index-Cons">↓</a> cells</span></span>. Pairs have two elements, the left<a class="IndexReference" name="entry-left-0" href="#index-left">↓</a> and right<a class="IndexReference" name="entry-right-0" href="#index-right">↓</a>, which are references to other Genyris objects. The left and right halves of a<i>Pair</i> can be delimited with the equals = character, an infix operator. For example:
</div>
<pre class="LyX-Code">
(1 =<a class="IndexReference" name="entry-=-0" href="#index-=">↓</a> 2)
</pre>
<div class="Unindented">
denotes a<i> Pair</i> referring to the numbers 1 and 2. Genyris expressions are also composed of linked lists of<i> Pairs</i>, hence the expression:
</div>
<pre class="LyX-Code">
(A B C D)
</pre>
<div class="Unindented">
is shorthand for :
</div>
<pre class="LyX-Code">
(A = (B = (C = (D = nil))))
</pre>
<div class="Unindented">
Lists<a class="IndexReference" name="entry-Lists-0" href="#index-Lists">↓</a> are terminated with the special symbol <i>nil</i>. An indented expression can be expressed in terms of <i>Pairs</i>. Consider:
</div>
<pre class="LyX-Code">
Alpha
   Beta
</pre>
<div class="Unindented">
This is the same as
</div>
<pre class="LyX-Code">
(Alpha = ((Beta = nil) = nil))
</pre>
<div class="Unindented">
Lists do not always have to be terminated with<i> nil</i> , the equal sign = operator can be used to squeeze one more object reference into the end of the list. For example the following list has<i> C</i> instead of<i> nil</i>:
</div>
<pre class="LyX-Code">
(A B = C)
</pre>
<div class="Unindented">
New pairs can be created explicitly with the cons function which takes two parameters - the left and right parts of a new pair.:
</div>
<pre class="LyX-Code">
&gt; cons<a class="IndexReference" name="entry-cons-0" href="#index-cons">↓</a> 123 456
:
(123 = 456) # Pair
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-1.1.8">1.1.8</a> Quoting and Special Parser Characters
</h3>
<div class="Unindented">
Lists and atoms can be quoted in Genyris. Quoting is used to prevent execution of expressions. A single atom can be quoted within an expression<span class="FootOuter"><span class="SupFootMarker"> [B] </span><span class="HoverFoot"><span class="SupFootMarker"> [B] </span><i>list</i> is a function we will cover later.</span></span>:
</div>
<pre class="LyX-Code">
      list<a class="IndexReference" name="entry-list-0" href="#index-list">↓</a> 1 2 ^a 3 4    # evaluates to: (1 2 a 3 4)
</pre>
<div class="Unindented">
Carat characters are a shorthand notation to save typing. When the parser sees a carat, it collects the expression following and wraps it within a<i> quote<a class="IndexReference" name="entry-quote-0" href="#index-quote">↓</a></i> expression. So<i> ^&lt;exp&gt;</i> becomes<i> (quote &lt;exp&gt;).</i>When the<i> quote</i> function is evaluated it does not evaluate its argument. So the above expression is actually:
</div>
<pre class="LyX-Code">
      list  1 2 (quote a) 3 4
</pre>
<div class="Unindented">
Embedded lists can be quoted, in which case the embedded list is not evaluated:
</div>
<pre class="LyX-Code">
      func 1 2 ^(x y z) 3 4
</pre>
<div class="Unindented">
If the quote falls at the beginning of the line, only the first element is quoted, not the entire line. So:
</div>
<pre class="LyX-Code">
list 1 2
   ^x y z
</pre>
<div class="Unindented">
is the same as:
</div>
<pre class="LyX-Code">
      list 1 2 ((quote x) y z)
</pre>
<div class="Unindented">
To allow entire sub-trees to be quoted, the quote function needs to be used as in this example:
</div>
<pre class="LyX-Code">
      list 1 2
        quote
           x y z
</pre>
<div class="Unindented">
which is the same as:
</div>
<pre class="LyX-Code">
      list 1 2 (quote (x y z))
</pre>
<div class="Unindented">
<i>quote </i>will only handle one argument, a multi-argument quote function is provided by <i>data</i>. Example:
</div>
<pre class="LyX-Code">
data
   "type" "person"
   "owns" "Ford, Falcon"
   "worksAt" "office"
</pre>
<div class="Unindented">
evaluates to the list:
</div>
<pre class="LyX-Code">
(("type" "person") ("owns" "Ford, Falcon") ("worksAt" "office")) 
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-1.1.9">1.1.9</a> Lexer Macros
</h3>
<div class="Unindented">
If the parser sees the symbols ’<i>@FILE</i>’ and ’<i>@LINE</i>’ it replaces the sysmbol with the current filename and line number respectively. This is useful for reporting the location of errors or when loading data files.
</div>
<div class="Indented">
Example:
</div>
<pre class="LyX-Code">
&gt; raise
:    "Error in %a at %a."      
:         .format @FILE @LINE
: 
*** Error - ’Error in console at 356.’

</pre>
<div class="Unindented">
Example of data file using line numbers:
</div>
<pre class="LyX-Code">
id = @LINE 
    name = &ldquo;Philip K. Dick&rdquo; 
    DOB = &ldquo;16/12/1968&rdquo;
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-1.1.10">1.1.10</a> Line Continuation<a class="IndexReference" name="entry-Line-Continuation-0" href="#index-Line-Continuation">↓</a>
</h3>
<div class="Unindented">
Sometimes long expressions become unwieldy and must be continued on following lines. There are two mechanisms for this. This first is to use the equal operator and an indented line as follows:
</div>
<pre class="LyX-Code">
list 1 2 3 4 5 =<a class="IndexReference" name="entry-=-1" href="#index-=">↓</a>
<b>   </b>6 7 8
</pre>
<div class="Unindented">
This is equivalent to:
</div>
<pre class="LyX-Code">
list 1 2 3 4 5 = (6 7 8)
</pre>
<div class="Unindented">
which is the same as:
</div>
<pre class="LyX-Code">
list 1 2 3 4 5 6 7 8
</pre>
<div class="Unindented">
The second and preferred method is the special line continuation character (the tilde<a class="IndexReference" name="entry-tilde-0" href="#index-tilde">↓</a> ~<a class="IndexReference" name="entry-~-0" href="#index-~">↓</a>) which continues the previous line indentation<a class="IndexReference" name="entry-indentation-1" href="#index-indentation">↓</a> level at the start of the line under which it is placed. This allows arbitrary continuations such as:
</div>
<pre class="LyX-Code">
^
  1 2
      3
      ~ 22
      99
</pre>
<div class="Unindented">
which is the same as:
</div>
<pre class="LyX-Code">
^ (1 2 (3) 22 (99))
</pre>
<div class="Unindented">
if the tilde was not there the expression would become:
</div>
<pre class="LyX-Code">
^ (1 2 (3) (22) (99))
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-1.1.11">1.1.11</a> More Quote Characters
</h3>
<div class="Unindented">
Genyris also supports three other special syntactic quotes similar to the carat. They are all used to simplify writing macros with the<i> template</i> function, but can be used for anything else. These are converted by the parser into expressions as follows:
</div>
<div class="Indented">
<div class="center">
<table>
<tr>
<td align="center" valign="top">
<b>Input Quote Sequence</b>
</td>
<td align="center" valign="top">
<b>Translated Expression</b>
</td>

</tr>
<tr>
<td align="center" valign="top">
$<a class="IndexReference" name="entry-$-0" href="#index-$">↓</a>&lt;exp&gt;
</td>
<td align="center" valign="top">
(dollar<a class="IndexReference" name="entry-dollar-1" href="#index-dollar">↓</a> &lt;exp&gt;)
</td>

</tr>
<tr>
<td align="center" valign="top">
$@<a class="IndexReference" name="entry-$_-0" href="#index-$_">↓</a>&lt;exp&gt;
</td>
<td align="center" valign="top">
(dollar-at<a class="IndexReference" name="entry-dollar-at-0" href="#index-dollar-at">↓</a> &lt;exp&gt;)
</td>

</tr>
<tr>
<td align="center" valign="top">
‘<a class="IndexReference" name="entry-‘-0" href="#index-‘">↓</a>&lt;exp&gt;
</td>
<td align="center" valign="top">
(template<a class="IndexReference" name="entry-template-0" href="#index-template">↓</a> &lt;exp&gt;)
</td>

</tr>

</table>

</div>

</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-1.1.12">1.1.12</a> Square and Curly Brackets<a class="IndexReference" name="entry-Brackets-0" href="#index-Brackets">↓</a>
</h3>
<div class="Unindented">
The square []<a class="IndexReference" name="entry-[]-0" href="#index-[]">↓</a> and curly {}<a class="IndexReference" name="entry-{}-0" href="#index-{}">↓</a> brackets are parsed specially so they can be used by the user in the expressions. In both cases they are converted to a list with a symbol as follows:
</div>
<div class="Indented">
<div class="center">
<table>
<tr>
<td align="center" valign="top">
<b>Input Sequence</b>
</td>
<td align="center" valign="top">
<b>Translated Expression</b>
</td>

</tr>
<tr>
<td align="center" valign="top">
[&lt;list&gt;]
</td>
<td align="center" valign="top">
(squareBracket &lt;list&gt;)
</td>

</tr>
<tr>
<td align="center" valign="top">
{&lt;list&gt;}
</td>
<td align="center" valign="top">
(curlyBracket &lt;list&gt;)
</td>

</tr>
<tr>
<td align="center" valign="top">
 [1 2 3]
</td>
<td align="center" valign="top">
(squareBracket 1 2 3)
</td>

</tr>
<tr>
<td align="center" valign="top">
 {a b c}
</td>
<td align="center" valign="top">
(curlyBracket a b c)
</td>

</tr>

</table>

</div>

</div>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-1.2">1.2</a> Non-Indented Syntax<a class="Label" name="sub:Non-Indented-Syntax"> </a>
</h2>
<div class="Unindented">
Genyris also provides a parser for a Lisp-like syntax based on parentheses () without significant white space. This can be useful for embedding source code in other languages or transmitting strings over data networks where indentation may be inconvenient. The syntax is is identical to Genyris indented syntax except that list structure is communicated by leading and trailing parens, and the position of the text is ignored. Here’s an example file:
</div>
<pre class="LyX-Code">
#
#  Factorial function
#
(@prefix u "http://www.genyris.org/lang/utilities#")
(u:format "Factorial")
(assertEqual ^2 (quote 2))
(assertEqual ’w’ "w")
(assertEqual ^(1 = 2) (cons 1 2))
(def factorial (n)
  (if (&lt; n 2) 1
    (* n
      (factorial (- n 1)))))
</pre>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-1.3">1.3</a> Variables<a class="IndexReference" name="entry-Variables-0" href="#index-Variables">↓</a>
</h2>
<div class="Unindented">
New variables are created with the<i> define<a class="IndexReference" name="entry-define-0" href="#index-define">↓</a></i> function. This function also take an initial value for the variable:
</div>
<pre class="LyX-Code">
define name ’William’
</pre>
<div class="Unindented">
In the example, the symbol<i> name</i> is bound to the value<i> &ldquo;William&rdquo;</i> in the current environment. After the variable has been bound, its value can be used in any expression in the scope. 
</div>
<div class="Indented">
When the interpreter sees a symbol in an argument list it looks for a binding in the current environment and all parent environments right up to the global execution environment. If you define a variable at the command line, it is bound in the global execution environment and hence is available everywhere. If you try to access a variable when there is no binding, an "unbound variable" error will be reported.
</div>
<div class="Indented">
Variable values can be updated with the or<i> setq</i> function, for example:
</div>
<pre class="LyX-Code">
setq name ’William Pitt’
</pre>
<div class="Unindented">
A predicate function<i> bound?<a class="IndexReference" name="entry-bound?-0" href="#index-bound?">↓</a></i> is provided to test whether a symbol has a binding in the current environments. It returns the symbol<i> true</i> if the variable is defined otherwise<i> nil<a class="IndexReference" name="entry-nil-0" href="#index-nil">↓</a></i>.
</div>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-1.4">1.4</a> Functions
</h2>
<div class="Unindented">
As we have seen, Genyris can execute statements immediately at the command line. The expression:
</div>
<pre class="LyX-Code">
+ 42 37
</pre>
<div class="Unindented">
Yields the addition of the two numbers (79). Let’s explore how this works. The interpreter looks for list expressions and assumes the first token (or sub-expression) is a procedure. The rest of the list constitute the arguments to the procedure. In this case<i>+</i> is a symbol which yields a procedure object. The arguments are also evaluated and the results are passed to the procedure to be evaluated. Lets have a look at<i>+</i> by getting its value:
</div>
<pre class="LyX-Code">
&gt; the +

~ &lt;org.genyris.math.PlusFunction&gt; # EagerProcedure
</pre>
<div class="Unindented">
The function<i> the<a class="IndexReference" name="entry-the-0" href="#index-the">↓</a></i> is the identity function - it simply returns the value of its argument. Since the symbol + is an argument to<i> the,</i> its value is the underlying procedure. A procedure, is an object which keeps a reference to the environment in which it was originally defined and the executable code to be run when called. In addition it knows how its arguments are to be handled before the executable code is run.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-1.4.1">1.4.1</a> Eager Functions
</h3>
<div class="Unindented">
Eager<a class="IndexReference" name="entry-Eager-0" href="#index-Eager">↓</a> functions are the default in most programming languages. These evaluate their arguments prior to applying the underlying procedure. Mathematical functions such as<i>+<a class="IndexReference" name="entry-+-0" href="#index-+">↓</a> -<a class="IndexReference" name="entry---0" href="#index--">↓</a> *<a class="IndexReference" name="entry-*-0" href="#index-*">↓</a></i> and /<a class="IndexReference" name="entry-/-0" href="#index-/">↓</a> are eager functions. Let’s experiment with some simple math function calls. All the following expressions evaluate to 12:
</div>
<pre class="LyX-Code">
+ 6 6
+ (* 2 3) (+ 2 4)
+ 2 2 2 2 2 2
</pre>
<div class="Unindented">
Notice that the + function can have many arguments. Another function that takes multiple arguments is<i> list</i><a class="IndexReference" name="entry-list-1" href="#index-list">↓</a>. This function constructs a list from its arguments. Here’s an example:
</div>
<pre class="LyX-Code">
&gt; list (* 34 8) ’pears’ (/ 34 5) ’kilos’

272 ’pears’ 6.8 ’kilos’ # Pair
</pre>
<div class="Unindented">
Note that the interpreter always prints a comment after the result. This comment is the list of classes the result belongs to. Since<i> list</i> returns a list, which is composed of Pairs,<i> &ldquo;Pair</i>&ldquo; is printed.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-1.4.2">1.4.2</a> Lazy<a class="IndexReference" name="entry-Lazy-0" href="#index-Lazy">↓</a> Functions
</h3>
<div class="Unindented">
In contrast to Eager functions, Lazy functions do not evaluate their arguments. In other words, the interpreter passes the<b> source code</b> of their arguments to the function. This allows the function to defer evalution or even exclude evaluation altogether, as is the case in conditional (flow control) constructs. The<i> quote<a class="IndexReference" name="entry-quote-1" href="#index-quote">↓</a></i> function is a lazy procedure which returns its single argument un-evaluated. Example:
</div>
<pre class="LyX-Code">
&gt; quote (* 5 6 7 8)

(* 5 6 7 8) # Pair
</pre>
<div class="Unindented">
Notice that no multiplication has been performed here and the first parameter expression is returned.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-1.4.3">1.4.3</a> Defining Your Own Functions
</h3>
<div class="Unindented">
Functions in Genyris are defined in the usual way for functional programming languages. The<i> def<a class="IndexReference" name="entry-def-0" href="#index-def">↓</a></i> function binds a name to a lexical closure<a class="IndexReference" name="entry-lexical-closure-0" href="#index-lexical-closure">↓</a> containing the current environment and the code to be applied in future calls. The body of the function is a sequence of expressions to be executed in the lexical environment, the last expression’s value is returned. Here’s a definition of the identity function:
</div>
<pre class="LyX-Code">
def identity (arg) arg
</pre>
<div class="Unindented">
Genyris has two kinds of user-defined functions ’eager<a class="IndexReference" name="entry-eager-0" href="#index-eager">↓</a>’ and ’lazy<a class="IndexReference" name="entry-lazy-0" href="#index-lazy">↓</a>’. An eager function evaluates its arguments before it applies them, whereas a lazy function does not. Traditional functions such as ’+’ and<i> the<a class="IndexReference" name="entry-the-1" href="#index-the">↓</a></i> are eager.<i> list<a class="IndexReference" name="entry-list-2" href="#index-list">↓</a></i> is an eager function which returns all its arguments in a list.
</div>
<div class="Indented">
Here is a more complex function definition:
</div>
<pre class="LyX-Code">
def factorial<a class="IndexReference" name="entry-factorial-0" href="#index-factorial">↓</a> (n)
   if (&lt; n 2) 1
      * n
        factorial (- n 1)
</pre>
<div class="Unindented">
The<i> if<a class="IndexReference" name="entry-if-0" href="#index-if">↓</a></i> function is lazy, since, depending on the value of the first argument, it executes only one of its other two arguments . In fact,<i> if</i> is a macro<a class="IndexReference" name="entry-macro-0" href="#index-macro">↓</a> - a special kind of lazy function which we introduce later.
</div>
<h1 class="Section">
<a class="toc" name="toc-Section-2">2</a> Bindings and Variables
</h1>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-2.4.1">2.4.1</a> Definition of Variables
</h3>
<div class="Unindented">
New variables are created with the<i> defvar<a class="IndexReference" name="entry-defvar-0" href="#index-defvar">↓</a></i> or<i> define<a class="IndexReference" name="entry-define-1" href="#index-define">↓</a></i> functions. These functions also take an initial value for the variable:
</div>
<pre class="LyX-Code">
define name ’William’
defvar ^name ’William’
</pre>
<div class="Unindented">
In both examples, the symbol<i> name</i> is bound to the value<i> &ldquo;William&rdquo;</i> in the current environment. After the variable has been bound, its value can be used in any expression in the scope. The<i> define</i> function has an alias<i> var</i> which is quicker to type:
</div>
<pre class="LyX-Code">
<b>var</b> name ’William’
</pre>
<div class="Unindented">
When the interpreter sees a symbol in an argument list it looks for a binding in the current environment and all parent environments right up to the global execution environment. If you define a variable at the command line, it is bound in the global execution environment and hence is available everywhere. If you try to access a variable when there is no binding, an "unbound variable" error will be reported.
</div>
<div class="Indented">
Variable values can be updated with the<i> set</i> or<i> setq</i> functions, for example:
</div>
<pre class="LyX-Code">
set ^name ’William Pitt<a class="IndexReference" name="entry-William-Pitt-0" href="#index-William-Pitt">↓</a>’
setq name ’William Pitt’
</pre>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-1"></a><i>var<a class="IndexReference" name="entry-var-0" href="#index-var">↓</a></i>
</div>
<div class="Unindented">
This macro creates a lexical bining between the <i>symbol</i> and the result of the <i>value expression</i>. A alias for <i>define</i>.
</div>
<div class="Indented">
Syntax
</div>
<pre class="LyX-Code">
var &lt;symbol&gt; &lt;value expression&gt;
</pre>
<div class="Unindented">
Example
</div>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-2"></a><i>defvar<a class="IndexReference" name="entry-defvar-1" href="#index-defvar">↓</a></i>
</div>
<div class="Unindented">
This eager function creates a binding between the supplied symbol and the value. Symbols can be generated or obtained at run-time. The return value is the <i>&lt;value</i>&gt;.
</div>
<div class="Indented">
Syntax
</div>
<pre class="LyX-Code">
defvar &lt;symbol&gt; &lt;value&gt;
</pre>
<div class="Unindented">
Examples
</div>
<pre class="LyX-Code">
assertEqual
   ’Foosball’
   defvar (intern ’new-var’) ’Foosball’
</pre>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-3"></a><i>define<a class="IndexReference" name="entry-define-2" href="#index-define">↓</a></i>
</div>
<div class="Unindented">
This lazy function creates a binding between the supplied symbol and the value. Symbols are not evaluated, hence are ’hard-coded’ in the expression. The return value is the <i>&lt;value</i>&gt;.
</div>
<div class="Indented">
Syntax
</div>
<pre class="LyX-Code">
defvar &lt;symbol&gt; &lt;value&gt;
</pre>
<div class="Unindented">
Examples
</div>
<pre class="LyX-Code">
assertEqual 20 (define twenty 20)
assertEqual twenty 20
</pre>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-4"></a><i>bound?<a class="IndexReference" name="entry-bound?-1" href="#index-bound?">↓</a></i>
</div>
<div class="Unindented">
An eager predicate function <i>bound?<a class="IndexReference" name="entry-bound?-2" href="#index-bound?">↓</a></i> tests whether a symbol has a binding in the current environments. Bindings can be created by:
</div>
<ul>
<li>
argument declaration in a closure, such as in a <i>def, defmacro, function</i>, etc
</li>
<li>
with <i>defvar</i> or <i>define</i>
</li>
<li>
with a Dymanic Symbol bound to an object
</li>

</ul>
<div class="Unindented">
It returns the symbol<i> true</i> if the variable is defined otherwise<i> nil<a class="IndexReference" name="entry-nil-1" href="#index-nil">↓</a></i>.
</div>
<div class="Indented">
Syntax
</div>
<pre class="LyX-Code">
bound? &lt;symbol&gt;
</pre>
<div class="Unindented">
Examples
</div>
<pre class="LyX-Code">
&gt; define s 12
&gt; bound? ^s
true  # SimpleSymbol

&gt; (dict)
   define .x 33
   bound? ^.x
true # SimpleSymbol

assert
   ^(2)(bound? ^.left)
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-2.4.2">2.4.2</a> Assignment
</h3>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-5"></a><i>setq<a class="IndexReference" name="entry-setq-0" href="#index-setq">↓</a></i>
</div>
<div class="Unindented">
This lazy function is identical to <i>define</i>, however the binding must have been previously declared. Example:use 
</div>
<pre class="LyX-Code">
&gt; setq tweny 200
*** Error - ’unbound: tweny’
assertEqual 20 (define twenty 20)
assertEqual 200 (setq twenty 200)
</pre>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-6"></a><i>set<a class="IndexReference" name="entry-set-0" href="#index-set">↓</a></i>
</div>
<div class="Unindented">
This lazy funtion is identical to <i>def</i> var, however the binding must have been previously declared. Example:
</div>
<pre class="LyX-Code">
def func (another-var)
   set (left (list ^another-var)) ’Tennis’
assertEqual ’Tennis’ (func 123)
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-2.4.3">2.4.3</a> Definition of Functions
</h3>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-7"></a><i>def<a class="IndexReference" name="entry-def-1" href="#index-def">↓</a></i>
</div>
<div class="Unindented">
The <i>def</i> macro declares new eager functions. Refer to <a class="Reference" href="#sec:Functions-and-Macros">4↓</a> for details.
</div>
<div class="Subparagraph*">
Syntax
</div>
<pre class="LyX-Code">
def &lt;name&gt; &lt;argument list&gt; &lt;body&gt;
</pre>
<div class="Unindented">
Where <i>&lt;name&gt; </i>is a symbol, <i>&lt;argument list&gt;</i> is a list of simple symbols and type declarators and <i>&lt;body&gt;</i> is a sequence of expressions. The <i>def</i> macro is equivalent to <i>define</i> and <i>function, </i>and has the effect of:
</div>
<pre class="LyX-Code">
define &lt;name&gt; 
   function &lt;argument list&gt; &lt;body&gt;
</pre>
<div class="Unindented">
Example:
</div>
<pre class="LyX-Code">
def square(x)
   * x x
assertEqual 64 (square 8)
</pre>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-8"></a><i>df<a class="IndexReference" name="entry-df-0" href="#index-df">↓</a></i>
</div>
<div class="Unindented">
The <i>def</i> macro declares new lazy functions. Refer to <a class="Reference" href="#sec:Functions-and-Macros">4↓</a> for details.
</div>
<div class="Subparagraph*">
Syntax
</div>
<pre class="LyX-Code">
df &lt;name&gt; &lt;argument list&gt; &lt;body&gt;
</pre>
<div class="Unindented">
Where <i>&lt;name&gt; </i>is a symbol, <i>&lt;argument list&gt;</i> is a list of simple symbols and type declarators and <i>&lt;body&gt;</i> is a sequence of expressions. The <i>df</i> macro is equivalent to <i>define</i> and <i>lamdaq, </i>and has the effect of:
</div>
<pre class="LyX-Code">
define &lt;name&gt; 
   lambdaq &lt;argument list&gt; &lt;body&gt;
</pre>
<div class="Unindented">
Example:
</div>
<pre class="LyX-Code">
df rev-quote (x)
    reverse x
assertEqual
   ^(3.4 ’s’ 2 w +)
   rev-quote 
       + w 2 ’s’ 3.4
</pre>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-9"></a><i>defmacro<a class="IndexReference" name="entry-defmacro-0" href="#index-defmacro">↓</a></i>
</div>
<div class="Unindented">
The <i>defmacro</i> macro declares new lazy functions which evaluate twice, once in the lexical scope of the function, the return value of which is evaluated in the environment of the caller. Refer to <a class="Reference" href="#sec:Functions-and-Macros">4↓</a> for details.
</div>
<div class="Subparagraph*">
Syntax
</div>
<pre class="LyX-Code">
defmacro &lt;name&gt; &lt;argument list&gt; &lt;body&gt;
</pre>
<div class="Unindented">
Where <i>&lt;name&gt; </i>is a symbol, <i>&lt;argument list&gt;</i> is a list of simple symbols and type declarators and <i>&lt;body&gt;</i> is a sequence of expressions. The <i>defmacro</i> macro is equivalent to <i>define</i> and <i>lamdam, </i>and has the effect of:
</div>
<pre class="LyX-Code">
define &lt;name&gt; 
   lambdam &lt;argument list&gt; &lt;body&gt;
</pre>
<div class="Unindented">
Example. Here we define a macro, <i>@</i>, which is equivalent to <i>define</i>:
</div>
<pre class="LyX-Code">
defmacro @ (variable valu)
   template
      defvar ^$variable $valu
assertEqual
   @ w 123
   123
assertEqual w 123
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-2.4.4">2.4.4</a> <i>symbol-value<a class="IndexReference" name="entry-symbol-value-0" href="#index-symbol-value">↓</a></i> &lt;symbol&gt;
</h3>
<div class="Unindented">
Returns the value of the binding of it’s argument in the current lexical or dynamic scope.
</div>
<div class="Indented">
Example:
</div>
<pre class="LyX-Code">
&gt; (dict (.a = 1)(.b = 2))
    (symbol-value ^.b)

2 # Bignum
</pre>
<div class="Unindented">
More complex example:
</div>
<pre class="LyX-Code">
&gt; var D (dict (.a=1)(.b=2))

&gt; for v in D
   u:format "%s = %s\n" v (D (symbol-value v))

.b = 2
.a = 1
.self = (dict (.a = 1) (.b = 2))
.vars = (.b .a .self .vars .classes)
.classes = (&lt;class Dictionary (Builtin)&gt;)

</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-2.4.5">2.4.5</a> <i>dynamic-symbol-value<a class="IndexReference" name="entry-dynamic-symbol-value-0" href="#index-dynamic-symbol-value">↓</a></i> &lt;symbol&gt;
</h3>
<div class="Unindented">
This function returns a dynamic symbol reference given a simple symbol. 
</div>
<div class="Subparagraph*">
Syntax:
</div>
<pre class="LyX-Code">
dynamic-symbol-value &lt;symbol&gt;
</pre>
<div class="Unindented">
Example:
</div>
<pre class="LyX-Code">
&gt; dynamic-symbol-value ^left
.left # DynamicSymbolRef
</pre>
<div class="Unindented">
Example, here the dynamic symbol reference is dynamically created from the string <i>’right’</i> via <i>intern</i>:
</div>
<pre class="LyX-Code">
assertEqual
   45
   ^(78 = 45)
       eval 
          dynamic-symbol-value (intern ’right’)

</pre>
<h1 class="Section">
<a class="toc" name="toc-Section-3">3</a> Control Flow
</h1>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-3.1">3.1</a> Predicates
</h2>
<div class="Unindented">
Predicates are a general class of functions which either return<i> nil</i> to signify falsehood, or a non<i>-nil</i> value for truth.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-3.1.1">3.1.1</a> <i>nil<a class="IndexReference" name="entry-nil-2" href="#index-nil">↓</a></i>
</h3>
<div class="Unindented">
This symbol is used to denote an empty list, the end of a list. It is used by the conditional macro<i> cond</i> amongst others to denote falsehood.<i> nil</i> is bound to itself in the global environment. The empty list<i> ()</i> is a synonym for nil.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-3.1.2">3.1.2</a> true<a class="IndexReference" name="entry-true-0" href="#index-true">↓</a>
</h3>
<div class="Unindented">
A convenient symbol used to explicitly signal the opposite of<i> nil</i>,<i> true</i> is bound to itself in the global environment.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-3.1.3">3.1.3</a> Comparisons
</h3>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-10"></a>eq? &lt;a&gt; &lt;b&gt;
</div>
<div class="Unindented">
The<i> eq?</i> function compares two expressions to see if they are the same physical object in the interpreter memory. In other words it returns<i> true if</i> the by-value references passed in as parameters are the same, otherwise<i> nil</i> is returned. Examples:
</div>
<div class="Indented">
<table>
<tr>
<td align="center" valign="top">
Expression
</td>
<td align="center" valign="top">
<i>eq?</i> return
</td>

</tr>
<tr>
<td align="center" valign="top">
eq? ^a ^a
</td>
<td align="center" valign="top">
true
</td>

</tr>
<tr>
<td align="center" valign="top">
eq? 1 1
</td>
<td align="center" valign="top">
nil
</td>

</tr>
<tr>
<td align="center" valign="top">
eq? ’c’ ’c’
</td>
<td align="center" valign="top">
nil
</td>

</tr>

</table>

</div>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-11"></a>equal?
</div>
<div class="Unindented">
The<i> equal?</i> function compares the contents of two expressions and returns<i> true</i> if they have the same value, otherwise<i> nil.</i> If two expressions are<i> eq?</i> they are also<i> equal?</i>.
</div>
<div class="Indented">
<table>
<tr>
<td align="center" valign="top">
Expression
</td>
<td align="center" valign="top">
<i>equal?</i> return
</td>

</tr>
<tr>
<td align="center" valign="top">
equal? ^a ^a
</td>
<td align="center" valign="top">
true
</td>

</tr>
<tr>
<td align="center" valign="top">
equal? 1 1
</td>
<td align="center" valign="top">
true
</td>

</tr>
<tr>
<td align="center" valign="top">
equal? ’c’ ’c’
</td>
<td align="center" valign="top">
true
</td>

</tr>
<tr>
<td align="center" valign="top">
equal? ^(1 2) ^(1 2)
</td>
<td align="center" valign="top">
true
</td>

</tr>
<tr>
<td align="center" valign="top">
equal? (dict (.a=2))(dict(.a=2))
</td>
<td align="center" valign="top">
false
</td>

</tr>

</table>

</div>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-12"></a>&gt;
</div>
<div class="Unindented">
The greater-than function returns<i> true</i> if its first argument is numerically greater than its second argument.
</div>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-13"></a>&lt;
</div>
<div class="Unindented">
The less-than function returns<i> true</i> if its first argument is numerically less than its second argument.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-3.1.4">3.1.4</a> Logical Functions
</h3>
<div class="Unindented">
Genyris has a set of boolean functions which expect arguments which are either<i> nil</i> to signify falsehood or non-<i>nil</i> for truth.
</div>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-14"></a>not<a class="IndexReference" name="entry-not-0" href="#index-not">↓</a> &lt;x&gt;, null?
</div>
<div class="Unindented">
If the argument is<i> nil</i> these functions return<i> true</i> otherwise<i> nil</i> is returned<i>.</i>
</div>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-15"></a>and<a class="IndexReference" name="entry-and-0" href="#index-and">↓</a> &lt;a1&gt; &lt;a2&gt; ...
</div>
<div class="Unindented">
This macro executes its arguments in turn, if an argument evaluates to a<i> nil</i> value execution stops and it returns<i> nil.</i>Otherwise execution continues to the last argument whose value is returned. Examples:
</div>
<div class="Indented">
<table>
<tr>
<td align="center" valign="top">
Expression
</td>
<td align="center" valign="top">
Result
</td>
<td align="center" valign="top">
Comment
</td>

</tr>
<tr>
<td align="center" valign="top">
and 1 2 3 4 5
</td>
<td align="center" valign="top">
5
</td>
<td align="center" valign="top">

</td>

</tr>
<tr>
<td align="center" valign="top">
and 1 2 3 nil 5
</td>
<td align="center" valign="top">
nil
</td>
<td align="center" valign="top">

</td>

</tr>
<tr>
<td align="center" valign="top">
and (print 1) (print 2)
</td>
<td align="center" valign="top">
true
</td>
<td align="center" valign="top">
Both 1 and 2 are printed
</td>

</tr>
<tr>
<td align="center" valign="top">
and (not (print 1)) (print 2)
</td>
<td align="center" valign="top">
nil
</td>
<td align="center" valign="top">
1 is printed
</td>

</tr>

</table>

</div>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-16"></a>or<a class="IndexReference" name="entry-or-0" href="#index-or">↓</a>
</div>
<div class="Unindented">
This macro executes its arguments in turn, if an argument evaluates to a non-<i>nil</i> value execution stops and it returns<i> true.</i> Examples:
</div>
<div class="Indented">
<table>
<tr>
<td align="center" valign="top">
Expression
</td>
<td align="center" valign="top">
Result
</td>
<td align="center" valign="top">
Comment
</td>

</tr>
<tr>
<td align="center" valign="top">
or 1 2 3 4 5
</td>
<td align="center" valign="top">
1
</td>
<td align="center" valign="top">

</td>

</tr>
<tr>
<td align="center" valign="top">
or nil 2 3 nil 5
</td>
<td align="center" valign="top">
2
</td>
<td align="center" valign="top">

</td>

</tr>
<tr>
<td align="center" valign="top">
or (print 1) (print 2)
</td>
<td align="center" valign="top">
true
</td>
<td align="center" valign="top">
1 is printed
</td>

</tr>
<tr>
<td align="center" valign="top">
or (not (print 1)) (print 2)
</td>
<td align="center" valign="top">
true
</td>
<td align="center" valign="top">
1 and 2 are printed
</td>

</tr>

</table>

</div>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-3.2">3.2</a> Conditional Execution
</h2>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-3.2.1">3.2.1</a> cond
</h3>
<div class="Unindented">
The<i> cond<a class="IndexReference" name="entry-cond-0" href="#index-cond">↓</a></i> function is a lazy function that allows program flow to change depending on the outcome of conditional expressions. Here’s the syntax of<i> cond</i>:
</div>
<pre class="LyX-Code">
   cond
      (&lt;condition 1&gt;)
         &lt;sequence 1&gt;
      (&lt;condition 2&gt;)
         &lt;sequence 2&gt;
      ...
      (&lt;condition N&gt;)
         &lt;sequence N&gt;
</pre>
<div class="Unindented">
Each condition is evaluated in turn until one returns which is not<i> nil</i>. The associated sequence is evaluated and the value of the last expression in the sequence is returned. If there is no sequence, the value of the condition is returned. Typically the last condition is a non-nil constant and its sequence is the default. The symbol<i> else<a class="IndexReference" name="entry-else-0" href="#index-else">↓</a></i> is provided for this purpose. Here’s an example:
</div>
<pre class="LyX-Code">
   cond
      (equal? foo 1)
         ’One’
      (equal? foo 2)
         ’Two’
      else
         ’Other’

</pre>
<div class="Unindented">
The function<i> equal?<a class="IndexReference" name="entry-equal?-0" href="#index-equal?">↓</a></i> returns<i> true<a class="IndexReference" name="entry-true-1" href="#index-true">↓</a></i> if the two arguments are the same otherwise<i> nil</i>. So if the symbol<i> foo</i> is bound to the value 2 this expression will return<i> ’Two’</i>.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-3.2.2">3.2.2</a> <i>if<a class="IndexReference" name="entry-if-1" href="#index-if">↓</a></i>
</h3>
<div class="Unindented">
The<i> if</i> statement is a shortened form of the<i> cond</i> function, it only allows a single condition with the following syntax:
</div>
<pre class="LyX-Code">
if &lt;condition&gt;
   &lt;evaluated if condition is not nil&gt;
   &lt;evaluated if is nil&gt;
</pre>
<div class="Unindented">
It could be called the ’if-not-nil’ statement because it’s action depends on whether the condition expression is<i> nil</i> or not. Example:
</div>
<pre class="LyX-Code">
if (&lt; n 2) 1
      * n
        factorial (- n 1)
</pre>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-3.3">3.3</a> Looping and Iterators
</h2>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-3.3.1">3.3.1</a> Simple looping with<i> while<a class="IndexReference" name="entry-while-0" href="#index-while">↓</a></i>
</h3>
<div class="Unindented">
Syntax:
</div>
<pre class="LyX-Code">
while &lt;expression&gt;
    &lt;body&gt;
</pre>
<div class="Unindented">
Example:
</div>
<pre class="LyX-Code">
define names ^(Church McCarthy Russell)
while names
   print names
   setq names (right names)
</pre>
<div class="Unindented">
outputs:
</div>
<pre class="LyX-Code">
Church McCarthy Russell
McCarthy Russell
Russell
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-3.3.2">3.3.2</a> Creating Iterators with .mkIterator<a class="IndexReference" name="entry-.mkIterator-0" href="#index-.mkIterator">↓</a>
</h3>
<div class="Unindented">
Syntax:
</div>
<pre class="LyX-Code">
&lt;expression&gt;(.mkIterator)
</pre>
<div class="Unindented">
Example:
</div>
<pre class="LyX-Code">
define L ^(1 2)
define iter (L(.mkIterator))
assert
   equal?
      list (iter) (iter) (iter)
      ^(1 2 sys:StopIteration)
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-3.3.3">3.3.3</a> Traversing with<i> for</i>
</h3>
<div class="Unindented">
Syntax:
</div>
<pre class="LyX-Code">
for &lt;var&gt; in &lt;expression-with-.mkIterator&gt;
    &lt;body&gt;
</pre>
<div class="Unindented">
List example:
</div>
<pre class="LyX-Code">
define n ^(1 2)
define z ^(A B)
for v1 in n
   for v2 in z
        u:format "%s %s\n" v1 v2
</pre>
<div class="Unindented">
prints:
</div>
<pre class="LyX-Code">
1 A
1 B
2 A
2 B
</pre>
<div class="Unindented">
A dictionary example:
</div>
<pre class="LyX-Code">
var D (dict (.a=1)(.b=2))

for v in D
   u:format "%s = %s\n" v (D (symbol-value v))
</pre>
<div class="Unindented">
prints:
</div>
<pre class="LyX-Code">
.a = 1
.b = 2
.self = (dict (.a = 1) (.b = 2))
.vars = (.a .b .self .vars .classes)
.classes = (&lt;class Dictionary (Builtin)&gt;)
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-3.3.4">3.3.4</a> Ranges
</h3>
<div class="Unindented">
Syntax:
</div>
<pre class="LyX-Code">
range &lt;low&gt; &lt;high&gt;
</pre>
<div class="Unindented">
Example:
</div>
<pre class="LyX-Code">
&gt; var R (range 1 3)
(1 3) # Range Pair
&gt; var iter (R(.mkIterator))
&lt;EagerProc: &lt;anonymous lambda&gt;&gt; # RangeIterator EagerProcedure
&gt; iter
1 # Bignum
&gt; iter
2 # Bignum
</pre>
<div class="Unindented">
An example with<i>for:</i>
</div>
<pre class="LyX-Code">
&gt; var array ^(A B C D E F)
&gt; for i in (range 3 5)
     print (nth i array)
~ D
~ E
~ F
</pre>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-3.4">3.4</a> Exceptions
</h2>
<div class="Unindented">
The Genyris interpreter signals errors via exceptions. Exceptions are ’raised’ by the code that detected the error. When the interpreter is told to raise an exception it unrolls the execution stack until either the exeption is caught by a<i> catch</i> statement, the program halts. In some cases (perhaps due to a bug in the interpreter, or terminal conditions such as out of memory, the program prints the internal java stack and halts.) Sinec the interpreter has to do a lot of work to pop the stack, exceptions are not an efficient mechanism and are designed for handling exceptional circumstances.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-3.4.1">3.4.1</a> Popping the execution stack with<i> raise</i>
</h3>
<div class="Unindented">
To signal an error in a Genyris program, and to ask the interpreter to unroll the stack, use the<i> raise</i> function. This takes an object as its single argument which is passed up to the stack and is given to any<i> catch</i> functions which are above it in the stack. This way, details of the state of the system can be passed to error handling routines.
</div>
<div class="Indented">
Syntax:
</div>
<pre class="LyX-Code">
raise &lt;exception object&gt;
</pre>
<div class="Unindented">
For example, here we raise an exception in a base class if an abstract method is used:
</div>
<pre class="LyX-Code">
def .toMeters()
   raise "Oops - you invoked an abstract method."
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-3.4.2">3.4.2</a> Catching exceptions with<i> catch<a class="IndexReference" name="entry-catch-0" href="#index-catch">↓</a></i>
</h3>
<div class="Unindented">
The<i> catch</i> function executes a sequence of expressions, if no exception is raised it returns the value of the last expression. If an exception is raised during evaluation of the expressions, the exception object is assigned to a nominated variable. Without this function all errors would cause program execution to halt.
</div>
<div class="Indented">
Syntax:
</div>
<pre class="LyX-Code">
catch &lt;variable name&gt;
   &lt;expression&gt;
   &lt;expression&gt;
   ...
</pre>
<div class="Unindented">
A second form of the function allows the user to capture the debug backtrace stack at the time of the error. An additional variable name is supplied, and the backtrace list is assigned to it.
</div>
<div class="Indented">
Syntax:
</div>
<pre class="LyX-Code">
catch (&lt;error variable name&gt; &lt;backtrace variable&gt;)
   &lt;expression&gt;
   &lt;expression&gt;
   ...
</pre>
<div class="Unindented">
Here is a simplified top-level command line interpreter loop by way of example. Expressions are read from the keyboard and executed. If any exceptions are raised by the system or by the<i> raise</i> function they are caught and printed. Execution resumes. If the<i> catch</i> function was not used, the interpreter would stop execution of the loop at the first exception:
</div>
<pre class="LyX-Code">
while true
   display ’\n&gt;&gt; ’
   catch (errors backtrace)
       define expression (read true)
       define result (eval expression)
   cond
       errors
          print backtrace
          print error
       else
          print result
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-3.4.3">3.4.3</a> Inserting program checks with<i> assert<a class="IndexReference" name="entry-assert-0" href="#index-assert">↓</a></i>
</h3>
<div class="Unindented">
Often it is useful to insert checks in programs for invariant conditions that must be met. The<i> assert</i> macro provides a handy way to insert checks. If the expression passed to assert for evaluation is not<i> nil</i>, an exception is automatically raised including the source code of the expression. Syntax:
</div>
<pre class="LyX-Code">
 assert &lt;expression&gt;
</pre>
<div class="Unindented">
Example execution:
</div>
<pre class="LyX-Code">
&gt; assert (equal? 1 2)

*** Error - ("assert failed on expression: " (equal? 1 2))
~ ’&lt;LazyProcedure: cond&gt;’
~ ’&lt;LazyProcedure: &lt;assert&gt;&gt;’
~ ’&lt;EagerProc: eval&gt;’
~ ’&lt;LazyProcedure: &lt;define&gt;&gt;’
~ ’&lt;LazyProcedure: catch&gt;’
~ ’&lt;LazyProcedure: while&gt;’
~ ’&lt;EagerProc: &lt;|http://www.genyris.org/lang/system#read-eval-print-loop|&gt;&gt;’
</pre>
<h1 class="Section">
<a class="toc" name="toc-Section-4">4</a> Functions and Macros<a class="Label" name="sec:Functions-and-Macros"> </a>
</h1>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-4.1">4.1</a> Anonymous Functions
</h2>
<div class="Unindented">
Actually the<i> def<a class="IndexReference" name="entry-def-2" href="#index-def">↓</a></i> and<i> defmacro<a class="IndexReference" name="entry-defmacro-1" href="#index-defmacro">↓</a></i> functions are lazy functions. They bind a variable name to procedure compiled from the function body. But what if we want a function without the binding? Genyris provides three kinds of in-built procedure-building functions. The function<i> function<a class="IndexReference" name="entry-function-0" href="#index-function">↓</a></i> (aka<i> lambda<a class="IndexReference" name="entry-lambda-0" href="#index-lambda">↓</a></i>) creates a user-defined eager procedure object which is a closure at the point of definition. For example we can create an anonymous function at the command-line:
</div>
<pre class="LyX-Code">
&gt; function (x) (* x x)

~ &lt;org.genyris.interp.ClassicFunction&gt; # EagerProcedure
</pre>
<div class="Unindented">
To actually call it we place it wherever a function is expected, such as a parameter to a function, or at the beginning of a list:
</div>
<pre class="LyX-Code">
&gt; (function (x) (* x x)) 3

~ 9 # Bignum
</pre>
<div class="Unindented">
Notice the parentheses are required around the expression to trigger the execution. The argument 3 is passed to the resulting closure. Functions are ’first class’ and can be assigned to variables, which is how<i> def</i> works. The following two expressions are equivalent:
</div>
<pre class="LyX-Code">
define square
   function (x) (* x x)

def square (x)
   * x x
</pre>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-4.2">4.2</a> Closures
</h2>
<div class="Unindented">
Closures are executable objects which retain the environment in which they were created for use during execution at a later time. 
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.2.1">4.2.1</a> <i>lambda</i> or<i> function</i><a class="IndexReference" name="entry-lambda-1" href="#index-lambda">↓</a>
</h3>
<pre class="LyX-Code">
[function|lambda] ([arg1]... [&amp;rest restargs] [= return-validator]) [body]
</pre>
<div class="Unindented">
The<i> function<a class="IndexReference" name="entry-function-1" href="#index-function">↓</a></i> macro creates a lexical closure at the point of definition and returns an anonymous ’eager’ procedure object.<i> lambda<a class="IndexReference" name="entry-lambda-2" href="#index-lambda">↓</a></i> is an alias for<i> function</i> and is kept for historical reasons. The procedure object can be invoked as a function. When the procedure is called its real arguments must match the formal arguments specified in the function definition. The formal arguments may have one of the following forms:
</div>
<pre class="LyX-Code">
()                     - no arguments
(arg1 arg2 ... argn)   - a list of required arguments
(... &amp;rest &lt;argsvar&gt;)    - variable arguments
</pre>
<div class="Unindented">
If the argument list includes &amp;rest, all the remaining real arguments are collected into a list and passed to the function in a single argument, the name of which is specified after the &amp;rest<a class="IndexReference" name="entry-&amp;rest-0" href="#index-&amp;rest">↓</a>.
</div>
<div class="Indented">
The function body - a list of expressions - is executed each expression in turn, the last evaluation is returned by the function. Formal arguments may be specified in two forms, either as a symbol or as a type specification. If a symbol is used, the real arguments are bound to the symbol in the execution environment of the function when it is called. The type of the formal argument may be supplied as the right hand side of a cons pair:
</div>
<pre class="LyX-Code">
(arg-name = validator)
</pre>
<div class="Unindented">
The validator must be a symbol bound to a dictionary or class which has a validator function (<i>.valid?<a class="IndexReference" name="entry-.valid?-0" href="#index-.valid?">↓</a></i>). When the procedure is called, the interpreter executes the <i>.valid?</i> function with the real argument as its single parameter. If the validator returns false, a type miss-match error is raised.
</div>
<div class="Indented">
The expected type of the return value can be specified after a trailing = in the argument list.
</div>
<div class="Paragraph-">
<a class="toc" name="toc-Paragraph--1"></a>Examples:
</div>
<pre class="LyX-Code">
function ()
</pre>
<div class="Unindented">
returns a procedure which returns nil
</div>
<pre class="LyX-Code">

function (x y) (cons x y)
</pre>
<div class="Unindented">
returns a procedure with two mandatory arguments
</div>
<pre class="LyX-Code">

function (x &amp;rest y) (list x y)
</pre>
<div class="Unindented">
returns a procedure with one mandatory and one rest argument
</div>
<pre class="LyX-Code">

function ((i = Bignum) (j = Bignum) = Bignum) (+ i j)
</pre>
<div class="Unindented">
returns a procedure with two mandatory arguments with expected types and a return value with expected type.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.2.2">4.2.2</a> Closures Capture Environments
</h3>
<div class="Unindented">
Genyris is "lexically scoped" - when a function is created it remembers the environment in which it was defined and re-uses that environment when it executes. This provides a way of hiding data and giving functions stateful side effects. The following example<span class="FootOuter"><span class="SupFootMarker"> [C] </span><span class="HoverFoot"><span class="SupFootMarker"> [C] </span>refer to Abelson and Sussmans’ book&ldquo;Structure and Interpretation of Computer Programs&rdquo;</span></span> creates a function which captures the<i> balance</i> variable:
</div>
<pre class="LyX-Code">
def make-withdraw (balance)
   function (amount)
      setq balance (- balance amount)

define W1 (make-withdraw 100)

&gt; W1 25
W1 25

~ 75 # Bignum
~ 50 # Bignum
</pre>
<div class="Unindented">
Repeated execution of the function<i> W1</i> reduces the value of the balance each time. The sequence of evaluation is as follows:
</div>
<ol>
<li>
the lazy<i> def</i> expression is executed which results in a procedure object bound to the symbol<i> make-withdraw</i>
</li>
<li>
the<i> balance</i> argument (<i>100</i>) to the eager<i> define</i> expression is evaluated and<i> make-withdraw</i> is called<i>.</i>
</li>
<li>
the eager<i> make-withdraw</i> creates a new environment in which it binds<i> balance</i> to<i>100</i>
</li>
<li>
the body of<i> make-withdraw</i> is evaluated resulting in another procedure object which captures a reference to<i> balance</i> and contains the executable code starting with<i> setq</i>
</li>
<li>
the procedure object is bound to W1
</li>
<li>
<i>W1</i> is called with the argument 25
</li>
<li>
the procedure<i>W1</i> subtracts 25 from the<i> balance</i> binding in theenvironment created in step 3
</li>

</ol>
<div class="Unindented">
Note that there is no way to directly access the<i> balance</i> variable.
</div>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-4.3">4.3</a> Explicit Evaluation
</h2>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.3.1">4.3.1</a> eval<a class="IndexReference" name="entry-eval-0" href="#index-eval">↓</a> &lt;expression&gt;
</h3>
<div class="Unindented">
The <i>eval</i> function returns the result of evaluating the expression in the environment of the caller. Since eval is an eager function, the expression is evaluated twice, once as a parameter and once by <i>eval</i> itself.<i> </i>
</div>
<div class="Paragraph-">
<a class="toc" name="toc-Paragraph--2"></a>Syntax:
</div>
<pre class="LyX-Code">
eval &lt;expression&gt;
</pre>
<div class="Paragraph-">
<a class="toc" name="toc-Paragraph--3"></a>Examples:
</div>
<pre class="LyX-Code">
assertEqual ^alpha
   eval ^(left ^(alpha beta gamma))
do
   define alpha 1
   assertEqual 1
      eval (left ^(alpha beta gamma))

</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.3.2">4.3.2</a> apply<a class="IndexReference" name="entry-apply-0" href="#index-apply">↓</a>
</h3>
<div class="Unindented">
The apply function returns the result of executing the closure with the argument list.
</div>
<div class="Paragraph-">
<a class="toc" name="toc-Paragraph--4"></a>Syntax:
</div>
<pre class="LyX-Code">
apply &lt;closure&gt; &lt;argument list&gt;
</pre>
<div class="Paragraph-">
<a class="toc" name="toc-Paragraph--5"></a>Examples:
</div>
<pre class="LyX-Code">
assertEqual 6
   apply + ^(1 2 3)

assertEqual ^(23 = 23)
   apply
      function(x) (cons x x)
      ^(23)
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.3.3">4.3.3</a> tailcall &lt;closure&gt; &lt;Arguments...&gt;
</h3>
<div class="Unindented">
To eliminate use of the stack, a function can be called using the current stack. When the tailcall function is called it creates a TailCall obect which contains the closure and arguments provided. If this object is the return value of the currently interpreted function, the interpreter applies the &lt;closure&gt; to the &lt;arguments...&gt; without pushing the stack. This allows infinite recursion. For example this function will cause a stack overflow error:
</div>
<pre class="LyX-Code">
def overflow(i)
   print i
   overflow (+ i 1)
</pre>
<div class="Unindented">
Whereas the tailcall version can print out any number of integers:
</div>
<pre class="LyX-Code">
def infinite(i)
   print i
   tailcall infinite (+ i 1)
</pre>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-4.4">4.4</a> Anonymous Lazy Functions
</h2>
<div class="Unindented">
To defer evaluation, a lazy function can be defined using the<i> lambdaq<a class="IndexReference" name="entry-lambdaq-0" href="#index-lambdaq">↓</a></i> or<i> lambdam<a class="IndexReference" name="entry-lambdam-0" href="#index-lambdam">↓</a></i> macros.<i> lambdaq</i> is just like<i> function</i> except it builds a lazy procedure,<i> lambdam</i> builds anonymous macros. The next example creates an anonymous function which prepends its argument (without evaluation) to a list:
</div>
<pre class="LyX-Code">
&gt; (<b>lambdaq</b> (x) (list x ’World’)) (+ ’Hello’)

(+ ’Hello’) ’World’ # Pair
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.4.1">4.4.1</a> <i>lambadq<a class="IndexReference" name="entry-lambadq-0" href="#index-lambadq">↓</a></i>
</h3>
<div class="Unindented">
This macro is identical in syntax to<i> function</i> but it creates an anonymous lazy procedure (which does not execute it’s arguments when called).
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.4.2">4.4.2</a> <i>lambdam<a class="IndexReference" name="entry-lambdam-1" href="#index-lambdam">↓</a></i>
</h3>
<div class="Unindented">
This macro is identical in syntax to<i> function</i> but it creates a lazy procedure which re-executes it’s return value in the environment of the caller - in other an anonymous macro.
</div>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-4.5">4.5</a> Defining Macros
</h2>
<div class="Unindented">
Macros<a class="IndexReference" name="entry-Macros-0" href="#index-Macros">↓</a> are lazy functions which are very handy for extending the syntax of the language or creating Domain-Specific Languages<a class="IndexReference" name="entry-Domain-Specific-Languages-0" href="#index-Domain-Specific-Languages">↓</a> (DSL<a class="IndexReference" name="entry-DSL-0" href="#index-DSL">↓</a>s). Macros re-evaluate the returned value in the environment of the caller. Here’s an example:
</div>
<pre class="LyX-Code">
defmacro trace(&amp;rest body)
  print body
  body
</pre>
<div class="Unindented">
This macro prints an expression which is then evaluated. The keyword<i> &amp;rest<a class="IndexReference" name="entry-&amp;rest-1" href="#index-&amp;rest">↓</a></i> tells the interpreter to collate the values of all remaining arguments into the single variable<i> body</i>. So when called with:
</div>
<pre class="LyX-Code">
&gt; trace (+ 1 2)
</pre>
<div class="Unindented">
It prints the expression and the result is calculated:
</div>
<pre class="LyX-Code">
(+ 1 2)
~ 3 # Bignum
</pre>
<div class="Unindented">
Here is a more complex example - definition of a control flow function:
</div>
<pre class="LyX-Code">
defmacro my-if (test success-result failure-result)
   template
      cond
         $test $success-result
         else $failure-result
</pre>
<div class="Unindented">
This macro uses the<i> template<a class="IndexReference" name="entry-template-1" href="#index-template">↓</a></i> function and<i> dollar<a class="IndexReference" name="entry-dollar-2" href="#index-dollar">↓</a></i> to splice the arguments into a formulaic expression. Here’s an example if its use:
</div>
<pre class="LyX-Code">
define test 3    # binding in the caller’s environment
my-if (equal? test 3) 1 2
</pre>
<div class="Unindented">
This returns 1. Notice how the variable<i> test</i> is defined in the caller’s environment used in the condition, not the binding of the same name within<i> my-if</i>.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.5.1">4.5.1</a> An Example: Executable Comments
</h3>
<div class="Unindented">
Sometimes it’s necessary to temporarily ’comment<a class="IndexReference" name="entry-comment-0" href="#index-comment">↓</a> out’ functions or provide in-line text. This is done via the function<i> ’//<a class="IndexReference" name="entry-//-0" href="#index-//">↓</a>’</i> which is a lazy function that ignores it’s arguments and return<i> nil</i>. It is defined as:
</div>
<pre class="LyX-Code">
df // (&amp;rest body)
</pre>
<div class="Unindented">
and can be used as follows:
</div>
<pre class="LyX-Code">
// def allcommentedout(arg) # to comment out an entire function
  function (x)
    cond
      (eq? nil (cdr x))
         car x
      else
         last (cdr x)

def myfun()
   // ’in-line  documentation’
   +
      // + 1   # however this causes an error because // returns nil.
          + 34
          + 45
      99
</pre>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-4.6">4.6</a> <i>template<a class="IndexReference" name="entry-template-2" href="#index-template">↓</a></i> &lt;body&gt;
</h2>
<div class="Unindented">
The <i>template</i> macro returns the body expression provided with embedded tags evaluated and inserted into the result. The macro looks for the following forms for substitution:
</div>
<pre class="LyX-Code">
$&lt;expression&gt;
(dollar &lt;expression&gt;)
$@&lt;expression&gt;
(dollar-at &lt;expression)
</pre>
<div class="Unindented">
The parser substitutes <i>,&lt;expression&gt;</i> for <i>(dollar &lt;expression&gt;)</i> and <i>$@</i> for <i>(dollar-at &lt;expression)</i>. 
</div>
<div class="Indented">
In the case of <i>(dollar &lt;expression&gt;)</i> the enclosed expression is evaluated and the result substituted in the same position in the returned list. For example:
</div>
<pre class="LyX-Code">
&gt; define X 23
&gt; template
:    a b $X d
: 
(a b 23 d) # Pair 
</pre>
<div class="Unindented">
which is the same as:
</div>
<pre class="LyX-Code">
&gt; template
:    a b (dollar X) d
: 
(a b 23 d) # Pair 
</pre>
<div class="Unindented">
To embed a list into the returned expression use $@ as in this example:
</div>
<pre class="LyX-Code">
&gt; define L ^(1 2 3)
: 
(1 2 3) # PairSource 
&gt; template
:    a b $@L c
: 
(a b 1 2 3 c) # Pair 
</pre>
<div class="Unindented">
Template is used for defining the body of macros. Lisp programmers know it as the <i>backquote</i> function. For example the <i>df</i> macro is defined this way using template.:
</div>
<pre class="LyX-Code">
defmacro df (name args &amp;rest body)
    template
        defvar ^$name (lambdaq $args $@body)
</pre>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-4.7">4.7</a> Catching Missing Functions
</h2>
<div class="Unindented">
When the interpreter executes an expression, such as <i>(proc arg1 arg2 ...)</i> but the <i>func</i> results in an <i>Unbound</i> exception<span class="FootOuter"><span class="SupFootMarker"> [D] </span><span class="HoverFoot"><span class="SupFootMarker"> [D] </span>The current implementation uses Java exceptions to trap missing functions.</span></span>, the interpreter attempts to call the function <i>sys:procedure-missing. </i>It passes the original arguments and the missing procedure expression to sys:procedure-missing. This provides the programmer with a facility to create dynamic (virtual) procedures. 
</div>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-17"></a>Syntax
</div>
<pre class="LyX-Code">
sys:procedure-missing<a class="IndexReference" name="entry-sys:procedure-missing-0" href="#index-sys:procedure-missing">↓</a> &lt;arguments&gt;
</pre>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-18"></a>Examples
</div>
<div class="Unindented">
In the first example, a generic function is defined which switches calls to dynamic functions: 
</div>
<pre class="LyX-Code">
def sys:procedure-missing(&amp;rest args)
  cond
     (is-instance? (left args) DynamicSymbolRef)
          .procedure-missing args
     else
          raise ("procedure missing: %s"(.format args))
</pre>
<div class="Unindented">
Then a class is defined which catches calls to undefined methods:
</div>
<pre class="LyX-Code">
class MyClass()
   def .method_missing(args)
        list ’meta-method’ args

var myObject
    tag MyClass (dict)

assertEqual        
   myObject(.setName ’fred’)
   ^(’meta-method’ (.setName ’fred’))  
</pre>
<div class="Unindented">
The second example is a very simple windows shell. When an unbound function is called, the <i>sys:procedure-missing </i>executes the call as a windows batch command. 
</div>
<pre class="LyX-Code">
def sys:procedure-missing(&amp;rest args)
   left
      apply os!exec (append ^(cmd /c) args)
</pre>
<div class="Unindented">
Usage:      
</div>
<pre class="LyX-Code">
define my-dir ’test\\fixtures\\gunit’
assertEqual
  dir ^/b my-dir
  ^(’test-file-one.g’ ’test-file-three.g’’test-file-two.g’)

</pre>
<h1 class="Section">
<a class="toc" name="toc-Section-5">5</a> Everything is Callable
</h1>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-5.1">5.1</a> Introduction
</h2>
<div class="Unindented">
The Genyris evaluator expects the first element of a list to be some kind of procedure<a class="IndexReference" name="entry-procedure-0" href="#index-procedure">↓</a> object - something that can compute its arguments and apply them. This is the role of traditional functions such as<i>+</i> or user-defined functions. In Genyris,<u> all</u> objects are callable, even atomic types. For example an integer can be called as a function thus:
</div>
<pre class="LyX-Code">
&gt;<b>12</b> (+ 33 44) (- 4 3)

~ 1 # Bignum
</pre>
<div class="Unindented">
Lets analyse what happens. The integer<i> 12</i> was called with two argument<i> (+ 33 44)</i> and<i> (- 4 3)</i>.<i> 12</i> is a lazy function and does not evaluate its arguments. It treats its arguments as a sequence of expressions to be evaluated in a new environment. So it calculated 333 + 44 = 77, and then 4 -3 = 1. When it reached this last expression it returned the value 1. This expression can be written in indented form with the same result as follows:
</div>
<pre class="LyX-Code">
<b>12</b>
   + 33 44
   - 4 3
</pre>
<div class="Unindented">
If an atom is called with no arguments, it simply returns itself. So at the command line typing a number alone returns the number:
</div>
<pre class="LyX-Code">
&gt; 1024

~ 1024 # Bignum
</pre>
<div class="Unindented">
As well as executing the sequence of expressions, an execution environment was created in which the number 12 is a bound to the dynamic variable<a class="IndexReference" name="entry-dynamic-variable-0" href="#index-dynamic-variable">↓</a><i>.self<a class="IndexReference" name="entry-.self-0" href="#index-.self">↓</a></i>. The variable can be used as follows:
</div>
<pre class="LyX-Code">
&gt; 12 (+<b>.self .self</b>)

~ 24 # Bignum
</pre>
<div class="Unindented">
Here the number is added to itself. The environment can also be used to create local bindings with the<i> define</i> functions:
</div>
<pre class="LyX-Code">
12
<b>define foo 987</b>
  + foo .self

~ 999 # Bignum
</pre>
<div class="Unindented">
If a symbol is called as a function it is by default evaluated to locate the binding in the current evironment. If we make the value an atom, we can use the symbol as a a keyword. For example, the symbol<i> my-do</i> could be defined like this:
</div>
<pre class="LyX-Code">
define my-do ^my-do
</pre>
<div class="Unindented">
Now whenever we call<i> my-do</i> as a function, it acts as a code block which can be used in a function:
</div>
<pre class="LyX-Code">
<b>def my-function()</b>
<b>   my-do</b>
      some-function ’Hi!’
      define a-variable 42
      print .self
</pre>
<div class="Unindented">
However there is a catch - within the context the do block of<i> .self</i> is bound to<i> my-do</i>. Hence the above function prints &ldquo;my-do&rdquo;. A better way to add new syntax is to create a macro, since<i> .self</i> is not affected.
</div>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-5.2">5.2</a> Dynamic Variables<a class="IndexReference" name="entry-Dynamic-Variables-0" href="#index-Dynamic-Variables">↓</a>
</h2>
<div class="Unindented">
’Dynamic’ variables are those which are bound in the environment of the caller and hence depend on who is evaluating the expression. In Genyris dynamic variables are limited to being properties of the currently called object, and called objects are part of their environment. In other words when an object is used as a procedure, the environment created to make the call is a merge of the object itself and a lexical environment. When prefixed with the period . character, the binding for the symbol is looked up in the dynamic context. An example will make this clearer:
</div>
<div class="Indented">
The number 12 above has two dynamic variables,<i> .self</i> and<i> .classes<a class="IndexReference" name="entry-.classes-0" href="#index-.classes">↓</a></i>. They can be accessed as follows:
</div>
<pre class="LyX-Code">
12
  print .self .classes
</pre>
<div class="Unindented">
Here we see that the<i> .classes</i> variable is referring to the class list of<i> 12.</i> It has a single class,<i> Bignum,</i> which is printed. This behaviour is the same for the other atomic types: Bignums, Pairs and Strings. Consider the following examples:
</div>
<pre class="LyX-Code">
&gt; ’What am I?’.classes

&lt;class String (Builtin)&gt; # Pair
</pre>
<div class="Unindented">
However where symbols are concerned, the evaluator always looks up the value binding. So to work with a symbol we must first quote it:
</div>
<pre class="LyX-Code">
&gt; ^a-symbol .classes

(&lt;class SimpleSymbol (Symbol)&gt;) # Pair
</pre>
<div class="Unindented">
Likewise the interpreter assumes a list is a normal function call so a quote is needed to see this behaviour:
</div>
<pre class="LyX-Code">
&gt; ^(3) .classes

&lt;class Pair (Builtin)&gt; # Pair
</pre>
<div class="Unindented">
Most atomic types have only a single dynamic variable, richer examples lie in the compound object types.
</div>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-5.3">5.3</a> Synactic Sugar - Using the exclamation mark<span class="FootOuter"><span class="SupFootMarker"> [E] </span><span class="HoverFoot"><span class="SupFootMarker"> [E] </span>The choice of this syntax is a tribute to Martin Richards<a class="IndexReference" name="entry-Martin-Richards-and-BCPL-0" href="#index-Martin-Richards-and-BCPL">↓</a>.</span></span>
</h2>
<div class="Unindented">
The exclamation mark<a class="IndexReference" name="entry-exclamation-mark-0" href="#index-exclamation-mark">↓</a>, ! (aka pling<a class="IndexReference" name="entry-pling-0" href="#index-pling">↓</a>) provides a shorthand way of accessing the properties of an object. This is implemented in the parser like quotes. Here are some examples:
</div>
<div class="Indented">
<table>
<tr>
<td align="center" valign="top">
Input Quote Sequence
</td>
<td align="center" valign="top">
Translated Expression
</td>

</tr>
<tr>
<td align="center" valign="top">
a!left
</td>
<td align="center" valign="top">
(a .left)
</td>

</tr>
<tr>
<td align="center" valign="top">
a!b!c
</td>
<td align="center" valign="top">
((a .b) .c)
</td>

</tr>
<tr>
<td align="center" valign="top">
(f).a!b
</td>
<td align="center" valign="top">
(f)(.a .b)
</td>

</tr>
<tr>
<td align="center" valign="top">
(dict)!self
</td>
<td align="center" valign="top">
((dict) .self)
</td>

</tr>
<tr>
<td align="center" valign="top">
a!b(var .x 23)
</td>
<td align="center" valign="top">
(a .b)(var .x 23)
</td>

</tr>
<tr>
<td align="center" valign="top">
.x!y
</td>
<td align="center" valign="top">
(.x .y)
</td>

</tr>

</table>

</div>
<div class="Indented">
The expression 
</div>
<pre class="LyX-Code">
(file.copy) filename ’/tmp/foo’
</pre>
<div class="Unindented">
can be written succinctly as:
</div>
<pre class="LyX-Code">
   file!copy filename ’/tmp/foo’
</pre>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-5.4">5.4</a> use &lt;object-expression&gt; &lt;body-expression&gt;
</h2>
<div class="Unindented">
The <i>use</i> function creates a dynamic environment based on the result of evaluating the <i>&lt;object-expression&gt;</i>. The <i>&lt;body-expression&gt;</i> is evaluated in the new dynamic environment. The purpose of the <i>use</i> function is to allow the properties of closures to be accessed which would normally be applied. For example if we want to acccess the source code of a function we need to use the <i>use</i> function. Closures found first in the expression are evaulauted e.g.:
</div>
<pre class="LyX-Code">
&gt; def square(x)
:    * x x
: 
&lt;EagerProc: &lt;square&gt;&gt; # EagerProcedure 

&gt; square .vars
: 
*** Error - ’no dynamic variable in environment: .vars’

</pre>
<div class="Unindented">
By wrapping the function with <i>.use</i> we can access the closure’s properties:
</div>
<pre class="LyX-Code">
&gt; use square .vars
: 
(.source .name .self .vars .classes) # Pair 
</pre>
<div class="Unindented">
And now the source code property can be accessed:
</div>
<pre class="LyX-Code">
&gt; use square .source
: 
(lambda (x) (* x x)) # Pair
</pre>
<h1 class="Section">
<a class="toc" name="toc-Section-6">6</a> Data Structures
</h1>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-6.1">6.1</a> Bignum
</h2>
<div class="Unindented">
Numbers in Genyris are stored as builtin objects of class <i>Bignum.</i> Internally they are implemented as Java BigDecimals. 
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-6.1.1">6.1.1</a> Maths Functions
</h3>
<div class="Unindented">
Genyris includes basic arithmetic operations on Bignum obects.
</div>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-19"></a><i>+</i><a class="IndexReference" name="entry-+-1" href="#index-+">↓</a>
</div>
<div class="Unindented">
This function computes the sum of its arguments, which may be many.
</div>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-20"></a><i>-<a class="IndexReference" name="entry---1" href="#index--">↓</a></i>
</div>
<div class="Unindented">
This function computes the accumulated difference of its arguments, which may be many. Example:
</div>
<pre class="LyX-Code">
(- 1 2 3) =&gt; -4
</pre>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-21"></a>*<a class="IndexReference" name="entry-*-1" href="#index-*">↓</a>
</div>
<div class="Unindented">
This function computes the product of its arguments, which must number two or more.
</div>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-22"></a>/<a class="IndexReference" name="entry-/-1" href="#index-/">↓</a>
</div>
<div class="Unindented">
This function computes the quotient of its arguments, which must number at two or more.
</div>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-23"></a>%
</div>
<div class="Unindented">
This function computes the remainder of its first argument divided by the second.
</div>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-24"></a>power<a class="IndexReference" name="entry-power-0" href="#index-power">↓</a>
</div>
<div class="Unindented">
This function calculates the first argument raised to the power of the second. Example:<i>(power 2 8) =&gt; 256</i>
</div>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-25"></a>scale<a class="IndexReference" name="entry-scale-0" href="#index-scale">↓</a> &lt;number&gt; &lt;scale&gt;
</div>
<div class="Unindented">
This function takes the number provided and returns a new <i>Bignum</i> with the number of digits after the decimal place specified by <i>&lt;scale&gt;</i>. Rounding is done with ’HALF UP’ semantices. i.e. 5 is rounded up. Examples
</div>
<pre class="LyX-Code">
scale (/ 1 3) 3 -&gt; 0.333
scale 1.55555 2 -&gt; 1.56
scale 1.5 0 -&gt; 2
</pre>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-6.2">6.2</a> Lists and Pairs<a class="Label" name="sub:Lists-and-Pairs"> </a>
</h2>
<div class="Unindented">
Like its forbears Lisp and Scheme, Genyris is a list-processing<a class="IndexReference" name="entry-list-processing-0" href="#index-list-processing">↓</a> language - its source code is expressed as lists and it has inbuilt functions for parsing and manipulating list data. Since programs and data are stored in the same form, Genyris is an ideal platform for developing DSLs or even new programming languages. Happily, manipulating lists is easy. Lists are a kind of binary tree. Trees are constructed with the<i> cons<a class="IndexReference" name="entry-cons-1" href="#index-cons">↓</a></i> function which accepts two arguments for the left and right halves of the<i> Pair</i>:
</div>
<pre class="LyX-Code">
&gt; cons ’A’ ’B’

(’A’ = ’B’) # Pair
</pre>
<div class="Unindented">
The interpreter prints an equal sign between the left and right halves of the Pair. The individual elements of a Pair can be accessed with the<i> left<a class="IndexReference" name="entry-left-1" href="#index-left">↓</a></i> and<i> right<a class="IndexReference" name="entry-right-1" href="#index-right">↓</a></i> functions:
</div>
<pre class="LyX-Code">
&gt; left (cons ’A’ ’B’)

’A’ # String
</pre>
<div class="Unindented">
Alternatively the dynamic variables<i> .left<a class="IndexReference" name="entry-.left-0" href="#index-.left">↓</a></i> and<i> .right<a class="IndexReference" name="entry-.right-0" href="#index-.right">↓</a></i> can be used when the list is called:
</div>
<pre class="LyX-Code">
&gt; var my-pair (cons ’A’ ’B’)
my-pair .right

’B’ # String
&gt; my-pair
   setq .left 33
   .self

33 = ’B’ # Pair
</pre>
<div class="Unindented">
To construct a proper List, the final right hand element will be<i> nil</i>:
</div>
<pre class="LyX-Code">
&gt; cons ’A’
    cons ’B’
       cons ’C’ nil

’A’ ’B’ ’C’ # Pair
</pre>
<div class="Unindented">
The printing of trees (by default) assumes that the tree is a kind of list, hence you don’t see the parentheses in this case. The interpreter identified the list as a<i> Pair</i>, since it only has a reference to the first<i> Pair</i>.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-6.2.1">6.2.1</a> Class Pair
</h3>
<div class="Unindented">
Builtin binary-tree objects (also known as cons cells) are of class Pair. The elements of the pair are the <i>.left</i> and <i>.right</i> halves of the object which are references to other expressions. The class Pair has direct subclasses <i>PairEquals</i> and <i>PairSource</i> described below.
</div>
<div class="Indented">
Refer also to section <a class="Reference" href="#sub:Pair">(9.8↓)</a>
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-6.2.2">6.2.2</a> Class PairEqual
</h3>
<div class="Unindented">
To help view<i> Pairs</i> explicitly, a list is constructed using <i>PairEquals</i> class, which forces the printer to display the full tree structure. The parser does this automatically, so <i>Pairs</i> which the user types with an equal sign are printed the same way. <i>PairEquals</i> are identical to <i>Pairs</i> in all other ways.
</div>
<div class="Indented">
For example:
</div>
<pre class="LyX-Code">
&gt; ^(’A’ = (’B’ = (’C’ )))

(’A’ = (’B’ = (’C’))) # PairEquals
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-6.2.3">6.2.3</a> Class PairSource
</h3>
<div class="Unindented">
The parsers will use <i>PairSource</i> objects to record the filename and line number of the lists parsed. <i>PairSource</i> is a subclass of <i>Pair</i>. 
</div>
<div class="Indented">
Example:
</div>
<pre class="LyX-Code">
&gt; var x ^(a b c d) 
: 
(a b c d) # PairSource
&gt; x.line-number 
: 
1 # Bignum 
&gt; x.filename
: 
’console’ # String 

</pre>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-6.3">6.3</a> String
</h2>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-6.3.1">6.3.1</a> <i>.match<a class="IndexReference" name="entry-.match-0" href="#index-.match">↓</a></i>
</h3>
<pre class="LyX-Code">
.match &lt;regex&gt;
</pre>
<div class="Unindented">
Returns <i>true</i> if the string is matched by the regular expression supplied, otherwise <i>nil</i> 
</div>
<div class="Indented">
Where <i>regex</i> is a Java regular expression defined here: <a class="URL" href="http://docs.oracle.com/javase/1.4.2/docs/api/java/util/regex/Pattern.html#sum">http://docs.oracle.com/javase/1.4.2/docs/api/java/util/regex/Pattern.html#sum</a>
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-6.3.2">6.3.2</a> <i>.regex<a class="IndexReference" name="entry-.match-1" href="#index-.match">↓</a></i>
</h3>
<pre class="LyX-Code">
.regex &lt;regex&gt;
</pre>
<div class="Unindented">
Matches within lines in <i>self</i> to the regular expression supplied. Returns <i>nil</i> if there is no match otherwise a list consisting of 
</div>
<pre class="LyX-Code">
(&lt;group 0, which always represents the entire expression&gt; 
</pre>
<ul>
<li class="nested">
<pre class="LyX-Code">
&lt;match group&gt; 
&lt;match group&gt; ...)
</pre>

</li>

</ul>
<div class="Unindented">
To match across line breaks, replace the line breaks with another char such as space.
</div>
<div class="Indented">
 <i>regex</i> is defined here: <a class="URL" href="http://docs.oracle.com/javase/1.4.2/docs/api/java/util/regex/Pattern.html#sum">http://docs.oracle.com/javase/1.4.2/docs/api/java/util/regex/Pattern.html#sum</a> Refer to the Java documents for discussion of groups. Example, slicing up an URL:
</div>
<pre class="LyX-Code">
&gt; ’http://www.genyris.org/path/index.html’(.regex ’([a-z]+)://([^/]+)(/.*)’)
: 
(’http://www.genyris.org/path/index.html’ ’http’ ’www.genyris.org’ ’/path/index.html’) # Pair 

</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-6.3.3">6.3.3</a> <i>.length<a class="IndexReference" name="entry-.length-0" href="#index-.length">↓</a></i>
</h3>
<div class="Unindented">
This method returns the number of characters in a string.
</div>
<pre class="LyX-Code">
&gt; "wqweqweq"(.length)

8 # Bignum 
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-6.3.4">6.3.4</a> <i>.split<a class="IndexReference" name="entry-.split-0" href="#index-.split">↓</a> &lt;delimiter string&gt;</i>
</h3>
<div class="Unindented">
The <i>.split</i> method takes a string and splits it into substrings using the <i>&lt;delimiter string&gt;</i> as the bourndary for splitting. The result is a list of strings: For example:
</div>
<pre class="LyX-Code">
&gt; "wqweqweq"(.split "qw")
: 
(’w’ ’e’ ’eq’) # Pair 
</pre>
<div class="Unindented">
If the <i>&lt;delimiter string&gt;</i> is the empty string, it returns a list of strings one character in each:
</div>
<pre class="LyX-Code">
&gt; "wqweqweq"(.split ’’)
: 
(’w’ ’q’ ’w’ ’e’ ’q’ ’w’ ’e’ ’q’) # Pair 
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-6.3.5">6.3.5</a> <i>.join<a class="IndexReference" name="entry-join-0" href="#index-join">↓</a> &lt;list&gt;</i>
</h3>
<div class="Unindented">
The <i>.join</i> method takes a list of objects as a parameter and returns a string consisting of the list items with the string as a spacer. For example:
</div>
<pre class="LyX-Code">
&gt; "."(.join ^(1 1 1970))
: 
’1.1.1970’ # String 
</pre>
<div class="Unindented">
Joining with an empty string concatenetes the arguments. Example:
</div>
<pre class="LyX-Code">
&gt; ’’(.join ^(Once upon a time))
: 
’Onceuponatime’ # String 
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-6.3.6">6.3.6</a> <i>.replace<a class="IndexReference" name="entry-.replace-0" href="#index-.replace">↓</a></i> &lt;searchstring&gt; &lt;replacement&gt;
</h3>
<div class="Unindented">
Returns a new string with every occurence of<i> &lt;searchstring&gt;</i> replaced with<i> &lt;replacement&gt;. </i>Example:
</div>
<pre class="LyX-Code">
&gt; "wqweqweq"(.replace ’qw’ ’-’)
: 
’w-e-eq’ # String
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-6.3.7">6.3.7</a> <i>.+<a class="IndexReference" name="entry-.+-0" href="#index-.+">↓</a> &lt;string&gt;...</i>
</h3>
<div class="Unindented">
The plus method appends the strings provided as arguments. 
</div>
<pre class="LyX-Code">
&gt; "A"
:   .+ "B" "C"
: 
’ABC’ # String 

</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-6.3.8">6.3.8</a> <i>.toBase64<a class="IndexReference" name="entry-.toBase64-0" href="#index-.toBase64">↓</a></i>
</h3>
<div class="Unindented">
Returns the string converted into a Base64<a class="IndexReference" name="entry-Base64-0" href="#index-Base64">↓</a> encoded string. The returned string is tagged with the class string<i>Base64EncodedString</i><a class="IndexReference" name="entry-Base64EncodedString-0" href="#index-Base64EncodedString">↓</a>. For example:
</div>
<pre class="LyX-Code">
&gt; ’foo:bar’(.toBase64)
’Zm9vOmJhcg==’ # Base64EncodedString String
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-6.3.9">6.3.9</a> <i>.fromBase64<a class="IndexReference" name="entry-.fromBase64-0" href="#index-.fromBase64">↓</a></i>
</h3>
<div class="Unindented">
Decodes a Base 64 encoded string into the binary original. This is also available in the<i>Base64EncodedString</i> classas the<i>.decode</i> method. Example:
</div>
<pre class="LyX-Code">
&gt; ’Zm9vOmJhcg==’(.fromBase64)
’foo:bar’ # String
</pre>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-6.4">6.4</a> Dictionaries
</h2>
<div class="Unindented">
Genyris provides &ldquo;dictionary<a class="IndexReference" name="entry-dictionary-0" href="#index-dictionary">↓</a>&rdquo; objects which are associative arrays found in some programming languages. Each dictionary provides a un-ordered set of dynamic symbols and bindings - called &ldquo;properties<a class="IndexReference" name="entry-properties-0" href="#index-properties">↓</a>&rdquo;. A dictionary is created with the<i> dict<a class="IndexReference" name="entry-dict-0" href="#index-dict">↓</a></i> function call, e.g.:
</div>
<pre class="LyX-Code">
define pitt
<b>   dict</b>
<b>      .name  = ’Willam Pitt<a class="IndexReference" name="entry--1" href="#index-">↓</a>’</b>
<b>      .title = ’Prime Minister’</b>
<b>      .date-of-birth   = ’28 May 1759’</b>
</pre>
<div class="Unindented">
Here we have created a<i> dictionary</i> with three properties. The<i> dict</i> function takes a variable number of property definitions in Pairs, more formally:
</div>
<pre class="LyX-Code">
  dict
     &lt;dynamic symbol1&gt; = &lt;initial value1&gt;
     &lt;dynamic symbol2&gt; = &lt;initial value2&gt;
     etc...
</pre>
<div class="Unindented">
If there are no initial values given , the symbol<i> nil</i> is used as the value, as in this example:
</div>
<pre class="LyX-Code">
&gt;<b> dict</b>
<b>   .foo</b>
<b>   .bar</b>

dict
      .bar = nil
      .foo = nil # Dictionary
</pre>
<div class="Unindented">
Having properties is all very well, but we need a way to access them. As we have seen all objects are callable - including dictionaries. So to access the above<i> dict</i> object we call it and use the dynamic variables as follows:
</div>
<pre class="LyX-Code">
&gt; pitt .name

~ ’Willam Pitt’ # String
</pre>
<div class="Unindented">
Here the<i> .name</i> dynamic variable is bound to the<i> .name</i> property in the dict. To set the property value we use the<i> setq</i> function:
</div>
<pre class="LyX-Code">
pitt
<b>setq<a class="IndexReference" name="entry--2" href="#index-">↓</a></b>.name ’William Pitt The Younger’

</pre>
<div class="Unindented">
New properties can be created with<i> define<a class="IndexReference" name="entry-define-3" href="#index-define">↓</a></i> since the object acts as an environment in its own right. e.g.:
</div>
<pre class="LyX-Code">
pitt
<b>   define</b> .father ’William Pitt the Elder’
</pre>
<div class="Unindented">
Dictionaries also have a &ldquo;magic&rdquo; variable<i> .vars<a class="IndexReference" name="entry-.vars-0" href="#index-.vars">↓</a></i> which lists all the variables defined in the dictionary. This is handy for debugging. For example:
</div>
<pre class="LyX-Code">
&gt; pitt<b>.vars</b>

.date-of-birth .father .name .title .vars # Pair
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-6.4.1">6.4.1</a> Adding Behaviour to Dictionaries
</h3>
<div class="Unindented">
Since functions in Genyris are bound to variables, and dictionaries have variables, behaviour can be added to dictionaries. It suffices to define a function with a dynamic name in the scope of a dictionary:
</div>
<pre class="LyX-Code">
define jeb
<b>   dict</b>
<b>      .firstName = ’Joe’</b>
<b>      .middleName = ’E.’</b>
<b>      .lastName = ’Brown’</b>

jeb
<b>   def .displayName()</b>
<b>       list .firstName .middleName .lastName</b>
</pre>
<div class="Unindented">
Once defined, the function is callable in the context of the<i> jeb</i> dict:
</div>
<pre class="LyX-Code">
&gt; jeb<b>(.displayName)</b>

’Joe’ ’E.’ ’Brown’ # Pair
</pre>
<div class="Unindented">
A dict can be used a mechanism for organisation. Consider the following fictional example - a set of functions organised in a dictionary called<i> file</i>:
</div>
<pre class="LyX-Code">
## File Handling code
define file
  dict
    .name  = ’File Handling Functions’
    .version = ’1.2’
file
   def .copy(from to) etc
   def .delete(filename) etc
   def .zip(file) etc

## Use of the file module
def archive(filename)
    file!copy filename ’/tmp/foo’
    file!zip ’/tmp/foo’
    file!delete filename

</pre>
<div class="Unindented">
Here we define three functions bound to a single dict object. The functions can only be called by referencing the<i> file</i> object.
</div>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-6.5">6.5</a> Classes
</h2>
<div class="Unindented">
All Genyris objects, be they atomic (like numbers) or composite (like dictionaries) can belong to one or more classes. As such Genyris can be used as an &ldquo;Object-Oriented<a class="IndexReference" name="entry-Object-Oriented-0" href="#index-Object-Oriented">↓</a>&rdquo; language. The interpreter looks at the classes for functions to execute if the function name is dynamic (starts with a .). This way you can add behaviour to many objects in a single place. Classes are dictionaries with special variables which hold the relationships between classes. The standard classes all have the following variables:
</div>
<div class="Description">
<span class="Description-entry"><i>.classes</i><a class="IndexReference" name="entry-.classes-1" href="#index-.classes">↓</a></span> The list of meta-classes to which the class belongs.
</div>
<div class="Description">
<span class="Description-entry"><i>.vars</i><a class="IndexReference" name="entry-.vars-1" href="#index-.vars">↓</a></span> List of property names.
</div>
<div class="Description">
<span class="Description-entry"><i>.classname</i><a class="IndexReference" name="entry-.classname-0" href="#index-.classname">↓</a></span> The String name of the class.
</div>
<div class="Description">
<span class="Description-entry"><i>.superclasses</i><a class="IndexReference" name="entry-.superclasses-0" href="#index-.superclasses">↓</a></span> The list of classes from which the class inherits.
</div>
<div class="Description">
<span class="Description-entry"><i>.subclasses</i><a class="IndexReference" name="entry-.subclasses-0" href="#index-.subclasses">↓</a></span> The list of classes which inherit from this class.
</div>
<div class="Unindented">
Genyris has a number of built-in classes beginning with<i> Thing<a class="IndexReference" name="entry-Thing-0" href="#index-Thing">↓</a></i>, root of the class hierarchy. 
</div>
<div class="Indented">
To add behaviour to a class, we need to add a dynamic variable bound to a closure object - in other words we need to define a method<a class="IndexReference" name="entry-method-0" href="#index-method">↓</a>. For example a method to compute the square of a number is added to the<i> Bignum</i><a class="IndexReference" name="entry-Bignum-0" href="#index-Bignum">↓</a> class thus:
</div>
<pre class="LyX-Code">
Bignum
   def .square() (*<b>.self .self</b>)
</pre>
<div class="Unindented">
Notice that the method uses the<i> .self</i><a class="IndexReference" name="entry-.self-1" href="#index-.self">↓</a> variable which will be automatically bound to an object. Now all Bignums can compute their own square e.g.:
</div>
<pre class="LyX-Code">
&gt; 4234389 (.square)

~ 17930050203321 # Bignum
</pre>
<div class="Unindented">
We need to call methods in the correct way to ensure they refer to the right object since they are dynamic, not lexical variables. So if we tried to say:
</div>
<pre class="LyX-Code">
&gt; (4234389.square)
</pre>
<div class="Unindented">
We would get an error. There is a big difference between<i> 4234389 (.square)</i> and<i> (4234389.square)</i>. In the first case we are creating an environment around the <i>Bignum 4234389</i>, then we execute the function bound to the dynamic variable<i> .square</i> from <i>Bignum</i>. In the second however, we are getting the <i>Bignum</i>’s<i> .square</i> function but then applying it in the context of the caller. This is most likely not what was intended. In general, methods should almost always be called in the first way as in:
</div>
<pre class="LyX-Code">
&lt;object&gt; (&lt;method&gt; &lt;arg1&gt; &lt;arg2&gt; ... &lt;argn&gt;)
</pre>
<div class="Unindented">
Or if there are multiple method calls to be made:
</div>
<pre class="LyX-Code">
&lt;object&gt;
     &lt;method&gt; &lt;arg1&gt; &lt;arg2&gt; ... &lt;argn&gt;
     &lt;method&gt; &lt;arg1&gt; &lt;arg2&gt; ... &lt;argn&gt;
     etc...
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-6.5.1">6.5.1</a> Defining Your Own Classes
</h3>
<div class="Unindented">
Classes are relatively complex objects so the language provides a built-in macro for creating new classes and binding them. The syntax is straight forward - let’s define a class for length units:
</div>
<pre class="LyX-Code">
&gt;<b>class<a class="IndexReference" name="entry--3" href="#index-">↓</a></b> Inches()

&lt;class Inches (Thing)&gt; # StandardClass Dictionary
</pre>
<div class="Unindented">
This simply creates a class which is a subclass of<i> Thing</i>. By convention class names begin with an upper-case character. We can use this class to annotate existing objects. For example:
</div>
<pre class="LyX-Code">
&gt;<b>tag</b> Inches 12

~ 12 # Inches Bignum
</pre>
<div class="Unindented">
The<i> tag<a class="IndexReference" name="entry-tag-0" href="#index-tag">↓</a></i> function adds a class to an object’s list of classes and returns it. Notice the interpreter prints out the list of classes 12 belongs to, now including<i> Inches</i>.
</div>
<div class="Indented">
So far so good, now let’s add a method to convert to meters. Lets assume an<i> Inches</i> object is a kind of<i> Bignum</i>, and add a method to it:
</div>
<pre class="LyX-Code">
class Inches(<b>Bignum</b>)
   def .toMeters()
      * .self 0.0254
</pre>
<div class="Unindented">
The second parameter to<i> class</i> a list of superclasses, in this example, just<i> Bignum</i>. We can now define a foot and convert it as follows:
</div>
<pre class="LyX-Code">
define a-foot
   tag Inches 12

&gt; a-foot (<b>.toMeters</b>)

~ 0.3048 # Bignum
</pre>
<div class="Unindented">
This is fine, but we are still returning a<i> Bignum</i>. Let’s refactor to add a<i> Meters</i> class and tag the return appropriately:
</div>
<pre class="LyX-Code">
<b>class Length()</b>
<b>   def .toMeters()</b>
<b>      raise ’Oops - you invoked an abstract class!’</b>

class Inches(<b>Length</b>)
   def .toMeters()
      tag Meters (* .self 0.0254)

<b>class Meters(Length)</b>
<b>   def .toMeters() .self</b>
</pre>
<div class="Unindented">
Here we have defined an abstract base class and two derived classes which both have the .<i>toMeters</i> method. The<i> raise</i> function catches invalid use of the<i> Length</i> class. Lets try the conversion again:
</div>
<pre class="LyX-Code">
&gt;<b>(tag Inches 12)</b> (.toMeters)

~ 0.3048 #<b>Meters</b> Bignum
</pre>
<div class="Unindented">
Here we are using a sub-expression which returns<i> 12 Inches</i> and this object is the focus of the call to<i> .toMeters</i>. Note the result is now in<i> Meters</i>. With this new class structure in place we can now add a method to add two lengths in any units:
</div>
<pre class="LyX-Code">
Length
<b>   def .add(other)</b>
<b>      tag Meters</b>
<b>         + (.toMeters)</b>
<b>            other (.toMeters)</b>
</pre>
<div class="Unindented">
This method converts both the current object and the argument to<i> Meters,</i> performs the addition and returns the result in<i> Meters</i>. Here’s how it runs:
</div>
<pre class="LyX-Code">
define a-meter
   tag Meters 1
define a-foot (tag Inches 12)
&gt; a-foot (.add a-meter)

~ 1.3048 #<b>Meters</b> Bignum
</pre>
<div class="Unindented">
This is useful however in the above example a user of our classes could get errors by tagging objects which cannot be added together. For example a string will fail:
</div>
<pre class="LyX-Code">
(tag<b>Inches ’12’</b>) (.add (tag Meters 1))          # Error
</pre>
<div class="Unindented">
To provide protection and we can use type checking features and class validators.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-6.5.2">6.5.2</a> Type-Checked Function Arguments
</h3>
<div class="Unindented">
Genyris supports type annotations<a class="IndexReference" name="entry-type-annotations-0" href="#index-type-annotations">↓</a> found in most statically typed languages. These type checks are purely optional. When a function is defined, the arguments and return value may be annotated with a class. The actual arguments are checked with a validator (if present). Here’s an example of a sensitive function protected by type checks:
</div>
<pre class="LyX-Code">
def safe-call ((a =<a class="IndexReference" name="entry-=-2" href="#index-=">↓</a> Bignum) (b = Bignum) = Bignum)
    fragile-function a b
</pre>
<div class="Unindented">
This function only allows Bignums to be passed in or returned. The last element of the arguments list specifies the return type. If a type check fails an exception is raised.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-6.5.3">6.5.3</a> In-Line Type Checks
</h3>
<div class="Unindented">
Genyris provides another mechanism for checking type constraints. The<i> is?<a class="IndexReference" name="entry-is?-0" href="#index-is?">↓</a></i> function will check if the result of the expression is<i> .valid</i>?<i><a class="IndexReference" name="entry-.valid?-1" href="#index-.valid?">↓</a></i>, or if it is an instance of the class. For example this function will always raise an error because<i> 3</i> is not a subclass of<i> String</i>:
</div>
<pre class="LyX-Code">
def fails()
    define x 3
    is? x String
</pre>
<div class="Unindented">
If a class validator is provided, this will be used otherwise a simple &ldquo;nominative&rdquo; type check of class membership based on the object’s tagged classes is used. The<i> .valid?</i> method is a stronger check, however nominative checking is sometimes preferred<span class="FootOuter"><span class="SupFootMarker"> [F] </span><span class="HoverFoot"><span class="SupFootMarker"> [F] </span>Genyris supports both&ldquo;nominative&rdquo; and&ldquo;structural&rdquo; subtyping</span></span>.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-6.5.4">6.5.4</a> Inheritance and Class Properties
</h3>
<div class="Unindented">
The inheritance<a class="IndexReference" name="entry-inheritance-0" href="#index-inheritance">↓</a> mechanism in Genyris works by searching on object’s classes list for classes which have the dynamic symbol required, it also recursively searches the superclasses of all the classes it finds in the classes list. The classes are ordered with those classes deepest in the hierarchy first.<span class="FootOuter"><span class="SupFootMarker"> [G] </span><span class="HoverFoot"><span class="SupFootMarker"> [G] </span>This order is listed when the classes are printed by the interpreter.</span></span>
</div>
<div class="Indented">
Inheritance of properties is the same regardless of the type of property (function or data). Hence an object can access information stored in its classes and superclasses. Here’s an example where a base class supplies a boolean value to an object:
</div>
<pre class="LyX-Code">
class Orange()
   define .pips ^true

&gt; (tag Orange ’my lunch’).pips

~ true # Symbol
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-6.5.5">6.5.5</a> Class Validators
</h3>
<div class="Unindented">
To help define membership of a class, the class can provide a<i> .valid?<a class="IndexReference" name="entry-.valid?-2" href="#index-.valid?">↓</a></i> predicate method. This can assess an object and return<i> true</i> if it is a valid member of the class. The<i> tag</i> function calls<i> .valid?</i> if provided and fails when<i> .valid?</i> returns<i> nil</i>. We can add a validator to our example base class:
</div>
<pre class="LyX-Code">
Length
<b>   def .valid?(obj)</b>
<b>      is-instance? obj Bignum</b>
</pre>
<div class="Unindented">
The<i> is-instance?<a class="IndexReference" name="entry-is-instance?-0" href="#index-is-instance?">↓</a></i> function only returns true if the object is an instance of<i> Bignum</i> or its subclasses. This prevents anything except numbers being tagged.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-6.5.6">6.5.6</a> Traditional Constructors and Factories
</h3>
<div class="Unindented">
While the philosophy of Genyris is to classify objects after construction, it does not inhibit using traditional constructors<a class="IndexReference" name="entry-constructors-0" href="#index-constructors">↓</a> in classes. ’Factory’ functions for object construction are preferred even in traditional languages. Factory functions are simply functions which construct the appropriate kind of object based on the inputs given. A factory/constructor can be as simple as this:
</div>
<pre class="LyX-Code">
class Person ()
   def .new (name date-of-birth)
      dict
         .name = name
         .dob = date-of-birth
         .classes = (list Person)

Person!new ’Jo’ 23
</pre>
<div class="Unindented">
A more general approach is to provide a &ldquo;<i>new</i><a class="IndexReference" name="entry-new-0" href="#index-new">↓</a>&rdquo; function which calls a class-specific &ldquo;<i>init</i>&rdquo; function. For example here is a class with an<i> .init<a class="IndexReference" name="entry-.init-0" href="#index-.init">↓</a></i> member which creates properties in a dict created by<i> .new<a class="IndexReference" name="entry-.new-0" href="#index-.new">↓</a></i>:
</div>
<pre class="LyX-Code">
class PersonTraditional (Object)
   def .init((name = String) (age = Bignum))
      define .name name
      define .age age
</pre>
<div class="Unindented">
<i>Object<a class="IndexReference" name="entry-Object-0" href="#index-Object">↓</a></i>s are created by calling<i> .new</i>:
</div>
<pre class="LyX-Code">
&gt; PersonTraditional (.new ’Abe’ 99)
dict
      .age = 99
      .name = ’Abe’ # PersonTraditional Dictionary
</pre>
<div class="Unindented">
Here is a simple implementation of<i> .new</i> in a base class:
</div>
<pre class="LyX-Code">
class Object (Dictionary)

  def .new(&amp;rest args)
      (tag .self (dict))
         apply .init args
         .self

   # NOOP .init method
   def .init(&amp;rest args)
      .self
</pre>
<div class="Unindented">
This<i> .new</i> collects all the input arguments via the<i> &amp;rest</i> keyword, it creates an empty<i> dict</i>, tags it with the derived class and passes the collected arguments to the class’s<i> .init</i> function. The default<i> .init</i> function returns the new object un-modified.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-6.5.7">6.5.7</a> Functions on classes
</h3>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-26"></a><i>class<a class="IndexReference" name="entry-class-0" href="#index-class">↓</a> &lt;name&gt; (&lt;superclasses&gt;...) &lt;body&gt;</i>
</div>
<div class="Unindented">
The class form declares class objects and creates a dynamic environment based on the new class object in which the body of the form is executed and returns the class object. For example:
</div>
<pre class="LyX-Code">
class Inches(Length)
   def .toMeters()
      tag Meters (* .self 0.0254)
</pre>
<div class="Unindented">
When this form is evaluated the following happends:
</div>
<ul>
<li>
A <i>StandardClass</i> object is created with the name <i>’Inches’</i> and superclasses of <i>Length</i>
</li>
<li>
A dynamic environment is created based on the new object
</li>
<li>
The def... form is evaluated in the new environment
</li>
<li>
The new class is bound to the variable &lt;name&gt;
</li>
<li>
The <i>StandardClass</i> object is returned
</li>

</ul>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-27"></a><i>tag<a class="IndexReference" name="entry-tag-1" href="#index-tag">↓</a> &lt;class&gt; &lt;expression&gt;</i>
</div>
<div class="Unindented">
The <i>tag</i> function adds a new class to the list of classes of the object resulting from evaluating the <i>expression</i>. The function returns the newly tagged object. For example:
</div>
<pre class="LyX-Code">
&gt; tag Inches 12
: 
12 # Inches Bignum 

</pre>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-28"></a><i>remove-tag<a class="IndexReference" name="entry-remove-tag-0" href="#index-remove-tag">↓</a></i> &lt;class&gt; &lt;object&gt;
</div>
<div class="Unindented">
The <i>remove-tag</i> function removes a class from the classes list of the object and returns it.
</div>
<pre class="LyX-Code">
&gt; var x (tag Inches 12)
: 
12 # Inches Bignum

&gt; remove-tag Inches x
: 
12 # Bignum 

</pre>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-29"></a><i>is-instance?<a class="IndexReference" name="entry-is-instance?-1" href="#index-is-instance?">↓</a> &lt;expression&gt; &lt;class&gt;</i>
</div>
<div class="Unindented">
The <i>is-instance?</i> function returns true if the object resulting from evaluation of the <i>&lt;expression&gt;</i> is a member of the <i>&lt;class&gt;</i> or its superclasses. Membership is determind by the classes tagged to the object. 
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-6.5.8">6.5.8</a> Automating Classification
</h3>
<div class="Unindented">
This language embodies the opinion that objects are created first, then they are classified - rather than the classification<a class="IndexReference" name="entry-classification-0" href="#index-classification">↓</a> being determined during object construction. Let’s explore how the<i> .valid?<a class="IndexReference" name="entry-.valid?-3" href="#index-.valid?">↓</a></i> predicates can be used to automate classification.
</div>
<div class="Indented">
Validator functions can be developed to any complexity required. For example validators can inspect the <u>values</u> of properties and objects rather than just their type. Here’s an example which is<i> true</i> for even numbers:
</div>
<pre class="LyX-Code">
class EvenNumber()
   def .valid?(x)
      equal? (% x 2) 0
</pre>
<div class="Unindented">
Validators provide a way to automatically categorize unknown objects - an important tool for input validation.
</div>
<div class="Indented">
The Genyris distribution includes file "<i>examples/classify.g</i>" which shows this pattern. It defines a simple<i> classify<a class="IndexReference" name="entry-classify-0" href="#index-classify">↓</a></i> function which recursively walks the class hierarchy testing an object’s compliance with validators. There is an example of classification of people into classes based on age and possessions. We load the source files<span class="FootOuter"><span class="SupFootMarker"> [H] </span><span class="HoverFoot"><span class="SupFootMarker"> [H] </span>The<i> load</i> function reads an executes the source file from the Java classpath. Genyris initialization code source files are stored within the Java&ldquo;jar&rdquo; file.</span></span>:
</div>
<pre class="LyX-Code">
include ’examples/people.g’
@prefix foaf ’http://xmlns.com/foaf/0.1/’
</pre>
<div class="Unindented">
This creates an un-classified object, assigns it to a variable<i> vyvyan</i>, and calls<i> classify</i>:
</div>
<pre class="LyX-Code">
define vyvyan
  dict
     .foaf:name = ’Vyvyan’
     .foaf:age = 49

classify foaf:Person vyvyan
</pre>
<div class="Unindented">
We now display the object
</div>
<pre class="LyX-Code">
&gt; vyvyan

(dict (.|http://xmlns.com/foaf/0.1/age| = 49)
      (.|http://xmlns.com/foaf/0.1/name| = "Vyvyan"))
# Boomer Dictionary 

</pre>
<div class="Unindented">
The result shows the classifier has recognised<i> vyvyan</i> as a<i> Boomer<a class="IndexReference" name="entry-Boomer-0" href="#index-Boomer">↓</a></i>. Here are the classes that make this happen:
</div>
<pre class="LyX-Code">
class foaf:Person ()
   def .valid? (obj)
      obj
         bound? .foaf:age

class Boomer (foaf:Person)
   def .valid? (obj)
      obj
         between 45 .foaf:age 60
</pre>
<div class="Unindented">
To be a valid<i> Person</i> <i>vyvyan</i> must have an the<i> .foaf:age</i> property, and to be a<i> Boomer</i> its <i>foaf:age</i> must be between 45 and 60. The<i> classify</i> function only calls the derived class’s validator if object is in the base class. It tagged<i> vyvyan</i> with the<i> Boomer</i> class.
</div>
<div class="Indented">
This technique can be used to categorise a program’s inputs or validate output data, and even re-validate previously classified objects.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-6.5.9">6.5.9</a> Duck Typing
</h3>
<div class="Unindented">
’Duck’ typing in a language is jargon for ’structural’ subtyping -<i> If it looks like a duck and quacks like a duck - then it is a duck</i>. Duck typing<a class="IndexReference" name="entry-Duck-typing-0" href="#index-Duck-typing">↓</a> relies on programmers to ensure that objects passed around actually do have the properties and methods expected by the downstream code. If there is a mis-match then eventually an error will result. For example if we could define a<i> .copy</i> function which expects some kind of stream object with<i> .next</i> and<i> .last?</i> methods. There is no need to perform type-checking in the interface since if the methods exits all will be well. Duck typing is adequate for many programming tasks, however developers like to formalize the interfaces with type declarations.
</div>
<div class="Indented">
In Genyris an Interface could be defined by either providing an appropriate validator or by simply tagging objects with their supported interface classes. For example here is a class validator for the above scenario:
</div>
<pre class="LyX-Code">
class Stream-Interface()
   def .valid?(object)
      object
         and
            bound? .next
            is-instance? .next Closure
            bound? .last
            is-instance? .last Closure
</pre>
<div class="Unindented">
The validator here checks whether the object has<i> .next</i> and<i> .last</i> properties, and whether they are procedure objects.
</div>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-6.6">6.6</a> Triples
</h2>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-6.6.1">6.6.1</a> Introduction
</h3>
<div class="Unindented">
RDF<a class="IndexReference" name="entry-RDF-0" href="#index-RDF">↓</a><span class="FootOuter"><span class="SupFootMarker"> [I] </span><span class="HoverFoot"><span class="SupFootMarker"> [I] </span>Resouce Description Framework</span></span> concepts such as triples<a class="IndexReference" name="entry-triple-0" href="#index-triple">↓</a> and graphs<a class="IndexReference" name="entry-graph-0" href="#index-graph">↓</a> are available in Genyris as part of the language. Although these were made popular by the Semantic Web these Description Logic ideas can be used in general programming. The Genyris implementation removes some of the constraints of RDF and allows these ideas to applied at the program object level. The goal is for all developers to be beneficiaries of these elegent data structures and algorithms, not just those concerned with Semantic Web problems.
</div>
<div class="Indented">
Triples and graphs which are derived from Description Logic also form the foundation for a future Genyris<i> type system</i>. The type system will allow data, classes and functions to be ’marked-up’ with meta-data describing their allowed properties and behaviours.
</div>
<div class="Indented">
Description Logic techniques allow great flexibilty and power in the addition of meta-data and inference. We hope in time Genyris developers will have access to higher-order tools which are available for RDF and OWL within the context of their Genyris application programming.
</div>
<div class="Indented">
Genyris includes triples as a first-class system object. Triples are described in the W3C RDF Primer document<span class="FootOuter"><span class="SupFootMarker"> [J] </span><span class="HoverFoot"><span class="SupFootMarker"> [J] </span>http://www.w3.org/TR/rdf-primer/</span></span>. A triple<a class="IndexReference" name="entry-triple-1" href="#index-triple">↓</a> consists of three atoms, a<i> Subject<a class="IndexReference" name="entry-Subject-0" href="#index-Subject">↓</a></i>,<i> Predicate<a class="IndexReference" name="entry-Predicate-0" href="#index-Predicate">↓</a></i> and<i> Object<a class="IndexReference" name="entry-Object-1" href="#index-Object">↓</a></i>. Each triple is a simple descriptive statement about the relationships between objects or their properties. For example the triple:
</div>
<pre class="LyX-Code">
UnixBox1 hasUser root
</pre>
<div class="Unindented">
Says that the machine UnixBox1 has a user account ’root’.
</div>
<div class="Indented">
In Genyris the<i> Subject</i> of a triple may be any language object, including atoms and ’literals’ in RDF terms. This allows statements to be made about any object in the system. Another way of viewing this is that any object in the system may have arbitrary properties, stored in triples.
</div>
<div class="Indented">
The<i> Predicate</i> of a triple however, must be a symbol. This ensures that the statement is at least, readable.
</div>
<div class="Indented">
Any language item may be the<i> Object</i> of a triple. This allows relationships between any two language items to be recorded.
</div>
<div class="Indented">
Triples alone are not particularly useful without a way of comparing them and managing them.<i> Graphs<a class="IndexReference" name="entry-graph-1" href="#index-graph">↓</a></i> are in-memory sets of triples with functions for searching for, adding and removing triples. Because Genyris triples may have any object as their subjects, Graphs are used where other languages may rely on hash-tables. Graphs in their turn can be used as sets, with comparison, intersection and union functions.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-6.6.2">6.6.2</a> Creating triples with<i> triple</i><a class="IndexReference" name="entry-triple-2" href="#index-triple">↓</a>
</h3>
<div class="Unindented">
Triple objects are created by the<i> triple</i> function which takes three arguments, the<i> subject, predicate</i> and<i> object.</i>The<i> predicate</i> must be a Symbol.<i> </i>Example<i>s</i>:
</div>
<pre class="LyX-Code">
&gt; triple ^Lewis ^hasMother ^Mae
(triple Lewis hasMother Mae) # Triple
&gt; triple 23 ^hasUnits ^Inches
(triple 23 hasUnits Inches) # Triple
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-6.6.3">6.6.3</a> Accessing parts of a triple with<i> .subject</i><a class="IndexReference" name="entry-.subject-0" href="#index-.subject">↓</a>,<i> .predicate</i><a class="IndexReference" name="entry-.predicate-0" href="#index-.predicate">↓</a> and<i> .object<a class="IndexReference" name="entry-.object-0" href="#index-.object">↓</a></i>
</h3>
<div class="Unindented">
The components of the triples can be accessed with the above dynamic symbols. For example:
</div>
<pre class="LyX-Code">
&gt; var l
   triple ^Lewis ^hasMother ^Mae
(triple Lewis hasMother Mae) # Triple

&gt; list l!object l!subject l!predicate
(Mae Lewis hasMother) # Pair
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-6.6.4">6.6.4</a> Triple Equality
</h3>
<div class="Unindented">
Two triples are considered<i> equal?<a class="IndexReference" name="entry-equal?-1" href="#index-equal?">↓</a></i> if the subjects and predicates are<i> eq?</i>and the objects are<i> equal?.</i>The<i> equal?</i> test for the<i> object</i> means that strings, integers and lists which look the same will be treated as equal. Refer also to the definitions of<i> eq?</i> and<i> equal?</i>. This style is designed to allow simple literals to be used as objects such as<i> 12.3</i> and<i> &ldquo;Joe&rdquo;</i>. If networks of triples are required in an application, then the objects are also subjects. In this case Dictionaries or Symbols are recommended since their equality is specific.
</div>
<div class="Indented">
For example:
</div>
<pre class="LyX-Code">
&gt; equal? (triple ^S ^P 12.3) (triple ^S ^P 12.3)
true # SimpleSymbol

&gt; equal? (triple 123 ^p "yes") (triple 123 ^p "yes")
nil # SimpleSymbol
</pre>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-6.7">6.7</a> Graphs
</h2>
<div class="Unindented">
Genyris provides a special container class for triples, the ’graph<a class="IndexReference" name="entry-graph-2" href="#index-graph">↓</a>’. Graphs are really just a set of triples, since all triples within the store are unequal. Graphs are not persisted (saved on disk) they are in-memory objects. Graphs are used as lookup tables (instead of a hashtable) and they are used for more complex comparisons between sets of triples. The speed of the current implementation is inversely proportional to the number of triples in the store.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-6.7.1">6.7.1</a> Creating Graphs with<i> graph</i>
</h3>
<div class="Unindented">
The<i> graph<a class="IndexReference" name="entry-graph-3" href="#index-graph">↓</a></i> function constructs a graph object. It accepts an optional list of 3-lists which are converted to triples. Example:
</div>
<pre class="LyX-Code">
&gt; graph
   ^(joe age three)
   ^(joe age ten)

(graph) # Graph
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-6.7.2">6.7.2</a> Graph equality
</h3>
<div class="Unindented">
Two graphs are<i> equal?</i> if their constituent triples have an equal triple in the other graph and vice versa.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-6.7.3">6.7.3</a> Adding Triples with<i> .add<a class="IndexReference" name="entry-.add-0" href="#index-.add">↓</a></i>
</h3>
<div class="Unindented">
The<i> .add</i> method adds a triple to a graph. If the triple is already present no error is thrown. The graph object is returned. Syntax is:
</div>
<pre class="LyX-Code">
.add &lt;triple&gt;
</pre>
<div class="Unindented">
Example:
</div>
<pre class="LyX-Code">
ts(.add (triple ^s ^p ^o))
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-6.7.4">6.7.4</a> Removing Triples with<i> .remove<a class="IndexReference" name="entry-.remove-0" href="#index-.remove">↓</a></i>
</h3>
<div class="Unindented">
The<i> .remove</i> method removes a single triple from a graph. If the triple is already absent no error is thrown. The graph object is returned. Syntax is:
</div>
<pre class="LyX-Code">
.remove &lt;triple&gt;
</pre>
<div class="Unindented">
Example:
</div>
<pre class="LyX-Code">
ts(.remove (triple ^s ^p ^o))
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-6.7.5">6.7.5</a> Querying Triples with<i> .select<a class="IndexReference" name="entry-.select-0" href="#index-.select">↓</a></i>
</h3>
<div class="Unindented">
The<i> .select</i> method provides a way of iterating over the set of triples in the graph and returning a new graph with triples of interest. Syntax:
</div>
<pre class="LyX-Code">
.select &lt;subject&gt; &lt;predicate&gt; &lt;object&gt; [&lt;procedure&gt;]
</pre>
<div class="Unindented">
The function iterates through every triple in the graph, if the<i> &lt;subject&gt;</i>,<i> &lt;predicate&gt;</i> and<i> &lt;object&gt;</i> parameters match those of the triple it is added to the result set. Nil parameters are ignored<span class="FootOuter"><span class="SupFootMarker"> [K] </span><span class="HoverFoot"><span class="SupFootMarker"> [K] </span>This is likely to change since<i> nil</i> is not matchable.</span></span>. Matching is performed as for triple equality rules. Thus<i> (.select nil nil nil)</i> matches all triples. Matching rules:
</div>
<div class="Indented">
<table>
<tr>
<td align="center" valign="top">
Parameter
</td>
<td align="center" valign="top">
Predicate
</td>

</tr>
<tr>
<td align="center" valign="top">
subject
</td>
<td align="center" valign="top">
eq?
</td>

</tr>
<tr>
<td align="center" valign="top">
predicate
</td>
<td align="center" valign="top">
eq?
</td>

</tr>
<tr>
<td align="center" valign="top">
property
</td>
<td align="center" valign="top">
equal?
</td>

</tr>

</table>

</div>
<div class="Indented">
If the last parameter is present it must be a procedure which takes three parameters of the form:
</div>
<pre class="LyX-Code">
function(&lt;subject&gt; &lt;predicate&gt; &lt;object&gt;)
</pre>
<div class="Unindented">
If the triple is matched, then this function is called with the triple’s subject, predicate and object as actual parameters. If the function returns a non<i>-nil</i> value then the triple is added to the result set. The matching logic is equivalent to:
</div>
<pre class="LyX-Code">
and
   eq? &lt;subject&gt; .subject
   eq? &lt;predicate&gt; .predicate
   equal? &lt;object&gt; .object
   &lt;procedure&gt; .subject .predicate .object
</pre>
<div class="Unindented">
Here is a simple example: of select in use:
</div>
<pre class="LyX-Code">
var ts
   graph
      ~ ^(joe age three)
      ~ ^(joe age ten)
      ~ ^("John" age 22)
      ~ ^("John" height 223)
var result
   ts
     .select ^joe nil nil
assert
   equal?
      result
      graph ^(joe age three) ^(joe age ten)
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-6.7.6">6.7.6</a> Retrieving unique values with<i> .get<a class="IndexReference" name="entry-.get-0" href="#index-.get">↓</a> subject predicate</i>
</h3>
<div class="Unindented">
Often graphs will contain unique triples<a class="IndexReference" name="entry-unique-triples-0" href="#index-unique-triples">↓</a>, ie there is only one triple with the same<i> subject</i> and predicate. The<i> .get</i> method retrieves the<i> object</i> of this triple. If there is more than one matching triple, or none, an error is raised.
</div>
<div class="Indented">
Syntax:
</div>
<pre class="LyX-Code">
&lt;graph&gt; (.get subject predicate)
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-6.7.7">6.7.7</a> Retrieving multiple values with<i> .get-list<a class="IndexReference" name="entry-.get-list-0" href="#index-.get-list">↓</a> subject predicate</i>
</h3>
<div class="Unindented">
The<i> .get-list</i> method retrieves a list containing all the<i> objects</i> of the triples which have the<i> subject</i> and<i> predicate</i> specified. If there is no matching triple<i> NIL</i> is returned. Syntax:
</div>
<pre class="LyX-Code">
&lt;graph&gt; (.get-list subject predicate)
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-6.7.8">6.7.8</a> Updating with<i> .put<a class="IndexReference" name="entry-.put-0" href="#index-.put">↓</a> subject predicate object</i>
</h3>
<div class="Unindented">
The<i> put</i> method removes all triples from the graph with the matching<i> subject</i> and<i> predicate</i>, then adds a single triple with the<i> subject predicate object</i> specified<i>.</i>If there are no matching triples no error is raised, the triple is simply added. This operation is intended to support the pattern of a unique triples<a class="IndexReference" name="entry-unique-triples-1" href="#index-unique-triples">↓</a>, where it serves as an update operation.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-6.7.9">6.7.9</a> Fetching all the triples with<i> .asTriples<a class="IndexReference" name="entry-.asTriples-0" href="#index-.asTriples">↓</a></i>
</h3>
<div class="Unindented">
The<i> .asTriples</i> method returns a list containing all the triples in the graph.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-6.7.10">6.7.10</a> Triplification with<i> .asGraph<a class="IndexReference" name="entry-.asGraph-0" href="#index-.asGraph">↓</a><span class="FootOuter"><span class="SupFootMarker"> [L] </span><span class="HoverFoot"><span class="SupFootMarker"> [L] </span>This method is not fully implemented for all types yet.</span></span></i>
</h3>
<div class="Unindented">
All objects in Genyris can be converted into a series of triples depending on their type. Typically this results in a type triple for each of the object’s classes, and properties as individual triples. Examples:
</div>
<pre class="LyX-Code">
&gt;<i>class Inches</i>
&lt;class Inches (Thing)&gt; # StandardClass

&gt;<i>var foot (tag Inches 12)</i>
12 # Inches Bignum

&gt;<i>(foot(.asGraph))(.asTriples))</i>
((triple 12 type &lt;class Inches (Thing)&gt;)
 (triple 12 type &lt;class Bignum (Builtin)&gt;)) # Pair
</pre>
<div class="Unindented">
and
</div>
<pre class="LyX-Code">
&gt;<i>(^(1 2)(.asGraph))(.asTriples)</i>

((triple (1 2) type &lt;class Pair (Builtin)&gt;)) # Pair
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-6.7.11">6.7.11</a> Meta-Data for Triples
</h3>
<div class="Unindented">
Triples can belong to multiple classes just like any other Genyris object. This allows them to be annotated and have classes and methods. For example here we tag a triple as being factual:
</div>
<pre class="LyX-Code">
&gt;<i>class Fact</i>
&lt;class Fact (Thing)&gt; # StandardClass

&gt;<i>var kr (triple ^KevinRudd ^role ^PrimeMinister)</i>
(triple KevinRudd<a class="IndexReference" name="entry-KevinRudd-0" href="#index-KevinRudd">↓</a> role PrimeMinister) # Triple

&gt;<i>tag Fact kr</i>
(triple KevinRudd role PrimeMinister) # Fact Triple
</pre>
<div class="Unindented">
Triples can also be the subject of other triples which means complex meta-descriptions are possible without resorting to reification. Here is the example above expressed with another triple.
</div>
<pre class="LyX-Code">
&gt; var meta-kr (triple kr ^Belief ^Fact)

(triple (triple KevinRudd role PrimeMinister) Belief Fact) # Triple
</pre>
<div class="Unindented">
Triples and graphs allow the programmer to store information about objects which may not have a means of adding properties of their own beyond their class membership list.
</div>
<h1 class="Section">
<a class="toc" name="toc-Section-7">7</a> Input and Output
</h1>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-7.1">7.1</a> Output
</h2>
<div class="Subparagraph">
<a class="IndexReference" name="entry-print-0" href="#index-print">↓</a><i>print</i>&lt;arg1&gt;...&lt;argn&gt;
</div>
<div class="Unindented">
Outputs its arguments to the current standard output stream as if typed in by a user in indented format. - strings are quoted, escape characters are output. Arguments on the output are seperated by a newline. Example:
</div>
<pre class="LyX-Code">
print ^(1 ’w\n’ (x y))

1 ’w\n’
   x y

</pre>
<div class="Subparagraph">
<i>write<a class="IndexReference" name="entry-write-0" href="#index-write">↓</a></i>&lt;arg1&gt;...&lt;argn&gt;
</div>
<div class="Unindented">
Outputs its arguments to the current standard output stream with parenthesis syntax. - strings are quoted, escape characters are output. Arguments are output sequentially without space padding. Example:
</div>
<pre class="LyX-Code">
write ^(1 2 (e) ’w’)

(1 2 (e) ’w’)
</pre>
<div class="Subparagraph">
<a class="IndexReference" name="entry-display-0" href="#index-display">↓</a><i>display</i>&lt;arg1&gt;...&lt;argn&gt;
</div>
<div class="Unindented">
Outputs its arguments to the current standard output stream without syntax. - strings are not quoted, escape characters are not output. Arguments are output sequentially without padding. Example:
</div>
<pre class="LyX-Code">
display ^(1 ’w\n’ (x y))

(1 w
 (x y))
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-7.1.1">7.1.1</a> <i>u:format<a class="IndexReference" name="entry-format-0" href="#index-format">↓</a></i>
</h3>
<div class="Unindented">
Outputs the args as dictated by the format-string. 
</div>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-30"></a>Syntax:
</div>
<pre class="LyX-Code">
@prefix u ’http://www.genyris.org/lang/utilities#’
u:format &lt;format string&gt; args ...
</pre>
<div class="Unindented">
The same as 
</div>
<pre class="LyX-Code">
stdout(.format &lt;format string&gt; args ...) 
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-7.1.2">7.1.2</a> Class <a class="IndexReference" name="entry-Writer-0" href="#index-Writer">↓</a>Writer
</h3>
<div class="Unindented">
A class which accepts a stream of characters.
</div>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-31"></a>Methods
</div>
<div class="Description">
<span class="Description-entry"><i>.close<a class="IndexReference" name="entry-.close-0" href="#index-.close">↓</a></i></span> Closes the current output stream.
</div>
<div class="Description">
<span class="Description-entry"><i>.flush<a class="IndexReference" name="entry-.flush-0" href="#index-.flush">↓</a></i></span> Forces all buffered output to be written to the device.
</div>
<div class="Description">
<span class="Description-entry"><i>.format<a class="IndexReference" name="entry-.format-0" href="#index-.format">↓</a></i></span> &lt;format-string&gt;&lt;arg1&gt;...&lt;argn&gt; Outputs the args as dictated by the format-string. The format string is a normal string with the special format sequences. Each format sequence must be matched by a corresponding argument to format, used in order.
</div>
<ul>
<li class="nested">
<div class="Description">
<span class="Description-entry">%a</span> Outputs the argument without syntax - strings are unquoted, escape characters are not output
</div>
<div class="Description">
<span class="Description-entry">%s</span> Outputs the argument using if entered by a user - strings are quoted, escape characters are not output
</div>
<div class="Description">
<span class="Description-entry">%x</span> Outputs the argument as XML using an XmlWriter
</div>
<div class="Description">
<span class="Description-entry">%u</span> Outputs the argument as a URL encoded string suitable for HTTP URLS
</div>
<div class="Description">
<span class="Description-entry">%n</span> Outputs a linefeed
</div>
<div class="Description">
<span class="Description-entry">%%</span> Outputs a % character
</div>
<div class="Unindented">
Example:
</div>

</li>

</ul>
<pre class="LyX-Code">
stdout(.format ’%s %a %x %n’ ’Hello’ ’World’ ^(img ((width= 23))))

’Hello’ World &lt;img width="23"/&gt;
</pre>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-32"></a>Global Variables
</div>
<div class="Description">
<span class="Description-entry"><i>stdin<a class="IndexReference" name="entry-stdout-0" href="#index-stdout">↓</a></i></span> A global variable which holds a<i> Reader</i> pointing the current Standard input device, typically the console.
</div>
<div class="Description">
<span class="Description-entry"><i>stdout<a class="IndexReference" name="entry-stdout-1" href="#index-stdout">↓</a></i></span> A global variable which holds a<i> Writer</i> pointing the current Standard output device, typically the console.
</div>
<div class="Description">
<span class="Description-entry"><i>stderr<a class="IndexReference" name="entry-stdout-2" href="#index-stdout">↓</a></i></span> A global variable which holds a<i> Writer</i> pointing the current Standard Error device, typically the console.
</div>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-7.2">7.2</a> Input
</h2>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-7.2.1">7.2.1</a> <i>EOF<a class="IndexReference" name="entry-EOF-0" href="#index-EOF">↓</a></i>
</h3>
<div class="Unindented">
Used to denote the End Of File, this symbol causes a parser to exit if seen.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-7.2.2">7.2.2</a> <a class="IndexReference" name="entry-read-0" href="#index-read">↓</a><i>read</i>
</h3>
<div class="Unindented">
Reads an expression from the standard input. 
</div>
<div class="Indented">
An optional argument if non-nil tells the reader to use PairSource objects instead of Pair objects when constructing lists. This captures the fiename and line numbers of the lists read. 
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-7.2.3">7.2.3</a> <i>stdin<a class="IndexReference" name="entry-stdin-0" href="#index-stdin">↓</a></i>
</h3>
<div class="Unindented">
The <i>stdin</i> variable is bound to the <i>Reader</i> object corresponding to the operating system standard input.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-7.2.4">7.2.4</a> Class Reader
</h3>
<div class="Unindented">
The reader object allow access to streams of bytes and characters as Genyris expressions or lines of strings. Reader objects are created in these situations:
</div>
<ul>
<li>
by the <i>Reader!new</i> method
</li>
<li>
<i>stdin</i> # global variable
</li>
<li>
<i>File(.open)</i>
</li>
<li>
<i>web:get &lt;URL&gt;</i>
</li>
<li>
<i>Pipe(.input)</i>
</li>
<li>
<i>Process(.getOutput)</i>
</li>

</ul>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-33"></a>Methods
</div>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-34"></a><i>.new &lt;String&gt;<a class="IndexReference" name="entry-.new-1" href="#index-.new">↓</a></i>
</div>
<div class="Unindented">
The <i>.new</i> class method creates a new instance of <i>Reader</i> from a <i>String</i>. This method returns a Reader object which uses a String as its input. Once read, the content from the String cannot be re-read. Example:
</div>
<pre class="LyX-Code">
&gt; (Reader!new "secret\n")
:    .copy stdout
: 
secret
nil # NilSymbol SimpleSymbol 
</pre>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-35"></a><i>.close<a class="IndexReference" name="entry-.close-1" href="#index-.close">↓</a></i>
</div>
<div class="Unindented">
The <i>.close</i> method closes the input Reader.
</div>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-36"></a><i>.read<a class="IndexReference" name="entry-.read-0" href="#index-.read">↓</a></i>
</div>
<div class="Unindented">
Read a byte from the stream and returns a <i>Bignum</i>. .<i>hasData</i> must be called prior to .<i>read</i>.
</div>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-37"></a><i>.hasData<a class="IndexReference" name="entry-.hasData-0" href="#index-.hasData">↓</a></i>
</div>
<div class="Unindented">
Returns true if the stream has data for reading otherwise<i> nil.</i>
</div>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-38"></a><i>.readAll<a class="IndexReference" name="entry-.readAll-0" href="#index-.readAll">↓</a></i>
</div>
<div class="Unindented">
Returns the entire content of the stream as a <i>String</i>. EOF will be returned if the file is empty or if readAll is called more than once.
</div>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-39"></a>.getline<a class="IndexReference" name="entry-.getline-0" href="#index-.getline">↓</a>
</div>
<div class="Unindented">
Reads the next line fron the input stream and returns it minus the trailing line-feed. Carriage return characters are ignored.
</div>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-40"></a><i>.copy<a class="IndexReference" name="entry-.copy-0" href="#index-.copy">↓</a></i>
</div>
<div class="Unindented">
The .copy method copies all the data from the stream to a Writer stream object which is passed as its only parameter. Fr example, the following copies all console input back to the screen until an <i>EOF</i> is found:
</div>
<pre class="LyX-Code">
stdin (.copy stdout)
</pre>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-41"></a><i>.digest<a class="IndexReference" name="entry-.digest-&lt;type&gt;-0" href="#index-.digest-&lt;type&gt;">↓</a></i>
</div>
<div class="Unindented">
The <i>.digest</i> method computes a message digest for all items in the stream. It reads the entire stream and calculates the digest. The digest value is returned as <i>String</i> hexedecimal value. The stream must be a character stream. Example:
</div>
<pre class="LyX-Code">
&gt; (Reader!new "secret")
:   .digest "MD5"
: 
’5ebe2294ecd0e0f08eab7690d2a6ee69’ # String 

</pre>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-42"></a>.mk-iterator<a class="IndexReference" name="entry-.mk-iterator-0" href="#index-.mk-iterator">↓</a>
</div>
<div class="Unindented">
This method creates a closure which when called, returns a line from the input stream or the symbol <i>sys:StopIteration </i>at the end of the stream. Can be used where a call to <i>.mkIterator</i> is required, such as in <i>for</i>. Example:
</div>
<pre class="LyX-Code">
var f (File(.new (prepend-home ’test/fixtures/agile.txt’)))
var fd (f(.open ^read))
for line in fd
  print line
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-7.2.5">7.2.5</a> IndentedParser
</h3>
<div class="Unindented">
Parsers are objects which convert character streams to expressions by parsing. The <i>IndentedParser</i> object understands the indented syntax described in section <a class="Reference" href="#sub:Syntax">1.1↑</a>.
</div>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-43"></a><i>.new<a class="IndexReference" name="entry-.new-2" href="#index-.new">↓</a> &lt;Reader&gt;</i>
</div>
<div class="Unindented">
The .<i>new</i> method creates an instance of an <i>IndentedParser</i> from a Reader stream. Examples
</div>
<div class="Subparagraph*">
Example 1. Parsing a file:
</div>
<pre class="LyX-Code">
var fd 
   (File(.new (prepend-home ’test/fixtures/indented.dat’)))
      .open ^read
var parser (IndentedParser(.new fd))
</pre>
<div class="Subparagraph*">
Example 2. Parsing a String
</div>
<pre class="LyX-Code">
var str-parser
   IndentedParser
      .new "# comment\n@prefix : ’http://www.foo.bar/quux#’\n
:one\n   rdf:two\n      ’three’\n      4\n      5.6\n"
</pre>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-44"></a><i>.read<a class="IndexReference" name="entry-.read-1" href="#index-.read">↓</a></i>
</div>
<div class="Unindented">
The .<i>read</i> method returns expressions from the stream one at a time. If there is no more to be read the function returns the symbol <i>EOF</i>. Example
</div>
<pre class="LyX-Code">
parser(.read)
</pre>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-45"></a>.prefix<a class="IndexReference" name="entry-.prefix-0" href="#index-.prefix">↓</a> &lt;prefix string&gt; &lt;expansion string&gt;
</div>
<div class="Unindented">
The .<i>prefix</i> method adds a namespace prefix to the parser as described in section <a class="Reference" href="#sub:Namespaces">8.2↓</a>. Example:
</div>
<pre class="LyX-Code">
str-parser
   .prefix "rdf" "http://w3c/rdf#"
</pre>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-46"></a><i>.close<a class="IndexReference" name="entry-.close-2" href="#index-.close">↓</a></i>
</div>
<div class="Unindented">
The .<i>close</i> method closes the underlying <i>Reader</i> stream.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-7.2.6">7.2.6</a> ParenParser
</h3>
<div class="Unindented">
Like the <i>IndentedParser</i>, the <i>ParenParser</i> converts character streams to expressions by parsing however the <i>ParenParser</i> object understands the non-indented syntax described in section <a class="Reference" href="#sub:Non-Indented-Syntax">1.2↑</a>. The methods <i>.new, .read, .prefix</i> and .<i>close</i> are identical to those methods of <i>IndentedParser</i>. (These are inherited from <i>AbstractParser</i> by both classes).
</div>
<div class="Indented">
Example:
</div>
<pre class="LyX-Code">
&gt; def myparse (string)
:    # parse a string returning the expression
:    (ParenParser(.new string))
:       .prefix "rdf" "http://w3c/rdf#"
:       .prefix "rdfs" "http://w3c/rdfs#"
:       .read
: 
&lt;EagerProc: &lt;myparse&gt;&gt; # EagerProcedure 
&gt; myparse ’(rdf:class Person)’
: 
(|http://w3c/rdf#class| Person) # Pair 


</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-7.2.7">7.2.7</a> <i>StringFormatStream<a class="IndexReference" name="entry-StringFormatStream-0" href="#index-StringFormatStream">↓</a></i>
</h3>
<div class="Unindented">
The StringFormatStream is a charcter-based filter class that parses an input stream looking for
</div>
<div class="Indented">
embedded mark-up with the suyntax #{..}. Its output consists of a sequence of
</div>
<div class="Indented">
Strings, interspersed with the embedded markup. For example an input stream consisting of the following: 
</div>
<pre class="LyX-Code">
Hello World #{
(+ 1 2 3 4 5)
} --
#{"A string"}
&lt;a href="#{(+ 4 5)}"&gt;A link&lt;/a&gt;
</pre>
<div class="Unindented">
is returned as the following character sequence:
</div>
<pre class="LyX-Code">
’"Hello World "\n(+ 1 2 3 4 5)\n" --\n""A string""\n&lt;a href=\""(+ 4 5)"\"&gt;A link&lt;/a&gt;\n"’
</pre>
<div class="Unindented">
This is a tool for creating tools whose input file is predominantly strings with small amounts of embedded code such as in server-side HTML templates with embedded excutable code.
</div>
<div class="Indented">
The following example shows how a file in StringFormatStream syntax can be read from a file, and the embedded #{} strings evaluated by the interpreter:
</div>
<pre class="LyX-Code">
def eval-sfs-file()
</pre>
<ul>
<li class="nested">
<pre class="LyX-Code">
  var fi (File(.new (prepend-home "test/fixtures/test.sfs")))
  var in (fi (.open ^read))
  var sfs (StringFormatStream(.new in))
  var parser (ParenParser(.new sfs))
  var exp nil
  while
     not
        equal? EOF
           setq exp (eval (parser(.read)))
     display exp
  parser(.close)
</pre>

</li>

</ul>
<div class="Unindented">
When given the same input as above, this function prints the input with execution of the embedded #{} expressions:
</div>
<pre class="LyX-Code">
Hello World 15 --
A string
&lt;a href="9"&gt;A link&lt;/a&gt;

</pre>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-47"></a><i>.new<a class="IndexReference" name="entry-.new-3" href="#index-.new">↓</a> &lt;Reader&gt;</i>
</div>
<div class="Unindented">
Creates a new StringFormatStream from a Reader stream and returns an encompassing Reader.
</div>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-7.3">7.3</a> <i>File<a class="IndexReference" name="entry-File-0" href="#index-File">↓</a></i>
</h2>
<div class="Unindented">
The File class provides access to the operating systems’ directories and files. File objects are Dictionaries.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-7.3.1">7.3.1</a> <i>.new<a class="IndexReference" name="entry-.new-4" href="#index-.new">↓</a> &lt;String filename&gt;</i>
</h3>
<div class="Unindented">
The .new class method creates and returns a new File object from a String giving the path to the file.
</div>
<pre class="LyX-Code">
&gt; File!new ’/tmp/foo’
:
(dict (.filename = ’/tmp/foo’)) # File Dictionary
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-7.3.2">7.3.2</a> <i>.open<a class="IndexReference" name="entry-.open-0" href="#index-.open">↓</a> &lt;mode&gt;</i>
</h3>
<div class="Unindented">
The .open method creates stream objects for access to files. If the <i>mode</i> is <i>^read</i> a <i>Reader</i> stream object is created for reading the file. Multiple Readers may be created at a time. 
</div>
<pre class="LyX-Code">
&gt; ((File!new ’.gitignore’)(.open ^read))(.readAll)
:
’#\n# Reading, Conferences...
</pre>
<div class="Unindented">
If the <i>mode</i> is <i>^write</i> the file is created and a Writer stream is returned. If the file already exists it is truncated.
</div>
<pre class="LyX-Code">
&gt; ((File!new ’/tmp/foo’)(.open ^write))
: .format "A new line."
: .close
:
nil # NilSymbol SimpleSymbol
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-7.3.3">7.3.3</a> <i>.list<a class="IndexReference" name="entry-.list-0" href="#index-.list">↓</a></i>
</h3>
<div class="Unindented">
if the <i>File</i> object is a directory, the <i>.list</i> method returns a list of the files in the directory.
</div>
<pre class="LyX-Code">
&gt; (File!new ’/etc’)(.list)
:
(’NetworkManager’ ’PackageKit’ ’Trolltech.conf’ ’X11’ ’abrt’ ’acpi’ ...
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-7.3.4">7.3.4</a> <i>.abs-path<a class="IndexReference" name="entry-.abs-path-0" href="#index-.abs-path">↓</a></i>
</h3>
<div class="Unindented">
The <i>.abs-path</i> method returns the absolute path of the file with all relative paths removed.
</div>
<pre class="LyX-Code">
&gt; (File!new ’/etc/..’)(.abs-path)
:
’/’ # String
</pre>
<div class="Unindented">
see java.io.File.getCanonicalFile
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-7.3.5">7.3.5</a> <i>.exists<a class="IndexReference" name="entry-.exists-0" href="#index-.exists">↓</a> &lt;String filename&gt;</i>
</h3>
<div class="Unindented">
The <i>.exists </i>class method returns true if the file exists otherwise nil.
</div>
<pre class="LyX-Code">
&gt; File!exists "/tmp/null"
:
nil # NilSymbol SimpleSymbol
&gt; File!exists "/tmp/foo"
:
true # SimpleSymbol
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-7.3.6">7.3.6</a> <i>.is-dir?<a class="IndexReference" name="entry-.is-dir?-0" href="#index-.is-dir?">↓</a> &lt;String filename&gt;</i>
</h3>
<div class="Unindented">
The <i>.is-dir? </i>class method returns true if the file is a directory otherwise <i>nil</i>. if the file does not exist <i>nil</i> is returned so this function could have been called does-the-file-exist-and-is-it-a-directory?
</div>
<pre class="LyX-Code">
&gt; File!is-dir? "/tmp/null"
:
nil # NilSymbol SimpleSymbol
&gt; File!is-dir? "/tmp"
:
true # SimpleSymbol
</pre>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-7.4">7.4</a> Pipes<a class="IndexReference" name="entry-Pipes-0" href="#index-Pipes">↓</a>
</h2>
<div class="Unindented">
Genyris provides named pipes within the JVM which allows tasks to communicate with each other by sending character streams. Each pipe has a unique name and tasks can access the pipes by their names.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-7.4.1">7.4.1</a> .list<a class="IndexReference" name="entry-.list-1" href="#index-.list">↓</a> - obtain a list of the current pipe names
</h3>
<div class="Unindented">
Syntax:
</div>
<pre class="LyX-Code">
Pipe!list
</pre>
<div class="Unindented">
This function returns a list of the string names of the pipes currently existing.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-7.4.2">7.4.2</a> <a class="IndexReference" name="entry-.open-1" href="#index-.open">↓</a>.open - Create or find a named pipe
</h3>
<div class="Unindented">
Syntax: 
</div>
<pre class="LyX-Code">
Pipe!open &lt;name string&gt;
</pre>
<div class="Unindented">
If the pipe already exists this function returns the <i>Pipe</i> object for the pipe. The same object is shared between tasks in the JVM and may be used for synchronization. If there is no pipe of that name, a new one is created and returned to the caller.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-7.4.3">7.4.3</a> .output<a class="IndexReference" name="entry-.output-0" href="#index-.output">↓</a> - Obtain a Writer stream for writing to a Pipe
</h3>
<div class="Unindented">
Syntax:
</div>
<pre class="LyX-Code">
&lt;pipe object&gt;(.output)
</pre>
<div class="Unindented">
This method returns a <i>Writer</i> object which can the be used to send characters to the pipe.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-7.4.4">7.4.4</a> .input<a class="IndexReference" name="entry-.input-0" href="#index-.input">↓</a> - Obtain a Reader for reading from a Pipe
</h3>
<div class="Unindented">
Syntax:
</div>
<pre class="LyX-Code">
&lt;pipe object&gt;(.input)
</pre>
<div class="Unindented">
This method returns a <i>Reader</i> object which can the be used to read characters from the pipe.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-7.4.5">7.4.5</a> .delete<a class="IndexReference" name="entry-.delete-0" href="#index-.delete">↓</a> - Remove a named pipe from the system
</h3>
<div class="Unindented">
Syntax:
</div>
<pre class="LyX-Code">
Pipe!delete &lt;name string&gt;
</pre>
<div class="Unindented">
This function closes a pipe and removes it from the global list of pipes.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-7.4.6">7.4.6</a> Pipe Examples<a class="IndexReference" name="entry-Pipe-Examples-0" href="#index-Pipe-Examples">↓</a>
</h3>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-48"></a>Single Reader, Single Writer
</div>
<div class="Unindented">
The first example shows a single task writing to a pipe and a single task reading from it. Since there is no contention there is no need to synchronize the tasks. The writing task executes this:
</div>
<pre class="LyX-Code">
define shared (Pipe!open ’shared-pipe’)
spawn ’test/mocks/pipe-reader.g’ ’shared-pipe’
define out
   shared(.output)
out(.format ’Hello from the first task\n’)
</pre>
<div class="Unindented">
The reader task is launched and executes this code:
</div>
<pre class="LyX-Code">
@prefix task ’http://www.genyris.org/lang/task#’
@prefix sys ’http://www.genyris.org/lang/system#’
define inpipe (Pipe(.open (nth 1 sys:argv)))
define in (inpipe(.input))
var line (in(.getline))
assert (equal? ’Hello from the first task’ line)
</pre>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-49"></a>Single Reader, Multiple Writer
</div>
<div class="Unindented">
The second example has multiple writer tasks which must be synchronized when writing to the pipe otherwise the data becomes mixed. The read executes this code which spawns a number of writer tasks, passing the name of the pipe. It reads a number of lines checking they are exactly in sequence:
</div>
<pre class="LyX-Code">
define shared (Pipe!open ’shared-pipe3’) # create the pipe.
for i in (range 0 5)
    spawn ’test/mocks/pipe-writer-synch.g’ ’shared-pipe3’
define in (shared(.input))
for i in (range 0 100)
   var line (in(.getline)) # read from the pipe
   assert (equal? ’Hello from task.’ line)
</pre>
<div class="Unindented">
The writer tasks open the pipe and repeatedly write lines:
</div>
<pre class="LyX-Code">
@prefix task ’http://www.genyris.org/lang/task#’
@prefix sys ’http://www.genyris.org/lang/system#’
define shared (Pipe(.open (nth 1 sys:argv))) # open the pipe
define out
   shared(.output)
while true
    task:synchronized shared # use the pipe object to synchronize on
       catch errors     # ignore errors when the reader dies.
          out(.format ’Hello from task.\n’)
    sleep 10

</pre>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-7.5">7.5</a> Interacting with Web Servers with HTTP<i><a class="IndexReference" name="entry-HTTP-0" href="#index-HTTP">↓</a></i>
</h2>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-7.5.1">7.5.1</a> <i>web:get<a class="IndexReference" name="entry-web:get-0" href="#index-web:get">↓</a></i> &lt;url&gt; [&lt;request headers&gt; [&lt;protocol version&gt;]]
</h3>
<div class="Unindented">
Content can be sent to and fetched from web servers using the <i>web:get</i> function. This takes as input a URL string and an optional list of request headers. The HTTP protocol can be specified as either ’1.0’ or ’1.1’ (default). It sends the GET request to web server then returns a list containing the response content in a <i>Reader</i> stream followed by an assoc list of response headers. For example:
</div>
<pre class="LyX-Code">
([Exp: org.genyris.io.ReaderInStream@574ff50a] 
   ((nil = ’HTTP/1.1 200’) 
      (’Date’ = ’Tue, 27 Oct 2015 08:38:39 GMT’) 
      (’Content-Length’ = ’37’) 
      (’Content-Type’ = ’text/plain’)))
</pre>
<div class="Unindented">
The response must have the 200 ’OK’ status code otherwise an exception is raised. Example, fetching the root file from the localhost server on port 80, using HTTP/1.0 and providing a ’Basic’ authentication header.
</div>
<pre class="LyX-Code">
web:get ’http://localhost:8080/’ =
        ^((’authorization’ = ’Basic Zm9vOmJhcg==’)) ’1.0’
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-7.5.2">7.5.2</a> <i>web:post<a class="IndexReference" name="entry-web:post-0" href="#index-web:post">↓</a></i> &lt;url&gt; [&lt;params assoc&gt;] [&lt;request headers&gt; [&lt;protocol version&gt;]]
</h3>
<div class="Unindented">
Content can also be sent to and fetched from web servers using the <i>web:post</i> function. This takes as input a URL string and an optional lists of request POST parameters and headers. The HTTP protocol can be specified as either ’1.0’ or ’1.1’ (default). It sends the POST request to web server then returns a list containing the response content in a <i>Reader</i> stream followed by a assoc list of response headers. For example:
</div>
<pre class="LyX-Code">
([Exp: org.genyris.io.ReaderInStream@574ff50a] 
   ((nil = ’HTTP/1.1 200’) 
      (’Date’ = ’Tue, 27 Oct 2015 08:38:39 GMT’) 
      (’Content-Length’ = ’37’) 
      (’Content-Type’ = ’text/plain’)))
</pre>
<div class="Unindented">
The response must have the 200 ’OK’ status code otherwise an exception is raised. For example, to send a HTTP/1.1 POST with two parameters, a basic auth login, and read the response to a string: 
</div>
<pre class="LyX-Code">
    var response
        web:post ’http://127.0.0.1:7780/’ 
            data
                a = ’test-web-post’
                x = 908
            data
                ’authorization’ = ’Basic Zm9vOmJhcg==’
            ~ 1.1
    var receivedData
        (left response)
            .readAll
</pre>
<h1 class="Section">
<a class="toc" name="toc-Section-8">8</a> Programming in the Large
</h1>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-8.1">8.1</a> Including Source Files
</h2>
<div class="Unindented">
Functions are provided to allow files of source code to be read and executed. The parser to be used is automatically selected based on the file suffix. The following suffixes and parsers are supported:
</div>
<div class="Indented">
<table>
<tr>
<td align="center" valign="top">
suffix
</td>
<td align="center" valign="top">
Parser Class
</td>
<td align="center" valign="top">
Syntax
</td>

</tr>
<tr>
<td align="center" valign="top">
.g
</td>
<td align="center" valign="top">
<i>IndentedParser</i>
</td>
<td align="center" valign="top">
Genyris indented syntax
</td>

</tr>
<tr>
<td align="center" valign="top">
.lsp
</td>
<td align="center" valign="top">
<i>ParenParser</i>
</td>
<td align="center" valign="top">
Free format LISP Syntax with parentheses in place of indentation.
</td>

</tr>

</table>

</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-8.1.1">8.1.1</a> load<a class="IndexReference" name="entry-load-0" href="#index-load">↓</a><i>&lt;java resource name&gt;</i>
</h3>
<div class="Unindented">
The<i> load</i> function reads and executes a source file from the Java classpath. Some initialization code files are stored within the distributed binary Java &ldquo;jar&rdquo; file . The<i> &lt;java resource name&gt;</i> parameter is a full path to the file. For example:
</div>
<pre class="LyX-Code">
<b>load</b> ’examples/people.g’
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-8.1.2">8.1.2</a> include<a class="IndexReference" name="entry-include-1" href="#index-include">↓</a><i>&lt;path to filename&gt;</i>
</h3>
<div class="Unindented">
The<i> include</i> function reads and executes files of scripts in the global environment. The &lt;path to filename&gt; parameter refers to a normal operating system file path. <i>include </i>searches the list of directories in the<i> sys:path</i> variable and uses the first matching file it finds. If the path begins with a slash, the search path is not used. Examples:
</div>
<pre class="LyX-Code">
include ’examples/people.g’   # relative path
setq sys:path (cons ’examples’ sys:path)
include ’people.g’    # using the search path
include ’/workspace/genyris/examples/queens.g’  # absolute path
</pre>
<div class="Unindented">
The return value is a string with the actual file path loaded. If the file cannot be found an exception is raised.
</div>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-8.2">8.2</a> Namespaces<a class="Label" name="sub:Namespaces"> </a>
</h2>
<div class="Unindented">
A way to prevent name clashes is to use symbol prefixes to define ’namespaces<a class="IndexReference" name="entry-namespaces-0" href="#index-namespaces">↓</a>’ for symbols. A namespace can be defined with a Parser Directive &ldquo;<i>@prefix</i><a class="IndexReference" name="entry-_prefix-0" href="#index-_prefix">↓</a>&rdquo; as follows
</div>
<pre class="LyX-Code">
@prefix magic ’http://my.org/2008/spells/’
</pre>
<div class="Unindented">
Here the expression starting with<i> @prefi</i>x is consumed by the parser, and any subsequent symbols it sees starting with the prefix<i> magic</i>. are replaced with<i> http://my.org/2008/spells/</i>. Hence the true name of<i> magic.accio</i> is<i> http://my.org/2008/spells/accio</i>. We can print the full name of the symbol by quoting it:
</div>
<pre class="LyX-Code">
&gt; @prefix magic ’http://my.org/2008/spells/’
^magic:accio
~ http://my.org/2008/spells/accio # URISymbol<a class="IndexReference" name="entry-URISymbol-0" href="#index-URISymbol">↓</a>
</pre>
<div class="Unindented">
Here is the previous example re-worked using a namespace:
</div>
<pre class="LyX-Code">
## File Handling Module (using prefixes)
@prefix file ’http://my/files/’
def file:copy(from to) etc
def file:delete(filename) etc
def file:zip(file) etc

## Use of the file module
@prefix f ’http://my/files/’
def archive(filename)
    f:copy filename ’/tmp/foo’
    f:zip ’/tmp/foo’
    f:delete filename
</pre>
<div class="Unindented">
Prefixes apply to all symbols seen by the parser in the current parse, and can be used in a variety of ways (for example) to define global properties or interfaces.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-8.2.1">8.2.1</a> Disambiguate Properties and Methods
</h3>
<div class="Unindented">
Like RDF, Genyris supports sharing of property names (or method names) amongst classes and objects. Indeed use of fully qualified symbols to denote identical concepts wherever they appear is very good practice. Consider the object introduced in <i>’examples/people.g’</i>:
</div>
<pre class="LyX-Code">
@prefix foaf ’http://xmlns.com/foaf/0.1/’ 
dict
      .foaf:name = "Neil Wheedon Watkins Pye"
      .foaf:age = 49 
      .bong = true
</pre>
<div class="Unindented">
Using the RDF ontology at <i>http://xmlns.com/foaf/0.1/</i> we can deduce object is of class <i>foaf:Person</i> because there is a fully qualified <i>foaf:age</i> property. We also know from the ontology that the unit of <i>foaf:age</i> is integer years. However the meaning of the unqualified ’<i>bong</i>’ property can only be guessed.
</div>
<div class="Indented">
If extensive use of mixins or multiple inheritance is used, name clashes may arise in languages without namespaces for symbols. In Genyris (as in RDF) properties can have fully qualified URI names, providing simple disambiguation. The following example avoids a clash over the <i>’draw’</i> method because the public methods of the two base classes are fully qualified:
</div>
<pre class="LyX-Code">
@prefix graphics ’http://www.gameslib.org/interfaces/’
@prefix weapon ’http://mygame.com/007/’

class Shape()
   def .graphics:draw()
        ’draw object image on the computer screen’

class SecretAgent()
   def .weapon:draw()
        ’take gun out of holster’

class SecretAgentSprite(Shape SecretAgent)

</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-8.2.2">8.2.2</a> Genyris property values are first class objects.
</h3>
<div class="Unindented">
In RDF, literals such as <i>&ldquo;Rick&rdquo;</i> cannot belong to classes, nor can they be shared between triples. Genyris allows literals to be ’first class’. They can be shared between objects belong to classes. Hence another approach is to tag the values of the properties with the class:
</div>
<pre class="LyX-Code">
class foaf:name

define rick
  dict
     .name = (tag foaf:name "Rick")

&gt; rick
(dict (.name = "Rick")) # Dictionary 

&gt; rick!name
"Rick" # |http://xmlns.com/foaf/0.1/name| String 
</pre>
<div class="Unindented">
This has the advantage that methods can be associated with the <i>’Rick’</i> string via the <i>foaf:name</i> class. The system will remember that the string is a <i>foaf:name</i>. However the program source lacks semantic mark-up. Depending on the application both techniques may be appropriate.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-8.2.3">8.2.3</a> Semantic Markup
</h3>
<div class="Unindented">
Namespaces are compatible with RDF<a class="IndexReference" name="entry-RDF-1" href="#index-RDF">↓</a> and allow you to embed the semantics of the information within the program. This can be used either for human consumption (to fully identify the meaning of the information) or for subsequent processing and linkage with external programs which also understand RDF. Here’s an example:
</div>
<pre class="LyX-Code">
&gt; @prefix us "http://places.org/usa#"
var boston                   # variable declaration
  dict                       # new dictionary object
    .us:location = "Boston"
    .us:zip = "02110"
    .us:location-lat = 42.37
    .us:location-long = 71.03
dict
      .|http://places.org/usa#location| = "Boston"
      .|http://places.org/usa#location-lat| = 42.37
      .|http://places.org/usa#location-long| = 71.03
      .|http://places.org/usa#zip| = "02110" # Dictionary
</pre>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-8.3">8.3</a> Modules
</h2>
<div class="Unindented">
We have seen how names can be grouped within a Dictionary object. This idea is made easier through modules<a class="IndexReference" name="entry-modules-0" href="#index-modules">↓</a>. A module is simply a dictionary into which the contents of a source file have been bound. When the input file is read, all dynamic bindings are automatically made in a ’module’ dictionary. Continuing with our example, first we provide a file of functions and definitions called ’<i>file.g</i>’.
</div>
<pre class="LyX-Code">
#
# File Handling Module
#
define .doc ’File Handling Functions’
define .version ’1.2’
def .copy(from to)
   etc
def .delete(filename)
   etc
def .zip(file)
   etc
def helperFunction(args)
   etc
</pre>
<div class="Unindented">
Notice we don’t need to declare a dictionary since this is provided by<i> import</i><a class="IndexReference" name="entry-import-0" href="#index-import">↓</a>. To use the module we first need to tell the interpreter where to find the file containing the module’s code. This is done by adding to the<i> sys:path</i> global variable which is a list of directories to search:
</div>
<pre class="LyX-Code">
setq sys:path<a class="IndexReference" name="entry-sys:path-0" href="#index-sys:path">↓</a> (cons ’examples’ sys:path)
</pre>
<div class="Unindented">
Now we read the source code:
</div>
<pre class="LyX-Code">
import file
</pre>
<div class="Unindented">
This creates a variable<i> file</i> in the environment of the caller (not necessarily the global environment). Using the module’s dictionary we can now access the functions in the module:
</div>
<pre class="LyX-Code">
## Use of the file module
import file
file!copy filename ’/tmp/foo’
</pre>
<div class="Unindented">
Note that<i> helperFunction</i> is defined with a normal lexical variable. It cannot be reached from outside the module since only dynamic symbols can be de-reference via a dictionary. Use this to create private variables and functions inside modules.
</div>
<div class="Indented">
If we change the source code of<i> file.g</i> and need to load the new code, we must use the<i> reload<a class="IndexReference" name="entry-reload-0" href="#index-reload">↓</a></i> macro, since import checks to see if the module already is in memory, and uses the already loaded module.
</div>
<pre class="LyX-Code">
&gt; reload file
etc...
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-8.3.1">8.3.1</a> sys:import<a class="IndexReference" name="entry-sys:import-0" href="#index-sys:import">↓</a> &lt;filename name&gt;
</h3>
<div class="Unindented">
The<i> sys:import</i> function is similar to the include function in that it reads and executes a file of Genyris source code. However the code is executed<i> in the environment of the caller</i>. Therefore in a lexical environment, new bindings created by<i> define</i> and<i> def</i> et. al. will be created locally. In a dynamic environment such as in a Dictionary, the dynamic bindings in the top level of the file will affect the caller’s object. This function is used by the<i> import</i> facility to define modules.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-8.3.2">8.3.2</a> import<a class="IndexReference" name="entry-import-1" href="#index-import">↓</a> &lt;module name&gt;
</h3>
<div class="Unindented">
The<i> import</i> macro uses<i> sys:import</i> to create dictionaries in which the file’s bindings are held. To allow users to have multipe calls to<i> import</i>, yet all refer to the same object,<i> import</i> stores all module dictionaries in the<i> sys:modules</i> graph. This graph contains a binding between the module name and the module object. When the import is called it checks to see if the module has already been loaded, if so it binds the module to a variable of the same name in the caller’s environment. Hence there may be many bindings of the module name to the same physical object.
</div>
<div class="Indented">
To simplify loading, the<i> import</i> macro searches for a file with the name of the module plus the<i> ’.g’</i> suffix. It uses the list of directories in the<i> sys:path</i> variable for the search path and uses the first matching file it finds. Example:
</div>
<pre class="LyX-Code">
setq sys:path (cons ’examples’ sys:path)
import queens
queens!queens 5  # call the module’s public function
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-8.3.3">8.3.3</a> reload<a class="IndexReference" name="entry-reload-1" href="#index-reload">↓</a> &lt;module name&gt;
</h3>
<div class="Unindented">
The<i> reload</i> macro uses the existing module’s filename to reload the source code of the module. If there are multiple bindings to the module, only the caller will have a binding to the new module. The binding in the<i> sys:modules</i> graph is replaced with the new object. Other references to the module will still refer to the old module.
</div>
<h1 class="Section">
<a class="toc" name="toc-Section-9">9</a> Genyris Classes
</h1>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-9.1">9.1</a> Class Hierarchy
</h2>
<div class="Unindented">
Here is the default class hierarchy:
</div>
<pre class="LyX-Code">
 Thing
    Calendar
    HttpRequest
    Task
    Module
    SetList
    Range
    Alist
    Builtin
       Pair
          ListOfLines
          PRINTWITHEQ
          PairSource
          PairEqual
       Closure
          JavaStaticMethod
          JavaMethod
          JavaConstructor
          LazyProcedure
          EagerProcedure
             Iterator
                ReaderLineIterator
                DictionaryKeyIterator
                RangeIterator
                PairIterator
       Symbol
          NilSymbol
          DynamicSymbolRef
          URISymbol
          SimpleSymbol
             |http://www.genyris.org/lang/syntax#Keyword|
       TailCall
       http://www.genyris.org/lang/java#class
       JavaWrapper
       Java
          com_ostermiller_util_Base64
          java_lang_Package
          java_io_InputStreamReader
          java_lang_Process
       Graph
       Triple
       StringFormatStream
       AbstractParser
          ParenParser
          IndentedParser
       os
       System
       Pipe
       Writer
       Reader
       File
       String
          ShortDateTimeString
          Base64EncodedString
       Biscuit
       Bignum
       Dictionary
          Object
          StandardClass
</pre>
<div class="Indented">
The class tree can be inspected by traversing the <i>.subclasses</i> property of classes as follows:
</div>
<pre class="LyX-Code">
@prefix u "http://www.genyris.org/lang/utilities#"
def indent(depth)
    while (&gt; depth 0)
       u:format ’   ’
       setq depth (- depth 1)
def printAllClasses(root depth)
    indent depth
    u:format ’ %a\n’ root!classname
    for c in root!subclasses
       printAllClasses c (+ 1 depth)
printAllClasses Thing 0
</pre>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-9.2">9.2</a> <i>class StandardClass<a class="IndexReference" name="entry-StandardClass-0" href="#index-StandardClass">↓</a></i>
</h2>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-9.2.1">9.2.1</a> <i>.classname<a class="IndexReference" name="entry-.classname-1" href="#index-.classname">↓</a></i>
</h3>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-9.2.2">9.2.2</a> <i>.subclasses<a class="IndexReference" name="entry-.subclasses-1" href="#index-.subclasses">↓</a></i>
</h3>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-9.2.3">9.2.3</a> <i>.superclasses<a class="IndexReference" name="entry-.superclasses-1" href="#index-.superclasses">↓</a></i>
</h3>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-9.2.4">9.2.4</a> <i>.vars<a class="IndexReference" name="entry-.vars-2" href="#index-.vars">↓</a></i>
</h3>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-9.2.5">9.2.5</a> <i>Builtin<a class="IndexReference" name="entry-Builtin-0" href="#index-Builtin">↓</a></i>
</h3>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-9.3">9.3</a> <i>class Thing<a class="IndexReference" name="entry-Thing-1" href="#index-Thing">↓</a></i>
</h2>
<div class="Unindented">
<i>Thing</i> is the superclass class of all classes in the interpreter. When a class is created with no superclasses <i>Thing</i> is set to the superclass of the new class.
</div>
<pre class="LyX-Code">
&gt; class Foo
: 
&lt;class Foo (Thing)&gt; # StandardClass 
</pre>
<div class="Unindented">
Universal properties available to all objects are as follows.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-9.3.1">9.3.1</a> <i>.vars<a class="IndexReference" name="entry-.vars-3" href="#index-.vars">↓</a></i><a class="IndexReference" name="entry--vars-0" href="#index--vars">↓</a>
</h3>
<div class="Unindented">
<i>.vars </i>returns a list of the properties of the object. For builtin classes this will be just <i>(.self .vars .classes).</i>
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-9.3.2">9.3.2</a> <i>.self<a class="IndexReference" name="entry-.self-2" href="#index-.self">↓</a></i><a class="IndexReference" name="entry--self-0" href="#index--self">↓</a>
</h3>
<div class="Unindented">
<i>.self </i>returns the object.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-9.3.3">9.3.3</a> <i>.classes<a class="IndexReference" name="entry-.classes-2" href="#index-.classes">↓</a></i><a class="IndexReference" name="entry--classes-0" href="#index--classes">↓</a>
</h3>
<div class="Unindented">
<i>.classes</i> returns a list of the classes to which the object belongs.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-9.3.4">9.3.4</a> <i>.valid?<a class="IndexReference" name="entry-.valid?-4" href="#index-.valid?">↓</a></i><a class="IndexReference" name="entry--valid?-0" href="#index--valid?">↓</a><i> &lt;object&gt;</i>
</h3>
<div class="Unindented">
A class may define a <i>.valid?</i> class method for use by the object classifier. This method returns <i>true</i> if the object passed in conforms to the specification for the class. 
</div>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-9.4">9.4</a> <i>class NilSymbol<a class="IndexReference" name="entry-NilSymbol-0" href="#index-NilSymbol">↓</a></i>
</h2>
<div class="Unindented">
The symbol <i>nil</i> is a member of the <i>NilSymbol</i> class which is a subclass of <i>SimpleSymbol. </i>
</div>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-9.5">9.5</a> <i>class Closure<a class="IndexReference" name="entry-Closure-0" href="#index-Closure">↓</a></i>
</h2>
<div class="Unindented">
<i>Closure</i> is the base class for all builtin executable classes, <i>JavaStaticMethod, JavaMethod, JavaConstructor, LazyProcedure </i>and <i>EagerProcedure. </i>
</div>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-9.6">9.6</a> <i>class LazyProcedure<a class="IndexReference" name="entry-LazyProcedure-0" href="#index-LazyProcedure">↓</a></i>
</h2>
<div class="Unindented">
Closures which don’e evaulate their arguments prior to execution are tagged in the Lazy Procedure class. Functions in this class include:<i> task:synchronized lambda assertEqual df do define lambdam lambdaq and var import or then ++ reload setq</i>
</div>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-9.7">9.7</a> <i>class EagerProcedure<a class="IndexReference" name="entry-EagerProcedure-0" href="#index-EagerProcedure">↓</a></i>
</h2>
<div class="Unindented">
Closures which evaluate their arguments prior to evaluation are tagged in the EagerProcedure class. Members include:<i> asString right else % * + sleep / - symlist &gt; beginsWith? &lt; raise java:actionListener write left parse sys:mk-module| intern task:httpd bound? sys:junit-test-runner prepend-home task:ps append caar display task:spawn set cadr utilities:format calendar task:sleep abs include utilities:getLocalTime member? map-left date:calendar printAllClasses import-aux apply</i>
</div>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-9.8">9.8</a> class <a class="Label" name="sub:Pair"> </a><i>Pair<a class="IndexReference" name="entry-Pair-0" href="#index-Pair">↓</a></i>
</h2>
<div class="Unindented">
Pair objects are builtin ’cons’ cells - a n object with two properties which refer to any Genyris object. The slots are named <i>.left</i> and <i>.right. </i>Refer section <a class="Reference" href="#sub:Lists-and-Pairs">6.2↑</a>. These objects are members of class <i>Pair.</i>
</div>
<pre class="LyX-Code">
&gt; (cons 1 2)
: 
(1 = 2) # Pair 

</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-9.8.1">9.8.1</a> <i>.left<a class="IndexReference" name="entry-.left-1" href="#index-.left">↓</a></i>
</h3>
<div class="Unindented">
The <i>.left </i>property holds the <i>left</i> property of the Pair.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-9.8.2">9.8.2</a> <i>.right<a class="IndexReference" name="entry-.right-1" href="#index-.right">↓</a></i>
</h3>
<div class="Unindented">
The <i>.right </i>property holds the <i>right</i> property of the Pair.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-9.8.3">9.8.3</a> <i>list<a class="IndexReference" name="entry-list-3" href="#index-list">↓</a> &lt;obj&gt; ...</i>
</h3>
<div class="Unindented">
The eager <i>list</i> function returns its arguments as a List made of Pairs. 
</div>
<pre class="LyX-Code">
&gt; list 1 "2" ^(3)
: 
(1 "2" (3)) # Pair 
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-9.8.4">9.8.4</a> <i>car<a class="IndexReference" name="entry-car-0" href="#index-car">↓</a> &lt;Pair&gt;</i>
</h3>
<div class="Unindented">
The <i>car</i> function returns the <i>.left</i> property of a <i>Pair</i>.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-9.8.5">9.8.5</a> <i>cdr<a class="IndexReference" name="entry-cdr-0" href="#index-cdr">↓</a> &lt;Pair&gt;</i>
</h3>
<div class="Unindented">
The <i>cdr</i> function returns the <i>.right</i> property of a <i>Pair</i>.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-9.8.6">9.8.6</a> <i>left<a class="IndexReference" name="entry-left-2" href="#index-left">↓</a> &lt;Pair&gt;</i>
</h3>
<div class="Unindented">
The <i>left</i> function returns the <i>.left</i> property of a <i>Pair</i>.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-9.8.7">9.8.7</a> <i>right<a class="IndexReference" name="entry-right-2" href="#index-right">↓</a> &lt;Pair&gt;</i>
</h3>
<div class="Unindented">
The <i>right</i> function returns the <i>.right</i> property of a <i>Pair</i>.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-9.8.8">9.8.8</a> <i>cons<a class="IndexReference" name="entry-cons-2" href="#index-cons">↓</a> &lt;left&gt; &lt;right&gt;</i>
</h3>
<div class="Unindented">
The <i>cons</i> function returns a <i>Pair</i> object comprising properties of its two arguments left and right respectively.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-9.8.9">9.8.9</a> <i>rplaca<a class="IndexReference" name="entry-rplaca-0" href="#index-rplaca">↓</a> &lt;Pair&gt; &lt;obj&gt;</i>
</h3>
<div class="Unindented">
The <i>rplaca</i> replaces the left property of a Pair in its with the value of its second paramenter. This <i>modifies</i> the &lt;obj&gt; it does not create a copy of the object. The &lt;obj&gt; is returned. This function can be used to create self-referential structures. 
</div>
<pre class="LyX-Code">
&gt; define x (cons 1 2)
: 
(1 = 2) # Pair 
&gt; rplaca x 99
: 
(99 = 2) # Pair 
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-9.8.10">9.8.10</a> <i>rplacd<a class="IndexReference" name="entry-rplacd-0" href="#index-rplacd">↓</a></i>
</h3>
<div class="Unindented">
The <i>rplacd</i> replaces the right property of a Pair in its with the value of its second paramenter. This <i>modifies</i> the &lt;obj&gt; it does not create a copy of the object. The &lt;obj&gt; is returned. This function can be used to create self-referential structures. 
</div>
<pre class="LyX-Code">
&gt; define x (cons 1 2)
: 
(1 = 2) # Pair 
&gt; rplacd x 99
: 
(2 = 99) # Pair 
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-9.8.11">9.8.11</a> <i>reverse<a class="IndexReference" name="entry-reverse-0" href="#index-reverse">↓</a> &lt;list&gt;</i>
</h3>
<div class="Unindented">
The revese function returns a new list with the elements in reverse order. 
</div>
<pre class="LyX-Code">
&gt; reverse ^(1 2 3)
: 
(3 2 1) # Pair
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-9.8.12">9.8.12</a> <i>length<a class="IndexReference" name="entry-length-0" href="#index-length">↓</a></i>
</h3>
<div class="Unindented">
The length function returns a count of the number of elements in a list, or number of characters in a <i>String</i>. 
</div>
<pre class="LyX-Code">
&gt; length ^(1 2 3)
: 
3 # Bignum 
&gt; length "123"
: 
3 # Bignum 
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-9.8.13">9.8.13</a> <i>map-left<a class="IndexReference" name="entry-map-left-0" href="#index-map-left">↓</a> &lt;List&gt; &lt;function-closure&gt;</i>
</h3>
<div class="Unindented">
The map-left function applies its second parameter (a function) to each element in its first parameter (a list) and returns a list of the returns.
</div>
<pre class="LyX-Code">
&gt; var x ^(1 2 3 4 5 6)
: 
(1 2 3 4 5 6) # PairSource 
&gt; map-left x (lambda (y) (&gt; y 3))
: 
(nil nil nil true true true) # Pair 
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-9.8.14">9.8.14</a> <i>member?<a class="IndexReference" name="entry-member?-0" href="#index-member?">↓</a> &lt;List&gt; &lt;obj&gt;</i>
</h3>
<div class="Unindented">
The <i>member? </i>function returns <i>nil</i> if the second parameter is not <i>equal? to </i>an element in the second parameter, otherwise it returns some other object not equal to <i>nil</i>.
</div>
<pre class="LyX-Code">
&gt; var x ^(1 2 (4))
: 
(1 2 (4)) # PairSource 
&gt; member? ^(1) x 
:  
nil # NilSymbol SimpleSymbol
&gt; member? ^(4) x
: 
((4)) # PairSource 
</pre>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-9.9">9.9</a> class <a class="IndexReference" name="entry-PairSource-0" href="#index-PairSource">↓</a>PairSource
</h2>
<div class="Unindented">
Builtin PairSource objects are created by Parser classes. PairSource is a subclass of Pair.
</div>
<pre class="LyX-Code">
&gt; ^(x)
: 
(x) # PairSource 
&gt; ^(x)!line-number
: 
81 # Bignum 
&gt; ^(x)!line-number
: 
84 # Bignum 
&gt; ^(x)!filename                                                     
:                                      
’console’ # String  
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-9.9.1">9.9.1</a> .line-number
</h3>
<div class="Unindented">
This property holds the line number of the source file or stream where the Pair was created during the parse.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-9.9.2">9.9.2</a> .filename
</h3>
<div class="Unindented">
This property holds the name of the source file or stream where the Pair was created during the parse.
</div>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-9.10">9.10</a> <i>class Alist<a class="IndexReference" name="entry-Alist-0" href="#index-Alist">↓</a></i>
</h2>
<div class="Unindented">
The <i>Alist</i> class models the associative list of Lisp. An AList is a flat list comprising cons cells where the left property constitutes a key and the right a value. Methods are provided for accessing the key=value pairs. Example:
</div>
<pre class="LyX-Code">
tag AList ^((day = 1) (month = 1) (year = 1970))
</pre>
<div class="Unindented">
Here’s a more complete example:
</div>
<pre class="LyX-Code">
df data (&amp;rest args) args # quote multiple args

var assoc
  tag Alist 
    data
      about = "http://publisher/books#12312"
      title = "It Was A Dark And Stormy Night"
      author = "Fred Nurke"
</pre>
<div class="Unindented">
The variable <i>assoc</i> holds the Alist. 
</div>
<pre class="LyX-Code">
assert  (assoc(.hasKey ^title))
assertEqual nil (assoc(.hasKey ^ZZZ))
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-9.10.1">9.10.1</a> <i>.lookup<a class="IndexReference" name="entry-.lookup-0" href="#index-.lookup">↓</a></i>&lt;key&gt;
</h3>
<div class="Unindented">
The <i>.lookup</i> method searches the Alist left to right, if the key is <i>equal?</i> to the <i>.left</i> of an <i>Alist</i> pair, the <i>.right</i> of the pair is returned. If there is no match, <i>nil</i> is returned.
</div>
<pre class="LyX-Code">
&gt; assoc(.lookup ^title)
: 
"It Was A Dark And Stormy Night" # String 
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-9.10.2">9.10.2</a> .<i>getKeys<a class="IndexReference" name="entry-getKeys-0" href="#index-getKeys">↓</a></i>
</h3>
<div class="Unindented">
The <i>.getKeys</i> method returns the <i>.left</i> of each element of the list.
</div>
<pre class="LyX-Code">
&gt; assoc(.getKeys)
: 
(about title author) # Pair 
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-9.10.3">9.10.3</a> <i>.hasKey<a class="IndexReference" name="entry-.hasKey-0" href="#index-.hasKey">↓</a></i>&lt;key&gt;
</h3>
<div class="Unindented">
The method <i>.hasKey</i> returns nil if the first parameter is not a left of one of the Alist elements, otherwise a non-<i>nil</i> object is returned. 
</div>
<pre class="LyX-Code">
&gt; ((assoc(.hasKey ^titleZ)))
: 
nil # NilSymbol SimpleSymbol 
</pre>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-9.11">9.11</a> <i>class Object<a class="IndexReference" name="entry-Object-2" href="#index-Object">↓</a> </i>
</h2>
<div class="Unindented">
A base class for construction of traditional slot-based objects in Dictionaries, <i>Object</i> provides a generic <i>.new</i> method for constructing objects. <i>Object</i> is a subclass of <i>Dictionary</i>. User classes inherit from <i>Object</i> and optionally include a <i>.init</i> method to initialise the newly constructed object. 
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-9.11.1">9.11.1</a> <i>.new<a class="IndexReference" name="entry-.new-5" href="#index-.new">↓</a></i>
</h3>
<div class="Unindented">
This class method creates a new instance of the class. The construction sequence is
</div>
<ol>
<li>
A <i>Dictionary</i> object is created,
</li>
<li>
The <i>Dictionary</i> is tagged with the derived class,
</li>
<li>
The <i>.init</i> method of the derived class is applied in the scope of the new object
</li>

</ol>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-9.11.2">9.11.2</a> <i>.init<a class="IndexReference" name="entry-.init-1" href="#index-.init">↓</a> &lt;args&gt;...</i>
</h3>
<div class="Unindented">
Each class derived from <i>Object</i> would provide an <i>.init</i> method to customise newly created dictionaries. The <i>.init</i> method can have any parameters required by the programmer. Example:
</div>
<pre class="LyX-Code">
&gt; class PersonTraditional (Object)
:    def .init(name age)
:       define .name name
:       define .age age
: 
&lt;class PersonTraditional (Object)&gt; # StandardClass 
&gt; PersonTraditional(.new "Mary" 23)
: 
(dict (.age = 23) (.name = "Mary")) # PersonTraditional Dictionary 

</pre>
<h1 class="Section">
<a class="toc" name="toc-Section-10">10</a> Launching the Interpreter <a class="Label" name="sec:Running-Genyris"> </a>
</h1>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-10.11.1">10.11.1</a> Simplified Launching via the Path
</h3>
<div class="Unindented">
The distribution includes shell and batch files for simplified launching, both which require a change to the user’s environment.
</div>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-50"></a>Unix
</div>
<div class="Unindented">
Add an environment variable called<i> GENYRIS_HOME<a class="IndexReference" name="entry-GENYRIS_HOME-0" href="#index-GENYRIS_HOME">↓</a></i> which contains the path of the unpacked release. Modify your<i> PATH</i> environment variable to include<i> $GENYRIS_HOME/bin</i>. The interpreter can then be launched from the shell with
</div>
<pre class="LyX-Code">
<i>$ genyri</i>s
</pre>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-51"></a>Windows
</div>
<div class="Unindented">
On Windows the arrangement is similar. Add an environment variable called<i> GENYRIS_HOME</i>. Modify the<i> PATH</i> environment variable to include<i> %GENYRIS_HOME%\bin:</i> (from the GUI Start &gt; Control Panel &gt; System &gt; Advanced &gt; Environment Variables &gt; New). Now the interpreter can then be launched from the command prompt with<i> &ldquo;genyri</i>s&rdquo;.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-10.11.2">10.11.2</a> Command line options
</h3>
<div class="Unindented">
Genyris is started by the Java interpreter from the command line<a class="IndexReference" name="entry-command-line-0" href="#index-command-line">↓</a>. 
</div>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-52"></a>Using Genyris command-line interpreter.
</div>
<div class="Unindented">
The java<i> -jar</i> option specifies the jar to execute. For example:
</div>
<pre class="LyX-Code">
$<b>java -jar genyris-bin-nnn-xxxxxxxxx.jar</b>
</pre>
<div class="Unindented">
Since the default main class is the Read-Eval-Print-Loop (REPL) command line it is automatically chosen by the -jar option. The same REPL class above can be run identically as as follows:
</div>
<pre class="LyX-Code">
$ java -cp genyris-bin.jar org.genyris.interp.ClassicReadEvalprintLoop
</pre>
<div class="Unindented">
In both cases all subsequent shell command line arguments are ignored. The session is terminated when the interpreter read and End-Of-File from the standard input (Ctrl-D).
</div>
<div class="Subparagraph">
The top level
</div>
<div class="Unindented">
Genyris commands can be typed at the prompt, using two carriage returns (<span class="formula">↩</span>) to terminate a statement. The REPL reads the next indented expression, evaluates it in the global environment and prints the result. It also appends a comment consisting of the names of the classes of the result. This allows the user to verify the correct classes have been returned.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-10.11.3">10.11.3</a> Command-line editing
</h3>
<div class="Unindented">
Genyris uses the JLine library to allow commands to be recalled and edited. 
</div>
<div class="Subparagraph*">
Command History
</div>
<div class="Unindented">
You can peruse and edit previously entered lines with the up and down arrow keys.
</div>
<div class="Subparagraph">
Edit the current line
</div>
<div class="Unindented">
Use the left and right arrow keys to move around the current line. Also by default Ctrl-A and Ctrl-D move the cursor to the start and end of the lione.
</div>
<div class="Subparagraph">
Autocompletion with Tab
</div>
<div class="Unindented">
Pressing Tab lists the symbols bound in the environment which called (read). It uses the symbol prefixes seen so far in the session. Example:
</div>
<pre class="LyX-Code">
&gt; define avariable 23
: 
23 # Bignum 
&gt; + 23 a&lt;Tab&gt;
abs and append apply asString assert assertEqual avariable 
</pre>
<div class="Subparagraph">
Configuration
</div>
<div class="Unindented">
JLine is very configurable. ’vi’ or ’emacs’ modes are available, emacs being the default. Refer to the JLine documentation for details. (<a class="URL" href="https://github.com/jline/jline2#readme">https://github.com/jline/jline2#readme</a>)
</div>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-53"></a>Running a script in the command line
</div>
<pre class="LyX-Code">
DOS&gt; genyris -eval &ldquo;(print ’hello world’)&rdquo;

unix$ genyris -eval &ldquo;(print ’hello world’)&rdquo;
</pre>
<div class="Unindented">
If the return value of the expression is nil, the process exits with a 0 status, otherwise 1. 
</div>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-54"></a>Specify a file to run on the command line
</div>
<pre class="LyX-Code">
$ genyris examples/queens.g 5
</pre>
<div class="Unindented">
Arguments are passed after the file name and are available in <i>sys:argv</i>.
</div>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-55"></a>Running code from the standard input
</div>
<div class="Unindented">
If the filename is the minus sign then the standard input is used.
</div>
<pre class="LyX-Code">
$ genyris - &lt; examples/allclasses.g 
</pre>
<div class="Unindented">
Arguments are passed after the <i>’-’</i>.
</div>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-56"></a>Making a script executable (Unix)
</div>
<div class="Unindented">
If a script begins with<i> #!</i> it allows Unix to run the script directly. Here’s an example script:
</div>
<pre class="LyX-Code">
#!/usr/bin/sh /opt/home/birchb/workspace/genyris/bin/genyris
display ’Hello World’
</pre>
<div class="Unindented">
if the script is made executable it can be run directly:
</div>
<pre class="LyX-Code">
$ chmod u+x myscript.g
$ ./myscript.g
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-10.11.4">10.11.4</a> Interpreter Boot sequence
</h3>
<div class="Unindented">
After initialisation, the interpreter searches for the resource &ldquo;<i>org/genyris/load/boot/init.g</i>&rdquo; in the Java classpath and executes it. This file is provided in the genyris-bin jar file and contains a Genyris bootstrap which in loads other source files also provided within the jar file. This is equivalent to executing :
</div>
<pre class="LyX-Code">
load<b> </b>’org/genyris/load/boot/init.g<a class="IndexReference" name="entry-init.g-0" href="#index-init.g">↓</a>’
</pre>
<h1 class="Section">
<a class="toc" name="toc-Section-11">11</a> Tasks<a class="IndexReference" name="entry-Tasks-0" href="#index-Tasks">↓</a> - Multiple Threads of Execution
</h1>
<div class="Unindented">
<i>Tasks</i> in Genyris are modelled on Unix processes. They are seperate interpreter instances where shared memory is minimal, and communication is conducted via system objects outside of the interpreters themselves. This approach relieves the programmer with the burden of debugging multi-threaded code yet retains the advantages of asynchronous execution and multi-core hardware. This implementation uses a single Java thread per interpreter and uses Java in-process objects for inter-task communication.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-11.11.1">11.11.1</a> Running Multiple Interpreters in the Same Process with <i>spawn<a class="IndexReference" name="entry-spawn-0" href="#index-spawn">↓</a></i>
</h3>
<pre class="LyX-Code">
spawn &lt;source file to include&gt; &lt;args ...&gt;
</pre>
<div class="Unindented">
Spawn creates a new Genyris interpreter instance which is then executed by a seperate Java thread. Only the objects passed as parameters are shared between interpreter threads. They all share the same operating system interfaces, files, sockets etc since they are running in the same JVM. The function returns a<i> Task<a class="IndexReference" name="entry-Task-0" href="#index-Task">↓</a></i> object, which is a Dictionary containing, the name, id and state of the underlying Java thread. For example:
</div>
<pre class="LyX-Code">
spawn ’examples/spawn-example.g’ 1 2 3 4 5
</pre>
<div class="Unindented">
returns:
</div>
<pre class="LyX-Code">
(dict (.id = 9) (.name = ’examples/spawn-example.g’) 
(.state = ’RUNNABLE’)) # Task Dictionary
</pre>
<div class="Unindented">
The<i> spawn-example.g</i> file contains:
</div>
<pre class="LyX-Code">
@prefix sys ’http://www.genyris.org/lang/system#’

while true
   print sys:argv
   sleep 5000
</pre>
<div class="Unindented">
The output is:
</div>
<pre class="LyX-Code">
’examples/spawn-example.g’ 1 2 3 4 5
’examples/spawn-example.g’ 1 2 3 4 5
...
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-11.11.2">11.11.2</a> Termination with <tt><i>kill</i></tt>
</h3>
<div class="Unindented">
Tasks and the underlying Java threads are killed with the<i> task:kill<a class="IndexReference" name="entry-task:kill-0" href="#index-task:kill">↓</a></i> function. This is also available as the<i> .kill<a class="IndexReference" name="entry-.kill-0" href="#index-.kill">↓</a></i> method in the<i>Task</i> class<i><a class="IndexReference" name="entry-Task-class-0" href="#index-Task-class">↓</a></i>. A string is returned after completion. Note there is no guarantee from Java that the thread will be terminated.
</div>
<pre class="LyX-Code">
&lt;Thread&gt;(.kill)
</pre>
<div class="Unindented">
or
</div>
<pre class="LyX-Code">
@prefix task ’http://www.genyris.org/lang/task#’
task:kill &lt;integer Java thread id&gt;
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-11.11.3">11.11.3</a> Thread Safety<a class="IndexReference" name="entry-Thread-Safety-0" href="#index-Thread-Safety">↓</a>
</h3>
<div class="Unindented">
The<i> spawn</i> function provides a way of multi-tasking sections of an application. This allows seperate interpreter instances to execute, and share some common value objects passed by main arguments. The interpreter does not cater for multiple threads of execution running within the same interpreter scope. Although it is technically possible to share any genyris objects including functions between tasks, this is not supported. This is because execution of stored closures will mean two interpreters are operating in the same environment.
</div>
<div class="Indented">
Genyris<i> Tasks</i> are not<i> Threads.</i> The intent is that they are self-contained, supporting single-threaded applications only. However since the underlying Java objects must be shared between tasks for inter-task communication, a means of making this thread-safe is provided.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-11.11.4">11.11.4</a> <i>task:synchronized<a class="IndexReference" name="entry-task:synchronized-0" href="#index-task:synchronized">↓</a></i> - Control access to shared resources
</h3>
<div class="Unindented">
The<i> spawn</i> and<i> httpd</i> functions allow Genyris objects to be passed from one thread of execution to another. This is provided so that system objects such as pipes, files etc can be shared.
</div>
<div class="Indented">
Both tasks have references to the same in-memory objects, and there is real danger that the actions of one thread will corrupt the objects used by another. The<i> synchronized</i> macro ensures that access to shared objects is sequential. The syntax is as follows:
</div>
<pre class="LyX-Code">
task:synchronized &lt;object&gt;
    &lt;code body&gt;
    ....
</pre>
<div class="Unindented">
The effect of the macro is to wait for an implicit lock associated with the<i> &lt;object&gt;</i> to become free. When the lock is free the thread sets the lock and executes the<i> &lt;code body</i>&gt;. When the execution completes the lock is freed ready for another thread. A test-case:
</div>
<div class="Indented">
A task loops, watching a shared<i> Pair</i>, checking to see if the<i> left</i> value is ever 1. If so it raises an error.
</div>
<pre class="LyX-Code">
task:synchronized shared
     setq read-value (shared.left)
cond
     (equal? 1 read-value)
            raise "error"
</pre>
<div class="Unindented">
A second task loops, changing the value from 0 to 1 and back.
</div>
<pre class="LyX-Code">
task:synchronized shared
        shared (setq .left 1)
        sleep 13
        shared (setq .left 0)
        sleep 23
</pre>
<div class="Unindented">
Because both tasks are executing this code in the scope of a<i> synchronized</i> call, with the same shared lock object, the first task never sees the value altered to 1 by the second task. Without the<i> synchronized</i> macro the first task would see the manipulations of the second task.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-11.11.5">11.11.5</a> <i>ps</i> - list current running threads
</h3>
<div class="Unindented">
The<i> ps<a class="IndexReference" name="entry-ps-0" href="#index-ps">↓</a></i> function returns a list of<i> Task</i> objects for each of the current tasks.
</div>
<h1 class="Section">
<a class="toc" name="toc-Section-12">12</a> Running Web Servers
</h1>
<div class="Unindented">
Genyris can run multiple a single-threaded HTTP 1.0 servers in Tasks in the background. The web server is implemented in Java and provides a simple programming interface.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-12.11.1">12.11.1</a> Starting a web server
</h3>
<div class="Unindented">
A new interpreter can be started as a server with the<i> httpd<a class="IndexReference" name="entry-httpd-0" href="#index-httpd">↓</a></i> function:
</div>
<pre class="LyX-Code">
httpd &lt;port&gt; &lt;path to source file&gt; [args...]
</pre>
<div class="Unindented">
The<i> httpd</i> function takes parameters:
</div>
<ul>
<li>
the path of a Genyris source file to load and run
</li>
<li>
the TCP/IP port number on which the server will listen for requests.
</li>
<li>
all the remaining parameters are collected in a list and bound to<i> sys:argv</i>
</li>

</ul>
<div class="Unindented">
The return value is a<i> Task</i> object for the web server. Many web servers can be started in the same JVM, each server is allocated a unique interpreter instance, there is no sharing between interpreters apart from the<i> args</i> passed in<i>. </i>Multiple tasks may be started reading from the same port to allow higher throughput.
</div>
<div class="Indented">
The URL for the browser would be<i> http://localhost:&lt;port&gt;/</i>. 
</div>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-57"></a>Example
</div>
<pre class="LyX-Code">

httpd 7777 ’examples/www-demo.g’ 1 2 3 4 5
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-12.11.2">12.11.2</a> Stopping a web server
</h3>
<div class="Unindented">
The server is terminated by killing the thread, or by coding an explicit exit function within the web application. The server’s thread can be stopped with the<i> kill</i> functions described above.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-12.11.3">12.11.3</a> Processing Web Requests
</h3>
<div class="Unindented">
The web server main loop expects to fnd a function called<i> httpd-serve<a class="IndexReference" name="entry-httpd-serve-0" href="#index-httpd-serve">↓</a></i> which it calls for each web GET or POST request received from clients. The request from the remote client is passed to the function as a single parameter. The return from the function call must contain the response to be sent to the browser.
</div>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-58"></a>Example
</div>
<pre class="LyX-Code">
df httpd-serve (request)
   list 200 ’text/plain’ ’Hello World’
</pre>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-59"></a>Requests - HttpRequest class
</div>
<div class="Unindented">
The request parameter is an object of class<i> HttpRequest</i><a class="IndexReference" name="entry-HttpRequest-0" href="#index-HttpRequest">↓</a>. The class has the following methods which return components of the request:
</div>
<div class="Description">
<span class="Description-entry">.getMethod()</span> GET or POST
</div>
<div class="Description">
<span class="Description-entry">.getPath()</span> Path component of the URL
</div>
<div class="Description">
<span class="Description-entry">.getHeaders()</span> an<i> AList</i> containing the headers
</div>
<div class="Description">
<span class="Description-entry">.getParameters()</span> an<i> AList</i> containing GET or POST parameters
</div>
<div class="Description">
<span class="Description-entry">.getClient()</span> gives a Pair containing the client’s IP address and hostname
</div>
<div class="Description">
<span class="Description-entry">.getBasicUsernamePassword()</span> Returns the Basic Authentication scheme header as a dictionary with<i>.username</i> and<i>.password</i> strings. If no auth is present, the username and passwords are empty strings.
</div>
<div class="Description">
<span class="Description-entry">.toHTML()</span> a method returning an HTML list structure in %x format.
</div>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-60"></a>Responses
</div>
<div class="Unindented">
The return value from the<i> httpd-serve</i> function is anlaysed by the web server and executed as required. There are two types of response:
</div>
<ul>
<li>
Instruction to serve a file from the file system as a ’static’ page
</li>
<li>
A data structure to be converted to XHTML and transmittted
</li>

</ul>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-61"></a>Static Pages
</div>
<div class="Unindented">
If the return value is a list of the form:
</div>
<pre class="LyX-Code">
SERVE-FILE &lt;root Directory Path&gt; &lt;Path to File&gt; [&lt;list directory flag&gt;]
</pre>
<div class="Unindented">
Then the file referred to by the path &lt;root Directory Path&gt;/&lt;Path to File&gt; is served to the client. If the file is a directory, and the &lt;list directory flag&gt; is the symbol<i> ls</i>, then the directory listing is returned to the client in HTML. The following function provides a simple static web server:
</div>
<pre class="LyX-Code">
df httpd-serve (request)
</pre>
<ul>
<li class="nested">
<pre class="LyX-Code">
list ^SERVE-FILE ’/’ (request(.getPath)) ^ls
</pre>

</li>

</ul>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-62"></a>Http Responses in XML list structures
</div>
<div class="Unindented">
If the response is a list of the form:
</div>
<pre class="LyX-Code">
&lt;integer status code&gt; &lt;mime type&gt; &lt;tree&gt;
</pre>
<div class="Unindented">
then the web server converts &lt;tree&gt; into the relevant encoding and transmits it to the client. The conversion depends on the &lt;mime type&gt;.
</div>
<div class="Subparagraph">
text/plain
</div>
<div class="Unindented">
This type of response uses the parenthesised Genyris output formatter to display the &lt;tree&gt;. It is equivalent to the %s directive in the %format instruction.
</div>
<div class="Subparagraph">
text/html
</div>
<div class="Unindented">
This type of response must be in the XML format as used by the<i> %x</i> directive in the<i> format</i> function. This format requires XML tags to be symbols, followed by an attribute list. Strings any sub-tags are interleaved. The general grammar is:
</div>
<pre class="LyX-Code">
xml=tree :== html-tag ((attribute = ’value’)...)
</pre>
<ul>
<li class="nested">
<pre class="LyX-Code">
[’inner text’ |&lt;xml-tree&gt; ] ...
</pre>

</li>

</ul>
<div class="Unindented">
For example, the expression:
</div>
<pre class="LyX-Code">
u:format ’%x’
   quote
     html()
      head()
        title() "Lamp Server"
          body()
             form()
                input((name="op") (size="100") (value =none)) ""
                   verbatim() "&amp;nbsp;&amp;nbsp;&amp;nbsp;"
                   input((type="submit") (value="Go"))
</pre>
<div class="Unindented">
Is converted to the corresponding XML string:
</div>
<pre class="LyX-Code">
&lt;html&gt;&lt;head&gt;&lt;title&gt;Lamp Server&lt;body&gt;
&lt;form&gt;&lt;input name="op" size="100" value="none"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&lt;input type="submit" value="Go"/&gt;
&lt;/input&gt;&lt;/form&gt;&lt;/body&gt;&lt;/title&gt;&lt;/head&gt;&lt;/html&gt;
</pre>
<div class="Unindented">
The<i> verbatim</i> pseudo-tag passes text transparently. 
</div>
<div class="Indented">
The <i>stream </i>psuedo-tag allows the contents of a Reader object to be inserted in the output.
</div>
<div class="Indented">
This example (from<i> examples/www-demo.g</i>) echoes the input request in HTML:
</div>
<pre class="LyX-Code">
df httpd-serve (request)
   list 200 ’text/html’
      template
          html()
             head()
                title() ’Genyris demo’
             body()
                pre() ,sys.argv
                $(request (.toHTML))
</pre>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-12.11.4">12.11.4</a> Starting a static web server
</h3>
<div class="Unindented">
A static page web server can be started with the<i> www-static</i> script:
</div>
<pre class="LyX-Code">
httpd &lt;port&gt; "test/mocks/www-static.g" &lt;root directory&gt;
</pre>
<h1 class="Section">
<a class="toc" name="toc-Section-13">13</a> Using Java Classes
</h1>
<div class="Unindented">
The Genyris interpreter allows standard Java objects to be created and stored in variable bindings, and allows Java methods to be called from Genyris. Java objects are contained within a builtin ’<i>JavaWrapper</i>’ class, whose class list includes a Genyris class with Procedure objects corresponding to the Java methods. This allows Java objects and classes to be used in the same way as Genyris ones.
</div>
<div class="Indented">
Java symbol names used for fields, classnames etc have a different syntax to Genyris, so rather than using escaped symbols, the default is to map Java Symbols to Genyris ones. The Genyris name based on the java name with some characters translated as follows:
</div>
<div class="Indented">
<table>
<tr>
<td align="center" valign="top">
Java character
</td>
<td align="center" valign="top">
Genyris Character
</td>

</tr>
<tr>
<td align="center" valign="top">
.
</td>
<td align="center" valign="top">
_
</td>

</tr>
<tr>
<td align="center" valign="top">
[
</td>
<td align="center" valign="top">
*
</td>

</tr>

</table>

</div>
<div class="Indented">
This is used for class names method names, fields names or anywhere a Java name is used in a Genyris program.
</div>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-13.1">13.1</a> Importing a Java Class with<i> java:import</i>
</h2>
<div class="Unindented">
The<i> java:import<a class="IndexReference" name="entry-java:import-0" href="#index-java:import">↓</a></i> function creates a Genyris class corresponding to a Java class. The properties of the new Genyris class correspond to the methods and constructors of the Java class. The syntax is:
</div>
<pre class="LyX-Code">
@prefix java ’http://www.genyris.org/lang/java#’ java:import &lt;java class string&gt; [as &lt;shorthand name&gt;]
</pre>
<div class="Unindented">
The full java class name is supplied as a string. Optionally a shorthand symbol to use as well as the default name can be specified. The default name is translated as described above. The return value is the Genyris class created. This class is bound to the corresponding full name in the global environment. If the<i> as</i> clause is present the class is also bound to the shorthand name in the local environment of the caller.
</div>
<div class="Indented">
Example :
</div>
<pre class="LyX-Code">
&gt; java:import ’java.lang.Object’ as Jobject
 &lt;class java_lang_Object (Java)&gt; # StandardClass
&gt; assert (eq? java_lang_Object Jobject)
</pre>
<div class="Unindented">
Continuing with the<i> java.io.File</i> example, we can list the method with<i> .vars</i>:
</div>
<pre class="LyX-Code">
Jobject.vars
</pre>
<div class="Unindented">
produces
</div>
<pre class="LyX-Code">
(.notifyAll .getClass .wait-long-int .equals-java_lang_Object .hashCode
 .wait-long .classname .wait .java-classname .toString .new .notify
 .superclasses .subclasses .self .vars .classes) # Pair
</pre>
<div class="Unindented">
The methods names include the argument types seperated by a hyphen since Java allows multiple methods with the same name and different arguments (overloading). Constructors, which are nameless in Java, are given the prefix<i> new</i>-.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-13.1.1">13.1.1</a> Adding to Java Classes
</h3>
<div class="Unindented">
Because<i> java:import</i> creates a standard Genyris class, you are free to add, remove, update and delete methods of the class.
</div>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-13.2">13.2</a> Creating Instances of Java Objects
</h2>
<div class="Unindented">
Once a class has been imported, it is then possible to call the constructors from the Genyris class. The constructor returns a new instance wrapped in a<i> JavaWrapper</i> object. For example:
</div>
<pre class="LyX-Code">
&gt; java:import ’java.io.File’ as FileJ
&gt; var file (FileJ(.new-java_lang_String ’/’))
[java.io.File /] # java_io_File JavaWrapper
</pre>
<div class="Unindented">
A call to a Java method involves several steps:
</div>
<ul>
<li>
The arguments are converted to the closest Java type if possible, if a<i> JavaWrapper</i> is provided, the embedded Java Object is used.
</li>
<li>
The method is called, and exceptions caught
</li>
<li>
The return value is converted to a Genyris type if possible, otherwise the return value is placed in a<i> JavaWrapper</i> object.
</li>
<li>
Returned<i> JavaWrapper</i> objects are tagged with the relevant Genyris Java class if it has already been imported.
</li>

</ul>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-13.3">13.3</a> Accessing Fields
</h2>
<div class="Unindented">
Java objects are contained within<i> JavaWrapper</i> objects. When used as a function the the wrapper allows access to the fields of the Java objects using the dynamic symbol approach used for all other Genyris objects. In the above example we can list the Java fields with:
</div>
<pre class="LyX-Code">
&gt; file!vars
(.separatorChar .separator .pathSeparatorChar .pathSeparator
.self .vars .classes .http://www.genyris.org/lang/java#class)
# Pair
</pre>
<div class="Unindented">
The special field <i>java:class<a class="IndexReference" name="entry-java:class-0" href="#index-java:class">↓</a></i> provides the real Java class of the object.
</div>
<pre class="LyX-Code">
&gt; file!java:class
’java.io.File’ # String
</pre>
<div class="Unindented">
Read access to the fields is the same as for Dictionaries for example:
</div>
<pre class="LyX-Code">
&gt; file!separator
’/’ # String
</pre>
<div class="Unindented">
Write access is provided with<i> setq</i> as usual, however Java restrictions still apply:
</div>
<pre class="LyX-Code">
&gt; file(setq .separator ’;’)
*** Error - ’Can not set static final java.lang.String field
 java.io.File.separator to java.lang.String’
</pre>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-13.4">13.4</a> Calling Methods
</h2>
<div class="Unindented">
Calling Java method is identical to calling Genyris methods. Java static methods are treated the same as Genyris functions, in that they do not require a dynamic environment with<i> .self</i> bound. Java methods must be called within the context of a<i> JavaWrapper</i> object. Continuing with an example to list the files in a directory:
</div>
<pre class="LyX-Code">
&gt; file(.list)
(’sys’ ’srv’ ’vmlinuz’ ’selinux’ ...
</pre>
<div class="Unindented">
Notice that the Java<i> list()</i> method returns an array of<i> String</i>, which is automatically converted into a list of Genyris strings.
</div>
<div class="Indented">
Parameters are passed as usual, however basic types are automatically converted to Java objects if possible. Refer to the table below for details. For example:
</div>
<pre class="LyX-Code">
&gt; file(.compareTo-java_lang_Object file)
0 # Bignum
</pre>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-13.5">13.5</a> Conversions and Coersion
</h2>
<div class="Unindented">
The following table lists the conversions of base types in method calls, constructor calls and in fields accesses.:
</div>
<div class="Indented">
<table>
<tr>
<td align="center" valign="top">
<i>Java</i>
</td>
<td align="center" valign="top">
<i>Genyris</i>
</td>

</tr>
<tr>
<td align="center" valign="top">
byte
</td>
<td align="center" valign="top">
Bignum
</td>

</tr>
<tr>
<td align="center" valign="top">
short
</td>
<td align="center" valign="top">
Bignum
</td>

</tr>
<tr>
<td align="center" valign="top">
int
</td>
<td align="center" valign="top">
Bignum
</td>

</tr>
<tr>
<td align="center" valign="top">
long
</td>
<td align="center" valign="top">
Bignum
</td>

</tr>
<tr>
<td align="center" valign="top">
float
</td>
<td align="center" valign="top">
Bignum
</td>

</tr>
<tr>
<td align="center" valign="top">
double
</td>
<td align="center" valign="top">
Bignum
</td>

</tr>
<tr>
<td align="center" valign="top">
BigDecimal
</td>
<td align="center" valign="top">
Bignum
</td>

</tr>
<tr>
<td align="center" valign="top">
char
</td>
<td align="center" valign="top">
String
</td>

</tr>
<tr>
<td align="center" valign="top">
String
</td>
<td align="center" valign="top">
String
</td>

</tr>
<tr>
<td align="center" valign="top">
Array
</td>
<td align="center" valign="top">
List
</td>

</tr>
<tr>
<td align="center" valign="top">
boolean
</td>
<td align="center" valign="top">
NIL or true
</td>

</tr>
<tr>
<td align="center" valign="top">
java.awt.event.ActionListener
</td>
<td align="center" valign="top">
&lt;- Function Closure
</td>

</tr>
<tr>
<td align="center" valign="top">
other
</td>
<td align="center" valign="top">
JavaWrapper
</td>

</tr>
<tr>
<td align="center" valign="top">
java.io.Reader
</td>
<td align="center" valign="top">
Reader
</td>

</tr>

</table>

</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-13.5.1">13.5.1</a> Conversion To Java Objects
</h3>
<div class="Unindented">
The conversion of Genyris atoms and lists implicit in the calling of methods can be used explicitly with the<i> java:toJava</i> function. This takes two arguments, a string containing the name of a Java class and a Genyris object to be converted. The java class naming convention is is used for arrays. For example to convert a list of Bignums into a Java array of Integer:
</div>
<pre class="LyX-Code">
&gt; java:import  ’[Ljava.lang.Integer;’
&gt; java:toJava ’[Ljava.lang.Integer;’ ^(1 2 3)

[[Ljava.lang.Integer; [Ljava.lang.Integer;@148aa23] 
# *Ljava_lang_Integer; JavaWrapper
</pre>
<div class="Unindented">
Note that since we imported the class<i> [Ljava.lang.Integer;</i> the conversion automatically tags the<i> JavaWrapper</i> with that class.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-13.5.2">13.5.2</a> Conversion from Java To Genyris Objects
</h3>
<div class="Unindented">
Basic Java objects are converted into Genyris objects in a straightforward manner. These conversions implicit on the return from Java method calls can be called explicitly using the<i> java:toGenyris</i> function, which takes a single argument. For example here we convert a list of bignums to a Java array of Integer and back:
</div>
<pre class="LyX-Code">
&gt; var y     java:toJava ’[Ljava.lang.Integer;’ ^(1 2 3)
[[Ljava.lang.Integer; [Ljava.lang.Integer;@2087c268] # JavaWrapper
&gt; java:toGenyris y
(1 2 3) # Pair
</pre>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-13.6">13.6</a> Using Java Reflection from Genyris
</h2>
<div class="Unindented">
Java Reflection methods can be called (just like any other Java interface) to get more detailed information about the Java world. Here is an example which lists every method of<i> java.lang.class</i> in detail:
</div>
<pre class="LyX-Code">
&gt; var c
  java_lang_Class
      .forName-java_lang_String ’java.lang.Class’
[java.lang.Class class java.lang.Class] # java_lang_Class JavaWrapper

&gt; for m in (c(.getMethods)) (print m)
[java.lang.reflect.Method public static java.lang.Class java.lang.Class.forName(java.lang.String) throws java.lang.ClassNotFoundException]
...
</pre>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-13.7">13.7</a> Hooking Swing Events in Genyris
</h2>
<div class="Unindented">
Swing programs can be written in Genyris using the FFI descibed here. All the Swing classes can be accessed as usual, however there is one special case - handling of events from Swing. When Swing has an event to process (typically from a user action such as a mouse click) it needs to call a Genyris function. The Genyris<i> java:actionListener</i> function creates a bridging object that holds a closure which can be called later by Swing. The syntax is:
</div>
<pre class="LyX-Code">
java:actionListener &lt;closure&gt;
</pre>
<div class="Unindented">
Either lazy or eager procedures can be used in the closure parameter. Here’s an example:
</div>
<pre class="LyX-Code">
def onCancel(event)
    window(.dispose)

cancelButton
   .addActionListener-java_awt_event_ActionListener
         java:actionListener onCancel
</pre>
<div class="Unindented">
Here we have supplied an ActionListener to a Button object. The action listener saves the closure created by the<i> def</i>. When the user presses the button the onCancel function is called. Notice how the closure captures the<i> window</i> binding.
</div>
<div class="Indented">
Refer to the source file ’<i>examples/swing.g</i>’ for a complete example which looks like this:
</div>
<blockquote class="Quotation">
<img class="embedded" src="swing.jpg" alt="figure swing.jpg" style="max-width: 378px; max-height: 64px;"/>

</blockquote>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-13.8">13.8</a> Plotting 2D Figures on a Swing Canvas
</h2>
<div class="Unindented">
Sometimes it’s useful to be able to draw shapes and place images on a simple canvas. The supplied examples include<i> swing-canvas.g</i> which draws a red oval onto the frame:
</div>
<blockquote class="Quotation">
<img class="embedded" src="redOval.jpg" alt="figure redOval.jpg" style="width: 150px; max-width: 300px; height: 100px; max-height: 200px;"/>

</blockquote>
<div class="Unindented">
To allow the frame to be re-painted when it is moved about or re-sized, a special Java class is provided which allows the<i> paintComponent()</i> to be executed in Genyris. Instead of using the<i> JPanel</i> component, one uses a<i> GPanel</i> component, supplying a closure as an argument. The closure is executed by Swing when it needs the frame to be re-drawn. Let’s review code.
</div>
<div class="Indented">
First a callback function is defined which takes three parameters, a<i> Graphics</i> object (where drawing is done) and and a string:
</div>
<pre class="LyX-Code">
java:import ’java.awt.Graphics’ as Graphics

def paint(graphics id command)
  tag Graphics graphics # set up the methods
  cond
     graphics # did we get an object?
         graphics   # ok , draw on it
             .drawLine-int-int-int-int 0 0 100 100
</pre>
<div class="Unindented">
Next the special<i> GPanel</i> is created. The constructor expects a Genyris closure object:
</div>
<pre class="LyX-Code">
java:import ’org.genyris.java.swing.GPanel’ as GPanel
var panel
  GPanel
   .new-org_genyris_interp_AbstractClosure paint
</pre>
<div class="Unindented">
Finally the GPanel is added to a frame:
</div>
<pre class="LyX-Code">
frame
    .add-java_awt_Component panel
    .setVisible-boolean true
</pre>
<div class="Unindented">
This approach of adding a Java class can be used wherever a<i> paintComponent</i> callback is required. The Java code is minimal:
</div>
<pre class="LyX-Code">
public class GPanel extends JPanel {
    private static final long serialVersionUID = 1L;
    private AbstractClosure repaint;
    public GPanel(AbstractClosure closure) {
        super();
        repaint = closure;
    }
    public void paintComponent(Graphics g) {
        if (repaint != null) {
            Exp args[] = {
               JavaUtils.wrapJavaObject(repaint.getEnv(), g)
            };
            try {
               repaint.applyFunction(repaint.getEnv(), args);
            } catch (GenyrisException e) {
                e.printStackTrace();
            }
        }
    }
}
</pre>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-13.9">13.9</a> Limitations
</h2>
<div class="Unindented">
The following limitations exist which may be removed in later versions:
</div>
<ul>
<li>
Genuine methods called ’<i>new</i>’ may clash with constructors.
</li>
<li>
There may be name collisions between Genyris and Java. e.g. a Java method called<i> foo-org_bar_Class()</i> would clash with a Java method<i> foo(org.bar.Class c).</i>
</li>
<li>
Java Readers and Writers are not converted to Genyris streams.
</li>
<li>
The Java class hierarchy is not duplicated in the imported Genyris classes since the method list is a closure over the superclasses of a class.
</li>
<li>
There is no universal facility for allowing Java programs to call back Genyris functions, only<i> java.awt.event.ActionListener</i> is supported.
</li>

</ul>
<h1 class="Section">
<a class="toc" name="toc-Section-14">14</a> For Maintainers
</h1>
<div class="Unindented">
This section is for those wishing to compile Genyris from scratch for modification or who are maintaining the source. 
</div>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-14.1">14.1</a> Versioning Numbering
</h2>
<div class="Unindented">
This section describes the version numbering approach used for Genyris documentation, source and official executables. Maintainers of the official fork use the approach described here. 
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-14.1.1">14.1.1</a> Source Versioning
</h3>
<div class="Unindented">
The source artefacts are managed in the default branch of the master Mercurial repository. Every change results in a new revision of the entire source repository. Refer to Mercurial documentation for details. The Mercurial repository version is the definitive version identification for the source and takes the form of a hexadecimal string. e.g. <i>29e9e58f4025. </i>Maintainers make commits to the repository for each refactoring or small change. Best endeavours are made to ensure all repository versions pass all tests and are complete and consistent, however this is not guaranteed. Working changes are <i>untagged</i> and precede formal releases.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-14.1.2">14.1.2</a> Release Versioning
</h3>
<div class="Unindented">
Mercurial tags are used to mark particular versioned baselines of complete, consistent, documented and tested source artefacts. All formal releases are tagged with a version number tag. Once a versioned package has been tagged with a release version, the contents of that release are not modified. The Mercurial version number tags have the following syntax:
</div>
<pre class="LyX-Code">
X.Y.Z[.state]
</pre>
<div class="Unindented">
Where : X,Y and Z are integers which increase monotonically. For instance: 1.9.0 &lt; 1.10.0 &lt; 1.11.0 and where:
</div>
<div class="Description">
<span class="Description-entry">X</span> is the major version number. All source releases with the same major version number are compatible, that is code written for one minor release will work on all other lesser releases. Major version zero (0.Y.Z) is for initial development and anything may change at any time. The language specification 0.Y.X should not be considered stable. Version 1.0.0 defines the initial public language specification. Major version X (X.y.z | X &gt; 0) is incremented if any backwards incompatible changes are introduced to the language. It may include minor and fix level changes.
</div>
<div class="Description">
<span class="Description-entry">Y</span> is the minor version number Y (x.Y.z | x &gt; 0) and is incremented if new, backwards compatible functionality is introduced to the language. It may be incremented if substantial new functionality or improvements are introduced within the private code. It may include fix level changes.
</div>
<div class="Description">
<span class="Description-entry">Z</span> Is the fix version number Z (x.y.Z | x &gt; 0) and is incremented if bug fixes are introduced. A bug fix is defined as an implementation change that fixes divergence between the documentation and the implementation. In practice a bug fix is not <i>strictly</i> backward compatible, since applications may rely on the buggy behaviour. Fix versions include minor (cosmetic) corrections of documentation.
</div>
<div class="Description">
<span class="Description-entry">state</span> provides for special versions. A special version number is denoted by appending an arbitrary string immediately following the fix version. The string is comprised of only alphanumerics plus dash [0-9A-Za-z-] and begins with an alpha character [A-Za-z]. Special versions satisfy but have a lower precedence than the associated normal version. Precedence is determined by lexicographic ASCII sort order. For instance: 1.0.0beta1 &lt; 1.0.0beta2 &lt; 1.0.0.
</div>
<div class="Description">
<span class="Description-entry">Specification_Version</span> The Java <i>Specification Version</i> consists of the <i>Major</i> and <i>Minor</i> source version numbers. 
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-14.1.3">14.1.3</a> Source Branching
</h3>
<div class="Unindented">
Anonymous source branches are created by maintainers for a variety of reasons and are merged into the master repository. In very exceptional circumstances tagged source branches may be created for maintenance of older versions by branching from the prior release. For example if a defect is found in release 1.1.2 whilst the latest release is 1.2.0 a branch may be created from 1.1.2 for the fix and released as 1.1.2fix1.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-14.1.4">14.1.4</a> Version Information in Executables
</h3>
<div class="Unindented">
Genyris follows the Java product versioning standard<span class="FootOuter"><span class="SupFootMarker"> [M] </span><span class="HoverFoot"><span class="SupFootMarker"> [M] </span>http://download.oracle.com/javase/1.4.2/docs/guide/versioning/spec/versioning2.html</span></span>, versioning information is available in the jar files in the following manifest fields:
</div>
<div class="Description">
<span class="Description-entry">Specification-Version</span> This field includes the Major and Minor version numbers. Example: 0.6
</div>
<div class="Description">
<span class="Description-entry">Implementation-Version</span> This field includes the Major, Minor and Fix numbers with identification of the build job which generated the executable. Example: 0.6.1-b164
</div>
<div class="Unindented">
Intermediate, untagged builds contain the repository version of the workspace. Example: <i>tip-789-d242ce4255c0-b165</i>
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-14.1.5">14.1.5</a> Obtaining Version Information at Runtime
</h3>
<div class="Unindented">
The current version number of the Genyris interpreter is recorded in the Genyris jar file manifest. This can be accessed via the Java<i> Package</i> interface. Simplified access is provided in the<i> versioninfo</i> module. Example:
</div>
<pre class="LyX-Code">
import versioninfo
print versioninfo
</pre>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-14.2">14.2</a> Building From Source
</h2>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-14.2.1">14.2.1</a> Obtaining source from the Mercurial Repository
</h3>
<div class="Unindented">
The source code of Genyris is published to a Mercurial clone hosted by SourceForge. This code will be the latest code, whereas the binary releases are slightly older. To access the default Mercurial repository, get a local copy of the genyris repository with this command: 
</div>
<pre class="LyX-Code">
hg clone https://genyris.googlecode.com/hg/ genyris 
</pre>
<div class="Unindented">
Then <i>hg pull</i> to download source updates.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-14.2.2">14.2.2</a> The Source
</h3>
<div class="Unindented">
The source is Java 1.6 level and will compile on Oracle JDK 1.6 or later.
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-14.2.3">14.2.3</a> The Build
</h3>
<div class="Unindented">
To compile from source you need install<i>Ant<a class="IndexReference" name="entry-Ant-0" href="#index-Ant">↓</a></i> (version 1.7.1 or later). Change directory to the root of the unpacked directory. Then run the following command to build the program:
</div>
<pre class="LyX-Code">
$ ant
</pre>
<div class="Unindented">
At the end of the build you should see a summary of tests passed and ’<i>BUILD SUCCESSFUL</i>’:
</div>
<pre class="LyX-Code">
     [exec] Total # Test Files: 57
     [exec] Total # gunit Tests: 21
     [exec] Total # of failed test files: 0
     [exec] Total # gunit tests Failed 0
     [exec] Total # of JUnit tests: 212
     [exec] Total # of JUnit errors: 0
test:
all:
BUILD SUCCESSFUL

</pre>
<div class="Unindented">
The output jar files and release files are to be found in the <i>dist</i> and <i>rel</i> directories.
</div>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-63"></a>Release Automation
</div>
<div class="Unindented">
To build a new release make a new tag e.g. tag 0.6.2 and update a build repository clone to the tag. e.g.
</div>
<pre class="LyX-Code">
hg update -r 0.6.2 --clean
</pre>
<div class="Unindented">
Then use the ant target <i>release. </i>
</div>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-14.3">14.3</a> Reflection
</h2>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-14.3.1">14.3.1</a> <i>symlist<a class="IndexReference" name="entry-symlist-0" href="#index-symlist">↓</a></i>
</h3>
<div class="Unindented">
Symbols in Genyris are ’interned’ into a global symbol-table. This ensures symbols are unique. The <i>symlist</i> methor returns a list of all the symbols in the symbol-table. 
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-14.3.2">14.3.2</a> <i>sys:self-test<a class="IndexReference" name="entry-sys:self-test-0" href="#index-sys:self-test">↓</a></i>
</h3>
<div class="Unindented">
Genyris is provided with unit and acceptance test scripts. The <i>http://www.genyris.org/lang/system#self-test</i> function runs the self test suite. This can be used to validate the platform on which the interpreter is running.
</div>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-14.4">14.4</a> Extending and Modifying Genyris
</h2>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-14.4.1">14.4.1</a> Adding Builtin Java Functions to Core Genyris Classes
</h3>
<div class="Unindented">
All Genyris functions are implemented as normal Java classes. This includes the core classes for data such as Bignum, String etc. For example the Bignum objects are internally implemented as Java BigDecimals. Existing Java functionality for the internal representation can be used via the Java interface. It suffices to define a Genyris function or method which accesses the internal object via a reference. Consider:
</div>
<pre class="LyX-Code">
&gt; java:import ’java.math.BigDecimal’
&gt; java:toJava ’java.math.BigDecimal’ 123
[java.math.BigDecimal 123] # java_math_BigDecimal
                                  JavaWrapper

</pre>
<div class="Unindented">
This expression<i> (java:toJava ’java.math.BigDecimal’ 123)</i> obtains a reference to the internal BigDecimal object, which is in turn wrapped in a<i> JavaWrapper</i>object and tagged with the<i> java_math_BigDecimal</i> class. This allows direct access to the underlying object via its methods.
</div>
<div class="Indented">
Here is a Genyris method which returns the precision of a Bignum:
</div>
<pre class="LyX-Code">
&gt; Bignum
    def .precision()
        (java:toJava ’java.math.BigDecimal’ .self)
             .precision
&gt; 2134(.precision)
4 # Bignum
</pre>
<div class="Unindented">
Here is another example, character replacement method for all strings:
</div>
<pre class="LyX-Code">
String
    def .replace(old new)
        (java:toJava ’java.lang.String’ .self)
               .replace-char-char old new

&gt; "Shop"(.replace ’p’ ’e’)
’Shoe’ # String
</pre>
<h1 class="Part">
<a class="toc" name="toc-Part-III">Part III.</a> Libraries
</h1>
<div class="Unindented">
Genyris is, like Scheme, a small language which allows users to develop their own paradigms and languages. Since Genyris has access to Java classes via<i> java:import</i> a programmer can readily create their own data types, I/O libraries and so on. Hence the libraries provided with Genyris documented here are not a mandatory part of a Genyris implementation and their interfaces may change over time without changing the core language. The main emphasis is to provide common data types and functions useful for every-day scripting in a manner that fits well with the unique Genyris classification paradigm and its not-so-unique syntax.
</div>
<h1 class="Section">
<a class="toc" name="toc-Section-15">15</a> ListOfLines
</h1>
<div class="Unindented">
The <i>os!exec</i> method returns a of <i>ListOfLines</i>. A <i>ListOfLines</i> is a list of strings. each string being a sequential line without the trailing line feed. <i>ListOfLines</i> has a method <i>.toHTML</i> which returns HTML in %x format. Example:
</div>
<pre class="LyX-Code">
&gt; ((os!exec ’date’).left)(.toHTML)
((os!exec ’date’).left)(.toHTML)
: 
(pre nil ((’Monday 31 August  22:37:17 AEST 2015’ (br nil)))) # Pair 

</pre>
<h1 class="Section">
<a class="toc" name="toc-Section-16">16</a> System<a class="IndexReference" name="entry-System-0" href="#index-System">↓</a>
</h1>
<div class="Unindented">
The System module allows interaction with the interpreter itself.
</div>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-16.1">16.1</a> .HOME<a class="IndexReference" name="entry-.HOME-0" href="#index-.HOME">↓</a>
</h2>
<div class="Unindented">
This variable supplies the home directory of the interpreter installation. This will be the same as the <i>GENYRIS_HOME</i> environment variable.
</div>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-16.2">16.2</a> .LIBS
</h2>
<div class="Unindented">
This variable supplies the directory of the interpreter’s genyris library code. Normally set to <i>GENYRIS_HOME/libs</i>.
</div>
<h1 class="Section">
<a class="toc" name="toc-Section-17">17</a> <i>os<a class="IndexReference" name="entry-os-0" href="#index-os">↓</a></i>
</h1>
<div class="Unindented">
This module contains variables and functions that allow interaction with the Java VM and the operating system (os).
</div>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-17.1">17.1</a> .getProperties<a class="IndexReference" name="entry-.getProperties-0" href="#index-.getProperties">↓</a>
</h2>
<div class="Unindented">
This function supplies the current java properties as a dictionary. 
</div>
<h3 class="Subsubsection-">
<a class="toc" name="toc-Subsubsection--2"></a>Example:
</h3>
<pre class="LyX-Code">
&gt; print (os!getProperties)
: 
dict (.|file.encoding| = ’UTF-8’)
      .|file.encoding.pkg| = ’sun.io’
      .|file.separator| = ’/’
      .|java.awt.graphicsenv| = ’sun.awt.X11GraphicsEnvironment’
      .|java.awt.printerjob| = ’sun.print.PSPrinterJob’
</pre>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-17.2">17.2</a> <i>.exec<a class="IndexReference" name="entry-.exec-0" href="#index-.exec">↓</a> &lt;arg&gt;...</i>
</h2>
<div class="Unindented">
The <i>.exec</i> method spawns an operating system process using the arguments supplied as arguments to the command which is the first argument. The method returns a <i>Pair,</i> the .<i>left</i> holding a <i>ListOfLines</i> with the stdout of the process, and the .<i>right</i> holding a <i>ListOfLines</i> from stderr. Example:
</div>
<pre class="LyX-Code">
&gt; for l in ((os!exec ’ps’ ’-ef’).left) (print l)
: 
~ ’UID        PID  PPID  C STIME TTY          TIME CMD’
~ ’root         1     0  0 19:28 ?        00:00:01 /sbin/init’
~ ’root         2     0  0 19:28 ?        00:00:00 [kthreadd]’
....
</pre>
<div class="Unindented">
If the command cannot run, an exception is thrown which will indicate the error cause. Example:
</div>
<pre class="LyX-Code">
&gt; catch error
:   os!exec "Foo"
: 
nil # ListOfLines NilSymbol SimpleSymbol 
&gt; print error
: 
~ ’exec failed, message is: Cannot run program "Foo": java.io.IOException: error=2, No such file or directory’
</pre>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-17.3">17.3</a> <i>.getenv<a class="IndexReference" name="entry-.getenv-0" href="#index-.getenv">↓</a> [varname]</i>
</h2>
<div class="Unindented">
When called with no arguments, the <i>.getenv</i> method returns a <i>Dictionary</i> containing the current OS process environment. Example:
</div>
<pre class="LyX-Code">
&gt; os!getenv
: 
(dict (.DISPLAY = ’:0’) (.EDITOR = ’vi’) (.GENYRIS_HOME = ’/home/birchb/workspace/genyris’)
...
) # Dictionary 
</pre>
<div class="Unindented">
If an environment variable name parameter is passed in, <i>.getenv</i> returns only the value of the environment variable specified. Example:
</div>
<pre class="LyX-Code">
&gt; os!getenv ’GENYRIS_HOME’
: 
’/home/birchb/workspace/genyris’ # String 

</pre>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-17.4">17.4</a> .<i>spawn</i><a class="IndexReference" name="entry-.spawn-0" href="#index-.spawn">↓</a>
</h2>
<div class="Unindented">
This function starts an operating system process and returns immediately without waiting for the outcome. The function returns an object of type <i>Process</i> (<a class="Reference" href="#sub:Class-Process">17.8↓</a>), or an exception is raised.
</div>
<div class="Indented">
Example - Here we spawn a Windows command shell with a one-line echo statement. The parent process obtains the output from the process and copies it to the standard output.:
</div>
<pre class="LyX-Code">
&gt; var proc
   os!spawn ’cmd.exe’ ’/c’ ’echo’ =
          ’Testing one two three’
[java.lang.ProcessImpl java.lang.ProcessImpl@12d3205] 
# java_lang_Process JavaWrapper
</pre>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-17.5">17.5</a> .name
</h2>
<div class="Unindented">
.name is a property containing the operating system name. e.g. ’Linux’
</div>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-17.6">17.6</a> .tempdir
</h2>
<div class="Unindented">
.tempdir is a property containing the public directory for temporary files. e.g. ’/tmp’ or ’C:\temp’ on windows.
</div>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-17.7">17.7</a> .exit<a class="IndexReference" name="entry-.exit-0" href="#index-.exit">↓</a>
</h2>
<h3 class="Subsubsection-">
<a class="toc" name="toc-Subsubsection--3"></a>Syntax: 
</h3>
<pre class="LyX-Code">
os!exit &lt;process return&gt;
</pre>
<div class="Unindented">
This function requests the interpreter to terminate all threads and exit the operating system process. The optional single parameter (which defaults to zero if absent) is an integer value which the operating system returns as the process status.
</div>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-17.8">17.8</a> Class <a class="Label" name="sub:Class-Process"> </a>Process<a class="IndexReference" name="entry-Process-0" href="#index-Process">↓</a>
</h2>
<div class="Unindented">
This process is a JavaWrapper for the Java <i>java.lang.Process</i> class. The java methods include:
</div>
<div class="Description">
<span class="Description-entry">.destroy</span> Kills the subprocess.
</div>
<div class="Description">
<span class="Description-entry">.exitValue</span> Returns the exit value for the subprocess.
</div>
<div class="Description">
<span class="Description-entry">.getErrorStream</span> Gets the error stream of the subprocess.
</div>
<div class="Description">
<span class="Description-entry">.getInputStream</span> Gets the input stream of the subprocess.
</div>
<div class="Description">
<span class="Description-entry">.getOutputStream</span> Gets the output stream of the subprocess.
</div>
<div class="Description">
<span class="Description-entry">.waitFor</span> causes the current thread to wait, if necessary, until the process represented by this Process object has terminated.
</div>
<div class="Unindented">
Additional Genyris utility methods are defined:
</div>
<div class="Description">
<span class="Description-entry">.getOutput</span> returns a Genyris Reader object that can be used to read or parse the output of the process.
</div>
<div class="Description">
<span class="Description-entry">.getError</span> returns a Genyris Reader object that can be used to read or parse the error stream output of the process.
</div>
<div class="Unindented">
Example:
</div>
<pre class="LyX-Code">
&gt; proc    
   (.getOutput)
       .copy stdout
"Testing one two three"
nil # NilSymbol SimpleSymbol 
&gt; proc
   .exitValue
0 # Bignum 
</pre>
<h1 class="Section">
<a class="toc" name="toc-Section-18">18</a> Time and Date
</h1>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-18.1">18.1</a> <i>os!ticks<a class="IndexReference" name="entry-os-ticks-0" href="#index-os-ticks">↓</a></i> - Current system time in milliseconds since the epoch
</h2>
<pre class="LyX-Code">
&gt; os!ticks

1266995579117 # Bignum

&gt; format-date 0 "dd MMM yyyy HH:mm:ss Z" ’GMT’

’01 Jan 1970 00:00:00 +0000’ # String
</pre>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-18.2">18.2</a> <i>now<a class="IndexReference" name="entry-now-0" href="#index-now">↓</a></i> - Current system time in milliseconds since the epoch
</h2>
<div class="Unindented">
An alias for<i>os!ticks</i>.
</div>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-18.3">18.3</a> <i>format-date<a class="IndexReference" name="entry-format-date-0" href="#index-format-date">↓</a></i> &lt;epoch milliseconds&gt; &lt;format String&gt; &lt;timezone&gt;
</h2>
<div class="Unindented">
For example:
</div>
<pre class="LyX-Code">
&gt; format-date (os!ticks) "dd MMM yyyy HH:mm:ss z" "Australia/Melbourne"

’24 Feb 2010 18:11:41 EST’ # String
</pre>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-18.4">18.4</a> <i>calendar<a class="IndexReference" name="entry-calendar-0" href="#index-calendar">↓</a></i> &lt;epoch milliseconds&gt; &lt;timezone&gt;
</h2>
<div class="Unindented">
Returns a Calendar (dictionary) with the following properties:
</div>
<div class="Description">
<span class="Description-entry">.am-pm</span> = symbol indicating AM or PM
</div>
<div class="Description">
<span class="Description-entry">.day-of-month</span> = Integer day of the month starting with 1.
</div>
<div class="Description">
<span class="Description-entry">.day-of-week</span> = Integer day of the week starting with Sunday which is 1.
</div>
<div class="Description">
<span class="Description-entry">.day-of-week-in-month</span> = Ordinal number of the day of the week within the current month.
</div>
<div class="Description">
<span class="Description-entry">.day-of-year</span> = The day number within the current year starting with 1.
</div>
<div class="Description">
<span class="Description-entry">.dst-offset</span> = Daylight savings offset in milliseconds
</div>
<div class="Description">
<span class="Description-entry">.era</span> = symbol AD or BC
</div>
<div class="Description">
<span class="Description-entry">.hour</span> = Hour of the day (12 hour clock)
</div>
<div class="Description">
<span class="Description-entry">.hour-of-day</span> = Hour of the day (24 hour clock)
</div>
<div class="Description">
<span class="Description-entry">.millisecond</span> = e.g. 93
</div>
<div class="Description">
<span class="Description-entry">.minute</span> = e.g. 2
</div>
<div class="Description">
<span class="Description-entry">.month</span> = Integer month starting with January, which is 0
</div>
<div class="Description">
<span class="Description-entry">.second</span> = e.g. 42
</div>
<div class="Description">
<span class="Description-entry">.week-of-month</span> = Week in the month starting from 1.
</div>
<div class="Description">
<span class="Description-entry">.week-of-year</span> = Week number in the year starting from 1.
</div>
<div class="Description">
<span class="Description-entry">.year</span> = e.g. 2010
</div>
<div class="Description">
<span class="Description-entry">.zone-offset</span> = Timezone offset in milliseconds from GMT
</div>
<div class="Unindented">
For example:
</div>
<pre class="LyX-Code">
&gt; print (calendar (os!ticks))
dict (.am-pm = pm)
.day-of-month = 10
.day-of-week = 4
.day-of-week-in-month = 2
.day-of-year = 69
.dst-offset = 1
.era = AD
.hour = 10
.hour-of-day = 22
.millisecond = 93
.minute = 2
.month = 2
.second = 42
.week-of-month = 2
.week-of-year = 11
.year = 2010
.zone-offset = 10
</pre>
<h1 class="Section">
<a class="toc" name="toc-Section-19">19</a> Comma-Separated-Value Files
</h1>
<div class="Unindented">
The builtin<i> CSV</i> class is provided for reading data from CSV files.
</div>
<h2 class="Subsection">
<a class="toc" name="toc-Subsection-19.1">19.1</a> .read &lt;InStream&gt; field-separator quote-char
</h2>
<div class="Unindented">
The CSV class has a single static method<i> .read</i> which takes an input stream as it’s first parameter. Despite the name CSV files can come in a variety of formats, hence the method expects the field-seperator character and field quote character as parameters.
</div>
<div class="Indented">
The result is a list of rows. Each row is itself a list of the fields parsed. Example: Read a comma-delimited file:
</div>
<pre class="LyX-Code">
CSV
   .read ((File(.new ’my file’)) (.open ^read)) ’,’ ’&rdquo;’
</pre>
<h1 class="Section">
<a class="toc" name="toc-Section-20">20</a> Sound
</h1>
<div class="Unindented">
The <i>Sound</i> class is a wrapper for playing sound files. 
</div>
<h3 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-20.1.1">20.1.1</a> .play &lt;soundfile&gt;
</h3>
<div class="Unindented">
The <i>.play</i> method sends the nominated file to the default Java sound device to be played and waits for the the playback to conclude.<i> <span class="versalitas">Note: This implemention depends upon the Java javax.sound classes. javax.sound may not work perfectly on all platforms.</span> </i>
</div>
<h1 class="Part-">
<a class="toc" name="toc-Part--I"></a>Index
</h1>
<a class="toc" name="Index"></a><h1 class="index">Index</h1><p class="printindex">
<a class="printindex" name="index-"></a>: <a class="IndexArrow" href="#entry--0">↑</a>, <a class="IndexArrow" href="#entry--1">↑</a>, <a class="IndexArrow" href="#entry--2">↑</a>, <a class="IndexArrow" href="#entry--3">↑</a>
</p>
<div class="indexgroup">
<p class="printindex">
<a class="printindex" name="index--classes"></a>classes: <a class="IndexArrow" href="#entry--classes-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index--self"></a>self: <a class="IndexArrow" href="#entry--self-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index--valid?"></a>valid?: <a class="IndexArrow" href="#entry--valid?-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index--vars"></a>vars: <a class="IndexArrow" href="#entry--vars-0">↑</a>
</p>

</div>
<p class="printindex">
<a class="printindex" name="index-$"></a>$: <a class="IndexArrow" href="#entry-$-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-$_"></a>$@: <a class="IndexArrow" href="#entry-$_-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-&amp;rest"></a>&amp;rest: <a class="IndexArrow" href="#entry-&amp;rest-0">↑</a>, <a class="IndexArrow" href="#entry-&amp;rest-1">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-*"></a>*: <a class="IndexArrow" href="#entry-*-0">↑</a>, <a class="IndexArrow" href="#entry-*-1">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-+"></a>+: <a class="IndexArrow" href="#entry-+-0">↑</a>, <a class="IndexArrow" href="#entry-+-1">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index--"></a>-: <a class="IndexArrow" href="#entry---0">↑</a>, <a class="IndexArrow" href="#entry---1">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.+"></a>.+: <a class="IndexArrow" href="#entry-.+-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.HOME"></a>.HOME: <a class="IndexArrow" href="#entry-.HOME-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.abs-path"></a>.abs-path: <a class="IndexArrow" href="#entry-.abs-path-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.add"></a>.add: <a class="IndexArrow" href="#entry-.add-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.asGraph"></a>.asGraph: <a class="IndexArrow" href="#entry-.asGraph-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.asTriples"></a>.asTriples: <a class="IndexArrow" href="#entry-.asTriples-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.classes"></a>.classes: <a class="IndexArrow" href="#entry-.classes-0">↑</a>, <a class="IndexArrow" href="#entry-.classes-1">↑</a>, <a class="IndexArrow" href="#entry-.classes-2">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.classname"></a>.classname: <a class="IndexArrow" href="#entry-.classname-0">↑</a>, <a class="IndexArrow" href="#entry-.classname-1">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.close"></a>.close: <a class="IndexArrow" href="#entry-.close-0">↑</a>, <a class="IndexArrow" href="#entry-.close-1">↑</a>, <a class="IndexArrow" href="#entry-.close-2">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.copy"></a>.copy: <a class="IndexArrow" href="#entry-.copy-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.delete"></a>.delete: <a class="IndexArrow" href="#entry-.delete-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.digest-&lt;type&gt;"></a>.digest &lt;type&gt;: <a class="IndexArrow" href="#entry-.digest-&lt;type&gt;-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.exec"></a>.exec: <a class="IndexArrow" href="#entry-.exec-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.exists"></a>.exists: <a class="IndexArrow" href="#entry-.exists-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.exit"></a>.exit: <a class="IndexArrow" href="#entry-.exit-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.flush"></a>.flush: <a class="IndexArrow" href="#entry-.flush-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.format"></a>.format: <a class="IndexArrow" href="#entry-.format-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.fromBase64"></a>.fromBase64: <a class="IndexArrow" href="#entry-.fromBase64-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.get"></a>.get: <a class="IndexArrow" href="#entry-.get-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.get-list"></a>.get-list: <a class="IndexArrow" href="#entry-.get-list-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.getProperties"></a>.getProperties: <a class="IndexArrow" href="#entry-.getProperties-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.getenv"></a>.getenv: <a class="IndexArrow" href="#entry-.getenv-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.getline"></a>.getline: <a class="IndexArrow" href="#entry-.getline-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.hasData"></a>.hasData: <a class="IndexArrow" href="#entry-.hasData-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.hasKey"></a>.hasKey: <a class="IndexArrow" href="#entry-.hasKey-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.init"></a>.init: <a class="IndexArrow" href="#entry-.init-0">↑</a>, <a class="IndexArrow" href="#entry-.init-1">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.input"></a>.input: <a class="IndexArrow" href="#entry-.input-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.is-dir?"></a>.is-dir?: <a class="IndexArrow" href="#entry-.is-dir?-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.kill"></a>.kill: <a class="IndexArrow" href="#entry-.kill-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.left"></a>.left: <a class="IndexArrow" href="#entry-.left-0">↑</a>, <a class="IndexArrow" href="#entry-.left-1">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.length"></a>.length: <a class="IndexArrow" href="#entry-.length-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.list"></a>.list: <a class="IndexArrow" href="#entry-.list-0">↑</a>, <a class="IndexArrow" href="#entry-.list-1">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.lookup"></a>.lookup: <a class="IndexArrow" href="#entry-.lookup-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.match"></a>.match: <a class="IndexArrow" href="#entry-.match-0">↑</a>, <a class="IndexArrow" href="#entry-.match-1">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.mk-iterator"></a>.mk-iterator: <a class="IndexArrow" href="#entry-.mk-iterator-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.mkIterator"></a>.mkIterator: <a class="IndexArrow" href="#entry-.mkIterator-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.new"></a>.new: <a class="IndexArrow" href="#entry-.new-0">↑</a>, <a class="IndexArrow" href="#entry-.new-1">↑</a>, <a class="IndexArrow" href="#entry-.new-2">↑</a>, <a class="IndexArrow" href="#entry-.new-3">↑</a>, <a class="IndexArrow" href="#entry-.new-4">↑</a>, <a class="IndexArrow" href="#entry-.new-5">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.object"></a>.object: <a class="IndexArrow" href="#entry-.object-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.open"></a>.open: <a class="IndexArrow" href="#entry-.open-0">↑</a>, <a class="IndexArrow" href="#entry-.open-1">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.output"></a>.output: <a class="IndexArrow" href="#entry-.output-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.predicate"></a>.predicate: <a class="IndexArrow" href="#entry-.predicate-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.prefix"></a>.prefix: <a class="IndexArrow" href="#entry-.prefix-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.put"></a>.put: <a class="IndexArrow" href="#entry-.put-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.read"></a>.read: <a class="IndexArrow" href="#entry-.read-0">↑</a>, <a class="IndexArrow" href="#entry-.read-1">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.readAll"></a>.readAll: <a class="IndexArrow" href="#entry-.readAll-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.remove"></a>.remove: <a class="IndexArrow" href="#entry-.remove-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.replace"></a>.replace: <a class="IndexArrow" href="#entry-.replace-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.right"></a>.right: <a class="IndexArrow" href="#entry-.right-0">↑</a>, <a class="IndexArrow" href="#entry-.right-1">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.select"></a>.select: <a class="IndexArrow" href="#entry-.select-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.self"></a>.self: <a class="IndexArrow" href="#entry-.self-0">↑</a>, <a class="IndexArrow" href="#entry-.self-1">↑</a>, <a class="IndexArrow" href="#entry-.self-2">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.spawn"></a>.spawn: <a class="IndexArrow" href="#entry-.spawn-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.split"></a>.split: <a class="IndexArrow" href="#entry-.split-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.subclasses"></a>.subclasses: <a class="IndexArrow" href="#entry-.subclasses-0">↑</a>, <a class="IndexArrow" href="#entry-.subclasses-1">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.subject"></a>.subject: <a class="IndexArrow" href="#entry-.subject-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.superclasses"></a>.superclasses: <a class="IndexArrow" href="#entry-.superclasses-0">↑</a>, <a class="IndexArrow" href="#entry-.superclasses-1">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.toBase64"></a>.toBase64: <a class="IndexArrow" href="#entry-.toBase64-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.valid?"></a>.valid?: <a class="IndexArrow" href="#entry-.valid?-0">↑</a>, <a class="IndexArrow" href="#entry-.valid?-1">↑</a>, <a class="IndexArrow" href="#entry-.valid?-2">↑</a>, <a class="IndexArrow" href="#entry-.valid?-3">↑</a>, <a class="IndexArrow" href="#entry-.valid?-4">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-.vars"></a>.vars: <a class="IndexArrow" href="#entry-.vars-0">↑</a>, <a class="IndexArrow" href="#entry-.vars-1">↑</a>, <a class="IndexArrow" href="#entry-.vars-2">↑</a>, <a class="IndexArrow" href="#entry-.vars-3">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-/"></a>/: <a class="IndexArrow" href="#entry-/-0">↑</a>, <a class="IndexArrow" href="#entry-/-1">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-//"></a>//: <a class="IndexArrow" href="#entry-//-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-="></a>=: <a class="IndexArrow" href="#entry-=-0">↑</a>, <a class="IndexArrow" href="#entry-=-1">↑</a>, <a class="IndexArrow" href="#entry-=-2">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-_prefix"></a>@prefix: <a class="IndexArrow" href="#entry-_prefix-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-Alist"></a>Alist: <a class="IndexArrow" href="#entry-Alist-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-Ant"></a>Ant: <a class="IndexArrow" href="#entry-Ant-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-Base64"></a>Base64: <a class="IndexArrow" href="#entry-Base64-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-Base64EncodedString"></a>Base64EncodedString: <a class="IndexArrow" href="#entry-Base64EncodedString-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-Bignum"></a>Bignum: <a class="IndexArrow" href="#entry-Bignum-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-Boomer"></a>Boomer: <a class="IndexArrow" href="#entry-Boomer-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-Brackets"></a>Brackets: <a class="IndexArrow" href="#entry-Brackets-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-Builtin"></a>Builtin: <a class="IndexArrow" href="#entry-Builtin-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-Closure"></a>Closure: <a class="IndexArrow" href="#entry-Closure-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-Cons"></a>Cons: <a class="IndexArrow" href="#entry-Cons-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-DSL"></a>DSL: <a class="IndexArrow" href="#entry-DSL-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-Domain-Specific-Languages"></a>Domain-Specific Languages: <a class="IndexArrow" href="#entry-Domain-Specific-Languages-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-Duck-typing"></a>Duck typing: <a class="IndexArrow" href="#entry-Duck-typing-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-Dynamic-Variables"></a>Dynamic Variables: <a class="IndexArrow" href="#entry-Dynamic-Variables-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-EOF"></a>EOF: <a class="IndexArrow" href="#entry-EOF-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-Eager"></a>Eager: <a class="IndexArrow" href="#entry-Eager-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-EagerProcedure"></a>EagerProcedure: <a class="IndexArrow" href="#entry-EagerProcedure-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-File"></a>File: <a class="IndexArrow" href="#entry-File-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-GENYRIS_HOME"></a>GENYRIS_HOME: <a class="IndexArrow" href="#entry-GENYRIS_HOME-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-HTTP"></a>HTTP: <a class="IndexArrow" href="#entry-HTTP-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-HttpRequest"></a>HttpRequest: <a class="IndexArrow" href="#entry-HttpRequest-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-JRE"></a>JRE: <a class="IndexArrow" href="#entry-JRE-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-KevinRudd"></a>KevinRudd: <a class="IndexArrow" href="#entry-KevinRudd-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-Lazy"></a>Lazy: <a class="IndexArrow" href="#entry-Lazy-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-LazyProcedure"></a>LazyProcedure: <a class="IndexArrow" href="#entry-LazyProcedure-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-Line-Continuation"></a>Line Continuation: <a class="IndexArrow" href="#entry-Line-Continuation-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-Lists"></a>Lists: <a class="IndexArrow" href="#entry-Lists-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-Macros"></a>Macros: <a class="IndexArrow" href="#entry-Macros-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-Martin-Richards-and-BCPL"></a>Martin Richards and BCPL: <a class="IndexArrow" href="#entry-Martin-Richards-and-BCPL-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-New-Line"></a>New Line: <a class="IndexArrow" href="#entry-New-Line-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-NilSymbol"></a>NilSymbol: <a class="IndexArrow" href="#entry-NilSymbol-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-Object"></a>Object: <a class="IndexArrow" href="#entry-Object-0">↑</a>, <a class="IndexArrow" href="#entry-Object-1">↑</a>, <a class="IndexArrow" href="#entry-Object-2">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-Object-Oriented"></a>Object-Oriented: <a class="IndexArrow" href="#entry-Object-Oriented-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-Pair"></a>Pair: <a class="IndexArrow" href="#entry-Pair-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-PairSource"></a>PairSource: <a class="IndexArrow" href="#entry-PairSource-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-Pairs"></a>Pairs: <a class="IndexArrow" href="#entry-Pairs-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-Pipe-Examples"></a>Pipe Examples: <a class="IndexArrow" href="#entry-Pipe-Examples-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-Pipes"></a>Pipes: <a class="IndexArrow" href="#entry-Pipes-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-Predicate"></a>Predicate: <a class="IndexArrow" href="#entry-Predicate-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-Process"></a>Process: <a class="IndexArrow" href="#entry-Process-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-RDF"></a>RDF: <a class="IndexArrow" href="#entry-RDF-0">↑</a>, <a class="IndexArrow" href="#entry-RDF-1">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-StandardClass"></a>StandardClass: <a class="IndexArrow" href="#entry-StandardClass-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-StringFormatStream"></a>StringFormatStream: <a class="IndexArrow" href="#entry-StringFormatStream-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-Subject"></a>Subject: <a class="IndexArrow" href="#entry-Subject-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-System"></a>System: <a class="IndexArrow" href="#entry-System-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-Task"></a>Task: <a class="IndexArrow" href="#entry-Task-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-Task-class"></a>Task class: <a class="IndexArrow" href="#entry-Task-class-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-Tasks"></a>Tasks: <a class="IndexArrow" href="#entry-Tasks-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-Thing"></a>Thing: <a class="IndexArrow" href="#entry-Thing-0">↑</a>, <a class="IndexArrow" href="#entry-Thing-1">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-Thread-Safety"></a>Thread Safety: <a class="IndexArrow" href="#entry-Thread-Safety-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-URISymbol"></a>URISymbol: <a class="IndexArrow" href="#entry-URISymbol-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-Variables"></a>Variables: <a class="IndexArrow" href="#entry-Variables-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-William-Pitt"></a>William Pitt: <a class="IndexArrow" href="#entry-William-Pitt-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-Writer"></a>Writer: <a class="IndexArrow" href="#entry-Writer-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-[]"></a>[]: <a class="IndexArrow" href="#entry-[]-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-and"></a>and: <a class="IndexArrow" href="#entry-and-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-apply"></a>apply: <a class="IndexArrow" href="#entry-apply-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-assert"></a>assert: <a class="IndexArrow" href="#entry-assert-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-bound?"></a>bound?: <a class="IndexArrow" href="#entry-bound?-0">↑</a>, <a class="IndexArrow" href="#entry-bound?-1">↑</a>, <a class="IndexArrow" href="#entry-bound?-2">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-calendar"></a>calendar: <a class="IndexArrow" href="#entry-calendar-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-car"></a>car: <a class="IndexArrow" href="#entry-car-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-catch"></a>catch: <a class="IndexArrow" href="#entry-catch-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-cdr"></a>cdr: <a class="IndexArrow" href="#entry-cdr-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-class"></a>class: <a class="IndexArrow" href="#entry-class-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-classification"></a>classification: <a class="IndexArrow" href="#entry-classification-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-classify"></a>classify: <a class="IndexArrow" href="#entry-classify-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-command-line"></a>command line: <a class="IndexArrow" href="#entry-command-line-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-comment"></a>comment: <a class="IndexArrow" href="#entry-comment-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-cond"></a>cond: <a class="IndexArrow" href="#entry-cond-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-cons"></a>cons: <a class="IndexArrow" href="#entry-cons-0">↑</a>, <a class="IndexArrow" href="#entry-cons-1">↑</a>, <a class="IndexArrow" href="#entry-cons-2">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-constructors"></a>constructors: <a class="IndexArrow" href="#entry-constructors-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-def"></a>def: <a class="IndexArrow" href="#entry-def-0">↑</a>, <a class="IndexArrow" href="#entry-def-1">↑</a>, <a class="IndexArrow" href="#entry-def-2">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-define"></a>define: <a class="IndexArrow" href="#entry-define-0">↑</a>, <a class="IndexArrow" href="#entry-define-1">↑</a>, <a class="IndexArrow" href="#entry-define-2">↑</a>, <a class="IndexArrow" href="#entry-define-3">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-defmacro"></a>defmacro: <a class="IndexArrow" href="#entry-defmacro-0">↑</a>, <a class="IndexArrow" href="#entry-defmacro-1">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-defvar"></a>defvar: <a class="IndexArrow" href="#entry-defvar-0">↑</a>, <a class="IndexArrow" href="#entry-defvar-1">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-df"></a>df: <a class="IndexArrow" href="#entry-df-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-dict"></a>dict: <a class="IndexArrow" href="#entry-dict-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-dictionary"></a>dictionary: <a class="IndexArrow" href="#entry-dictionary-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-display"></a>display: <a class="IndexArrow" href="#entry-display-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-dollar"></a>dollar: <a class="IndexArrow" href="#entry-dollar-0">↑</a>, <a class="IndexArrow" href="#entry-dollar-1">↑</a>, <a class="IndexArrow" href="#entry-dollar-2">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-dollar-at"></a>dollar-at: <a class="IndexArrow" href="#entry-dollar-at-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-dynamic-variable"></a>dynamic variable: <a class="IndexArrow" href="#entry-dynamic-variable-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-dynamic-symbol-value"></a>dynamic-symbol-value: <a class="IndexArrow" href="#entry-dynamic-symbol-value-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-eager"></a>eager: <a class="IndexArrow" href="#entry-eager-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-else"></a>else: <a class="IndexArrow" href="#entry-else-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-equal?"></a>equal?: <a class="IndexArrow" href="#entry-equal?-0">↑</a>, <a class="IndexArrow" href="#entry-equal?-1">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-eval"></a>eval: <a class="IndexArrow" href="#entry-eval-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-examples"></a>examples: <a class="IndexArrow" href="#entry-examples-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-exclamation-mark"></a>exclamation mark: <a class="IndexArrow" href="#entry-exclamation-mark-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-expressions"></a>expressions: <a class="IndexArrow" href="#entry-expressions-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-factorial"></a>factorial: <a class="IndexArrow" href="#entry-factorial-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-format"></a>format: <a class="IndexArrow" href="#entry-format-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-format-date"></a>format-date: <a class="IndexArrow" href="#entry-format-date-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-function"></a>function: <a class="IndexArrow" href="#entry-function-0">↑</a>, <a class="IndexArrow" href="#entry-function-1">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-getKeys"></a>getKeys: <a class="IndexArrow" href="#entry-getKeys-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-golf"></a>golf: <a class="IndexArrow" href="#entry-golf-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-graph"></a>graph: <a class="IndexArrow" href="#entry-graph-0">↑</a>, <a class="IndexArrow" href="#entry-graph-1">↑</a>, <a class="IndexArrow" href="#entry-graph-2">↑</a>, <a class="IndexArrow" href="#entry-graph-3">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-hash"></a>hash: <a class="IndexArrow" href="#entry-hash-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-httpd"></a>httpd: <a class="IndexArrow" href="#entry-httpd-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-httpd-serve"></a>httpd-serve: <a class="IndexArrow" href="#entry-httpd-serve-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-if"></a>if: <a class="IndexArrow" href="#entry-if-0">↑</a>, <a class="IndexArrow" href="#entry-if-1">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-import"></a>import: <a class="IndexArrow" href="#entry-import-0">↑</a>, <a class="IndexArrow" href="#entry-import-1">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-include"></a>include: <a class="IndexArrow" href="#entry-include-0">↑</a>, <a class="IndexArrow" href="#entry-include-1">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-indentation"></a>indentation: <a class="IndexArrow" href="#entry-indentation-0">↑</a>, <a class="IndexArrow" href="#entry-indentation-1">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-inheritance"></a>inheritance: <a class="IndexArrow" href="#entry-inheritance-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-init.g"></a>init.g: <a class="IndexArrow" href="#entry-init.g-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-is-instance?"></a>is-instance?: <a class="IndexArrow" href="#entry-is-instance?-0">↑</a>, <a class="IndexArrow" href="#entry-is-instance?-1">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-is?"></a>is?: <a class="IndexArrow" href="#entry-is?-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-java:class"></a>java:class: <a class="IndexArrow" href="#entry-java:class-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-java:import"></a>java:import: <a class="IndexArrow" href="#entry-java:import-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-join"></a>join: <a class="IndexArrow" href="#entry-join-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-kookaburra"></a>kookaburra: <a class="IndexArrow" href="#entry-kookaburra-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-lambadq"></a>lambadq: <a class="IndexArrow" href="#entry-lambadq-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-lambda"></a>lambda: <a class="IndexArrow" href="#entry-lambda-0">↑</a>, <a class="IndexArrow" href="#entry-lambda-1">↑</a>, <a class="IndexArrow" href="#entry-lambda-2">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-lambdam"></a>lambdam: <a class="IndexArrow" href="#entry-lambdam-0">↑</a>, <a class="IndexArrow" href="#entry-lambdam-1">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-lambdaq"></a>lambdaq: <a class="IndexArrow" href="#entry-lambdaq-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-lazy"></a>lazy: <a class="IndexArrow" href="#entry-lazy-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-left"></a>left: <a class="IndexArrow" href="#entry-left-0">↑</a>, <a class="IndexArrow" href="#entry-left-1">↑</a>, <a class="IndexArrow" href="#entry-left-2">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-length"></a>length: <a class="IndexArrow" href="#entry-length-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-lexical-closure"></a>lexical closure: <a class="IndexArrow" href="#entry-lexical-closure-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-list"></a>list: <a class="IndexArrow" href="#entry-list-0">↑</a>, <a class="IndexArrow" href="#entry-list-1">↑</a>, <a class="IndexArrow" href="#entry-list-2">↑</a>, <a class="IndexArrow" href="#entry-list-3">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-list-processing"></a>list-processing: <a class="IndexArrow" href="#entry-list-processing-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-load"></a>load: <a class="IndexArrow" href="#entry-load-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-macro"></a>macro: <a class="IndexArrow" href="#entry-macro-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-map-left"></a>map-left: <a class="IndexArrow" href="#entry-map-left-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-member?"></a>member?: <a class="IndexArrow" href="#entry-member?-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-method"></a>method: <a class="IndexArrow" href="#entry-method-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-modules"></a>modules: <a class="IndexArrow" href="#entry-modules-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-namespaces"></a>namespaces: <a class="IndexArrow" href="#entry-namespaces-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-new"></a>new: <a class="IndexArrow" href="#entry-new-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-nil"></a>nil: <a class="IndexArrow" href="#entry-nil-0">↑</a>, <a class="IndexArrow" href="#entry-nil-1">↑</a>, <a class="IndexArrow" href="#entry-nil-2">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-not"></a>not: <a class="IndexArrow" href="#entry-not-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-now"></a>now: <a class="IndexArrow" href="#entry-now-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-or"></a>or: <a class="IndexArrow" href="#entry-or-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-os"></a>os: <a class="IndexArrow" href="#entry-os-0">↑</a>
</p>
<div class="indexgroup">
<p class="printindex">
<a class="printindex" name="index-os-ticks"></a>ticks: <a class="IndexArrow" href="#entry-os-ticks-0">↑</a>
</p>

</div>
<p class="printindex">
<a class="printindex" name="index-pling"></a>pling: <a class="IndexArrow" href="#entry-pling-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-power"></a>power: <a class="IndexArrow" href="#entry-power-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-print"></a>print: <a class="IndexArrow" href="#entry-print-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-procedure"></a>procedure: <a class="IndexArrow" href="#entry-procedure-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-properties"></a>properties: <a class="IndexArrow" href="#entry-properties-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-ps"></a>ps: <a class="IndexArrow" href="#entry-ps-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-quote"></a>quote: <a class="IndexArrow" href="#entry-quote-0">↑</a>, <a class="IndexArrow" href="#entry-quote-1">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-read"></a>read: <a class="IndexArrow" href="#entry-read-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-reload"></a>reload: <a class="IndexArrow" href="#entry-reload-0">↑</a>, <a class="IndexArrow" href="#entry-reload-1">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-remove-tag"></a>remove-tag: <a class="IndexArrow" href="#entry-remove-tag-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-reverse"></a>reverse: <a class="IndexArrow" href="#entry-reverse-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-right"></a>right: <a class="IndexArrow" href="#entry-right-0">↑</a>, <a class="IndexArrow" href="#entry-right-1">↑</a>, <a class="IndexArrow" href="#entry-right-2">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-rplaca"></a>rplaca: <a class="IndexArrow" href="#entry-rplaca-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-rplacd"></a>rplacd: <a class="IndexArrow" href="#entry-rplacd-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-scale"></a>scale: <a class="IndexArrow" href="#entry-scale-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-set"></a>set: <a class="IndexArrow" href="#entry-set-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-setq"></a>setq: <a class="IndexArrow" href="#entry-setq-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-spawn"></a>spawn: <a class="IndexArrow" href="#entry-spawn-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-stdin"></a>stdin: <a class="IndexArrow" href="#entry-stdin-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-stdout"></a>stdout: <a class="IndexArrow" href="#entry-stdout-0">↑</a>, <a class="IndexArrow" href="#entry-stdout-1">↑</a>, <a class="IndexArrow" href="#entry-stdout-2">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-symbol-value"></a>symbol-value: <a class="IndexArrow" href="#entry-symbol-value-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-symlist"></a>symlist: <a class="IndexArrow" href="#entry-symlist-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-sys:import"></a>sys:import: <a class="IndexArrow" href="#entry-sys:import-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-sys:path"></a>sys:path: <a class="IndexArrow" href="#entry-sys:path-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-sys:procedure-missing"></a>sys:procedure-missing: <a class="IndexArrow" href="#entry-sys:procedure-missing-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-sys:self-test"></a>sys:self-test: <a class="IndexArrow" href="#entry-sys:self-test-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-tag"></a>tag: <a class="IndexArrow" href="#entry-tag-0">↑</a>, <a class="IndexArrow" href="#entry-tag-1">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-task:kill"></a>task:kill: <a class="IndexArrow" href="#entry-task:kill-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-task:synchronized"></a>task:synchronized: <a class="IndexArrow" href="#entry-task:synchronized-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-template"></a>template: <a class="IndexArrow" href="#entry-template-0">↑</a>, <a class="IndexArrow" href="#entry-template-1">↑</a>, <a class="IndexArrow" href="#entry-template-2">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-the"></a>the: <a class="IndexArrow" href="#entry-the-0">↑</a>, <a class="IndexArrow" href="#entry-the-1">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-tilde"></a>tilde: <a class="IndexArrow" href="#entry-tilde-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-triple"></a>triple: <a class="IndexArrow" href="#entry-triple-0">↑</a>, <a class="IndexArrow" href="#entry-triple-1">↑</a>, <a class="IndexArrow" href="#entry-triple-2">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-true"></a>true: <a class="IndexArrow" href="#entry-true-0">↑</a>, <a class="IndexArrow" href="#entry-true-1">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-type-annotations"></a>type annotations: <a class="IndexArrow" href="#entry-type-annotations-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-unique-triples"></a>unique triples: <a class="IndexArrow" href="#entry-unique-triples-0">↑</a>, <a class="IndexArrow" href="#entry-unique-triples-1">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-var"></a>var: <a class="IndexArrow" href="#entry-var-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-web:get"></a>web:get: <a class="IndexArrow" href="#entry-web:get-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-web:post"></a>web:post: <a class="IndexArrow" href="#entry-web:post-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-while"></a>while: <a class="IndexArrow" href="#entry-while-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-write"></a>write: <a class="IndexArrow" href="#entry-write-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-{}"></a>{}: <a class="IndexArrow" href="#entry-{}-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-~"></a>~: <a class="IndexArrow" href="#entry-~-0">↑</a>
</p>
<p class="printindex">
<a class="printindex" name="index-‘"></a>‘: <a class="IndexArrow" href="#entry-‘-0">↑</a>
</p>

<hr class="footer"/>
<div class="footer" id="generated-by">
Document generated by <a href="http://elyxer.nongnu.org/">eLyXer 1.2.5 (2013-03-10)</a> on <span class="create-date">2018-03-24T22:49:24.903106</span>
</div>
</div>
</body>
</html>
